(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6970],{6970:function(Z,ee,g){"use strict";g.r(ee),g.d(ee,{Router:function(){return xO}});var f=g(2784),U=g(10289),D=g(49558),R=g(30705),W=g(73495),$=g(96575),re=g(34520),z=g(79692),S=g(90436),M=g(80030),I=g(86689),q=g(60364),K=g(94339),le=g(16111),Y=g(24579),me=g(95544),Ve=g(7089),Ke=g(14503),Oe=g(61837),pe=g(31625),Qe=g(31377),H=g(34546),Ge=g(67471),st=g(77277),bt=g(27556),$n=g(67358),Mt=g(89571),wt=g(15584),Ft=g(91256),L=g(37390),X=g(58987),Ne=g(97485),ye=g(60905),Ot=g(42494),Pe=g(56939),et=g(73698),ct=g(12231),vn=g(49462),ai=g(39781),po=g(26655),un=g(4298),Ni=g(19126),Ir=g.n(Ni),ci=g(64279),go=g(13888),Wi=g.n(go),Lr=g(72579),ji=g.n(Lr),yo=g(45455),vo=g.n(yo);function bo(n){var e=n.errors;return f.createElement("div",{className:"panel panel-danger errors"},f.createElement("div",{className:"panel-heading"},f.createElement("h3",{className:"panel-title"},"Errors")),f.createElement("ul",{className:"list-group"},e.map(function(t,i){return f.createElement("li",{key:i,className:"list-group-item text-danger"},t.stack)})))}var Vi=g(38294),Nr=g(76485),$i=g.n(Nr),Wr=g(67553),wo=g.n(Wr),Se=g(26139),Hi=g.n(Se),A=g(404);function j(){return j=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},j.apply(this,arguments)}function J(n,e){if(n==null)return{};var t=ce(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function ce(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function fe(n){var e=n.type,t=e===void 0?"default":e,i=n.icon,r=n.className,s=J(n,["type","icon","className"]);return f.createElement("button",j({type:"button",className:"btn btn-".concat(t," ").concat(r)},s),f.createElement("i",{className:"glyphicon glyphicon-".concat(i)}))}function se(n){var e=n.className,t=n.onClick,i=n.disabled;return f.createElement("div",{className:"row"},f.createElement("p",{className:"col-xs-3 col-xs-offset-9 text-right ".concat(e)},f.createElement(fe,{type:"info",icon:"plus",className:"btn-add col-xs-12","aria-label":"Add",tabIndex:"0",onClick:t,disabled:i})))}var be=g(5594),Re=g.n(be),Ie=g(13980),ie=g.n(Ie),We=ie().shape({ArrayFieldTemplate:ie().elementType,FieldTemplate:ie().elementType,ObjectFieldTemplate:ie().elementType,definitions:ie().object.isRequired,rootSchema:ie().object,fields:ie().objectOf(ie().elementType).isRequired,formContext:ie().object.isRequired,widgets:ie().objectOf(ie().oneOfType([ie().func,ie().object])).isRequired}),tt={autofocus:ie().bool,disabled:ie().bool,errorSchema:ie().object,formData:ie().any,idSchema:ie().object,onBlur:ie().func,onChange:ie().func.isRequired,onFocus:ie().func,rawErrors:ie().arrayOf(ie().string),readonly:ie().bool,registry:We.isRequired,required:ie().bool,schema:ie().object.isRequired,uiSchema:ie().shape({"ui:options":ie().shape({addable:ie().bool,orderable:ie().bool,removable:ie().bool})})};let ut=n=>crypto.getRandomValues(new Uint8Array(n)),$t=(n,e,t)=>{let i=(2<<Math.log(n.length-1)/Math.LN2)-1,r=-~(1.6*i*e/n.length);return(s=e)=>{let o="";for(;;){let l=t(r),a=r;for(;a--;)if(o+=n[l[a]&i]||"",o.length===s)return o}}},Ae=(n,e=21)=>$t(n,e,ut),Ui=(n=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(n));for(;n--;){let i=t[n]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e};function Ht(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ht=function(t){return typeof t}:Ht=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(n)}function zi(n,e){if(n==null)return{};var t=Zi(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function Zi(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function ui(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){qt(n,r,t[r])})}return n}function Zt(n){return Qp(n)||_p(n)||Xp()}function Xp(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _p(n){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]")return Array.from(n)}function Qp(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}function eg(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Dc(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function tg(n,e,t){return e&&Dc(n.prototype,e),t&&Dc(n,t),n}function ng(n,e){return e&&(Ht(e)==="object"||typeof e=="function")?e:bn(n)}function xo(n){return xo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},xo(n)}function bn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function ig(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&So(n,e)}function So(n,e){return So=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},So(n,e)}function qt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tc(n){var e=n.TitleField,t=n.idSchema,i=n.title,r=n.required;if(!i)return null;var s="".concat(t.$id,"__title");return f.createElement(e,{id:s,title:i,required:r})}function rg(n){var e=n.DescriptionField,t=n.idSchema,i=n.description;if(!i)return null;var r="".concat(t.$id,"__description");return f.createElement(e,{id:r,description:i})}function Mc(n){var e={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"};return f.createElement("div",{key:n.key,className:n.className},f.createElement("div",{className:n.hasToolbar?"col-xs-9":"col-xs-12"},n.children),n.hasToolbar&&f.createElement("div",{className:"col-xs-3 array-item-toolbox"},f.createElement("div",{className:"btn-group",style:{display:"flex",justifyContent:"space-around"}},(n.hasMoveUp||n.hasMoveDown)&&f.createElement(fe,{icon:"arrow-up","aria-label":"Move up",className:"array-item-move-up",tabIndex:"-1",style:e,disabled:n.disabled||n.readonly||!n.hasMoveUp,onClick:n.onReorderClick(n.index,n.index-1)}),(n.hasMoveUp||n.hasMoveDown)&&f.createElement(fe,{icon:"arrow-down",className:"array-item-move-down","aria-label":"Move down",tabIndex:"-1",style:e,disabled:n.disabled||n.readonly||!n.hasMoveDown,onClick:n.onReorderClick(n.index,n.index+1)}),n.hasRemove&&f.createElement(fe,{type:"danger",icon:"remove","aria-label":"Remove",className:"array-item-remove",tabIndex:"-1",style:e,disabled:n.disabled||n.readonly,onClick:n.onDropIndexClick(n.index)}))))}function sg(n){return f.createElement("fieldset",{className:n.className,id:n.idSchema.$id},f.createElement(Tc,{key:"array-field-title-".concat(n.idSchema.$id),TitleField:n.TitleField,idSchema:n.idSchema,title:n.uiSchema["ui:title"]||n.title,required:n.required}),(n.uiSchema["ui:description"]||n.schema.description)&&f.createElement("div",{className:"field-description",key:"field-description-".concat(n.idSchema.$id)},n.uiSchema["ui:description"]||n.schema.description),f.createElement("div",{className:"row array-item-list",key:"array-item-list-".concat(n.idSchema.$id)},n.items&&n.items.map(Mc)),n.canAdd&&f.createElement(se,{className:"array-item-add",onClick:n.onAddClick,disabled:n.disabled||n.readonly}))}function og(n){return f.createElement("fieldset",{className:n.className,id:n.idSchema.$id},f.createElement(Tc,{key:"array-field-title-".concat(n.idSchema.$id),TitleField:n.TitleField,idSchema:n.idSchema,title:n.uiSchema["ui:title"]||n.title,required:n.required}),(n.uiSchema["ui:description"]||n.schema.description)&&f.createElement(rg,{key:"array-field-description-".concat(n.idSchema.$id),DescriptionField:n.DescriptionField,idSchema:n.idSchema,description:n.uiSchema["ui:description"]||n.schema.description}),f.createElement("div",{className:"row array-item-list",key:"array-item-list-".concat(n.idSchema.$id)},n.items&&n.items.map(function(e){return Mc(e)})),n.canAdd&&f.createElement(se,{className:"array-item-add",onClick:n.onAddClick,disabled:n.disabled||n.readonly}))}function Co(){return Ui()}function Fc(n){return Array.isArray(n)?n.map(function(e){return{key:Co(),item:e}}):[]}function qi(n){return n.map(function(e){return e.item})}var Bc=function(n){ig(e,n);function e(t){var i;eg(this,e),i=ng(this,xo(e).call(this,t)),qt(bn(i),"_getNewFormDataRow",function(){var o=i.props,l=o.schema,a=o.registry,c=a===void 0?ht():a,u=c.rootSchema,h=l.items;return ll(l)&&xu(l)&&(h=l.additionalItems),Yr(h,void 0,u)}),qt(bn(i),"onAddClick",function(o){o&&o.preventDefault();var l=i.props.onChange,a={key:Co(),item:i._getNewFormDataRow()},c=[].concat(Zt(i.state.keyedFormData),[a]);i.setState({keyedFormData:c,updatedKeyedFormData:!0},function(){return l(qi(c))})}),qt(bn(i),"onAddIndexClick",function(o){return function(l){l&&l.preventDefault();var a=i.props.onChange,c={key:Co(),item:i._getNewFormDataRow()},u=Zt(i.state.keyedFormData);u.splice(o,0,c),i.setState({keyedFormData:u,updatedKeyedFormData:!0},function(){return a(qi(u))})}}),qt(bn(i),"onDropIndexClick",function(o){return function(l){l&&l.preventDefault();var a=i.props.onChange,c=i.state.keyedFormData,u;if(i.props.errorSchema){u={};var h=i.props.errorSchema;for(var d in h)d=parseInt(d),d<o?u[d]=h[d]:d>o&&(u[d-1]=h[d])}var m=c.filter(function(p,y){return y!==o});i.setState({keyedFormData:m,updatedKeyedFormData:!0},function(){return a(qi(m),u)})}}),qt(bn(i),"onReorderClick",function(o,l){return function(a){a&&(a.preventDefault(),a.target.blur());var c=i.props.onChange,u;if(i.props.errorSchema){u={};var h=i.props.errorSchema;for(var d in h)d==o?u[l]=h[o]:d==l?u[o]=h[l]:u[d]=h[d]}var m=i.state.keyedFormData;function p(){var b=m.slice();return b.splice(o,1),b.splice(l,0,m[o]),b}var y=p();i.setState({keyedFormData:y},function(){return c(qi(y),u)})}}),qt(bn(i),"onChangeForIndex",function(o){return function(l,a){var c=i.props,u=c.formData,h=c.onChange,d=u.map(function(m,p){var y=typeof l=="undefined"?null:l;return o===p?y:m});h(d,a&&i.props.errorSchema&&ui({},i.props.errorSchema,qt({},o,a)))}}),qt(bn(i),"onSelectChange",function(o){i.props.onChange(o)});var r=t.formData,s=Fc(r);return i.state={keyedFormData:s,updatedKeyedFormData:!1},i}return tg(e,[{key:"isItemRequired",value:function(i){return Array.isArray(i.type)?!Re()(i.type,"null"):i.type!=="null"}},{key:"canAddItem",value:function(i){var r=this.props,s=r.schema,o=r.uiSchema,l=Cn(o),a=l.addable;return a!==!1&&(s.maxItems!==void 0?a=i.length<s.maxItems:a=!0),a}},{key:"render",value:function(){var i=this.props,r=i.schema,s=i.uiSchema,o=i.idSchema,l=i.registry,a=l===void 0?ht():l,c=a.rootSchema;if(!r.hasOwnProperty("items")){var u=a.fields,h=u.UnsupportedField;return f.createElement(h,{schema:r,idSchema:o,reason:"Missing items definition"})}return ll(r)?this.renderFixedArray():wu(r,s,c)?this.renderFiles():_r(r,c)?this.renderMultiSelect():this.renderNormalArray()}},{key:"renderNormalArray",value:function(){var i=this,r=this.props,s=r.schema,o=r.uiSchema,l=r.errorSchema,a=r.idSchema,c=r.name,u=r.required,h=r.disabled,d=r.readonly,m=r.autofocus,p=r.registry,y=p===void 0?ht():p,b=r.onBlur,v=r.onFocus,C=r.idPrefix,x=r.rawErrors,k=s.title===void 0?c:s.title,w=y.ArrayFieldTemplate,O=y.rootSchema,F=y.fields,P=y.formContext,B=F.TitleField,N=F.DescriptionField,G=De(s.items,O),Q=qi(this.state.keyedFormData),he={canAdd:this.canAddItem(Q),items:this.state.keyedFormData.map(function(ae,de){var ve=ae.key,Te=ae.item,Ze=De(s.items,O,Te),_e=l?l[de]:void 0,kt=a.$id+"_"+de,Vt=Zn(Ze,kt,O,Te,C);return i.renderArrayFieldItem({key:ve,index:de,canMoveUp:de>0,canMoveDown:de<Q.length-1,itemSchema:Ze,itemIdSchema:Vt,itemErrorSchema:_e,itemData:Te,itemUiSchema:o.items,autofocus:m&&de===0,onBlur:b,onFocus:v})}),className:"field field-array field-array-of-".concat(G.type),DescriptionField:N,disabled:h,idSchema:a,uiSchema:o,onAddClick:this.onAddClick,readonly:d,required:u,schema:s,title:k,TitleField:B,formContext:P,formData:Q,rawErrors:x,registry:y},Ce=o["ui:ArrayFieldTemplate"]||w||og;return f.createElement(Ce,he)}},{key:"renderMultiSelect",value:function(){var i=this.props,r=i.schema,s=i.idSchema,o=i.uiSchema,l=i.formData,a=i.disabled,c=i.readonly,u=i.required,h=i.placeholder,d=i.autofocus,m=i.onBlur,p=i.onFocus,y=i.registry,b=y===void 0?ht():y,v=i.rawErrors,C=i.name,x=this.props.formData,k=b.widgets,w=b.rootSchema,O=b.formContext,F=De(r.items,w,l),P=r.title||C,B=Qr(F),N=ui({},Cn(o),{enumOptions:B}),G=N.widget,Q=G===void 0?"select":G,he=zi(N,["widget"]),Ce=xn(r,Q,k);return f.createElement(Ce,{id:s&&s.$id,multiple:!0,onChange:this.onSelectChange,onBlur:m,onFocus:p,options:he,schema:r,registry:b,value:x,disabled:a,readonly:c,required:u,label:P,placeholder:h,formContext:O,autofocus:d,rawErrors:v})}},{key:"renderFiles",value:function(){var i=this.props,r=i.schema,s=i.uiSchema,o=i.idSchema,l=i.name,a=i.disabled,c=i.readonly,u=i.autofocus,h=i.onBlur,d=i.onFocus,m=i.registry,p=m===void 0?ht():m,y=i.rawErrors,b=r.title||l,v=this.props.formData,C=p.widgets,x=p.formContext,k=Cn(s),w=k.widget,O=w===void 0?"files":w,F=zi(k,["widget"]),P=xn(r,O,C);return f.createElement(P,{options:F,id:o&&o.$id,multiple:!0,onChange:this.onSelectChange,onBlur:h,onFocus:d,schema:r,title:b,value:v,disabled:a,readonly:c,formContext:x,autofocus:u,rawErrors:y})}},{key:"renderFixedArray",value:function(){var i=this,r=this.props,s=r.schema,o=r.uiSchema,l=r.formData,a=r.errorSchema,c=r.idPrefix,u=r.idSchema,h=r.name,d=r.required,m=r.disabled,p=r.readonly,y=r.autofocus,b=r.registry,v=b===void 0?ht():b,C=r.onBlur,x=r.onFocus,k=r.rawErrors,w=s.title||h,O=this.props.formData,F=v.ArrayFieldTemplate,P=v.rootSchema,B=v.fields,N=v.formContext,G=B.TitleField,Q=s.items.map(function(de,ve){return De(de,P,l[ve])}),he=xu(s)?De(s.additionalItems,P,l):null;(!O||O.length<Q.length)&&(O=O||[],O=O.concat(new Array(Q.length-O.length)));var Ce={canAdd:this.canAddItem(O)&&he,className:"field field-array field-array-fixed-items",disabled:m,idSchema:u,formData:l,items:this.state.keyedFormData.map(function(de,ve){var Te=de.key,Ze=de.item,_e=ve>=Q.length,kt=_e?De(s.additionalItems,P,Ze):Q[ve],Vt=u.$id+"_"+ve,cn=Zn(kt,Vt,P,Ze,c),mo=_e?o.additionalItems||{}:Array.isArray(o.items)?o.items[ve]:o.items||{},SO=a?a[ve]:void 0;return i.renderArrayFieldItem({key:Te,index:ve,canRemove:_e,canMoveUp:ve>=Q.length+1,canMoveDown:_e&&ve<O.length-1,itemSchema:kt,itemData:Ze,itemUiSchema:mo,itemIdSchema:cn,itemErrorSchema:SO,autofocus:y&&ve===0,onBlur:C,onFocus:x})}),onAddClick:this.onAddClick,readonly:p,required:d,schema:s,uiSchema:o,title:w,TitleField:G,formContext:N,rawErrors:k},ae=o["ui:ArrayFieldTemplate"]||F||sg;return f.createElement(ae,Ce)}},{key:"renderArrayFieldItem",value:function(i){var r=i.key,s=i.index,o=i.canRemove,l=o===void 0?!0:o,a=i.canMoveUp,c=a===void 0?!0:a,u=i.canMoveDown,h=u===void 0?!0:u,d=i.itemSchema,m=i.itemData,p=i.itemUiSchema,y=i.itemIdSchema,b=i.itemErrorSchema,v=i.autofocus,C=i.onBlur,x=i.onFocus,k=i.rawErrors,w=this.props,O=w.disabled,F=w.readonly,P=w.uiSchema,B=w.registry,N=B===void 0?ht():B,G=N.fields.SchemaField,Q=ui({orderable:!0,removable:!0},P["ui:options"]),he=Q.orderable,Ce=Q.removable,ae={moveUp:he&&c,moveDown:he&&h,remove:Ce&&l};return ae.toolbar=Object.keys(ae).some(function(de){return ae[de]}),{children:f.createElement(G,{index:s,schema:d,uiSchema:p,formData:m,errorSchema:b,idSchema:y,required:this.isItemRequired(d),onChange:this.onChangeForIndex(s),onBlur:C,onFocus:x,registry:this.props.registry,disabled:this.props.disabled,readonly:this.props.readonly,autofocus:v,rawErrors:k}),className:"array-item",disabled:O,hasToolbar:ae.toolbar,hasMoveUp:ae.moveUp,hasMoveDown:ae.moveDown,hasRemove:ae.remove,index:s,key:r,onAddIndexClick:this.onAddIndexClick,onDropIndexClick:this.onDropIndexClick,onReorderClick:this.onReorderClick,readonly:F}}},{key:"itemTitle",get:function(){var i=this.props.schema;return i.items.title||i.items.description||"Item"}}],[{key:"getDerivedStateFromProps",value:function(i,r){if(r.updatedKeyedFormData)return{updatedKeyedFormData:!1};var s=i.formData||[],o=r.keyedFormData||[],l=s.length===o.length?o.map(function(a,c){return{key:a.key,item:s[c]}}):Fc(s);return{keyedFormData:l}}}]),e}(f.Component);qt(Bc,"defaultProps",{uiSchema:{},formData:[],idSchema:{},required:!1,disabled:!1,readonly:!1,autofocus:!1});var lg=Bc;function Rc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){ag(n,r,t[r])})}return n}function ag(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cg(n,e){if(n==null)return{};var t=ug(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function ug(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function Ic(n){var e=n.schema,t=n.name,i=n.uiSchema,r=n.idSchema,s=n.formData,o=n.registry,l=o===void 0?ht():o,a=n.required,c=n.disabled,u=n.readonly,h=n.autofocus,d=n.onChange,m=n.onFocus,p=n.onBlur,y=n.rawErrors,b=e.title,v=l.widgets,C=l.formContext,x=l.fields,k=Cn(i),w=k.widget,O=w===void 0?"checkbox":w,F=cg(k,["widget"]),P=xn(e,O,v),B;return Array.isArray(e.oneOf)?B=Qr({oneOf:e.oneOf.map(function(N){return Rc({},N,{title:N.title||(N.const===!0?"Yes":"No")})})}):B=Qr({enum:e.enum||[!0,!1],enumNames:e.enumNames||(e.enum&&e.enum[0]===!1?["No","Yes"]:["Yes","No"])}),f.createElement(P,{options:Rc({},F,{enumOptions:B}),schema:e,uiSchema:i,id:r&&r.$id,onChange:d,onFocus:m,onBlur:p,label:b===void 0?t:b,value:s,required:a,disabled:c,readonly:u,registry:l,formContext:C,autofocus:h,rawErrors:y,DescriptionField:x.DescriptionField})}Ic.defaultProps={uiSchema:{},disabled:!1,readonly:!1,autofocus:!1};var hg=Ic;function fg(n){var e=n.id,t=n.description;return t?typeof t=="string"?f.createElement("p",{id:e,className:"field-description"},t):f.createElement("div",{id:e,className:"field-description"},t):null}var dg=fg;function jr(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?jr=function(t){return typeof t}:jr=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jr(n)}function ko(){return ko=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},ko.apply(this,arguments)}function mg(n,e){if(n==null)return{};var t=pg(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function pg(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function gg(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Lc(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function yg(n,e,t){return e&&Lc(n.prototype,e),t&&Lc(n,t),n}function vg(n,e){return e&&(jr(e)==="object"||typeof e=="function")?e:Nc(n)}function Oo(n){return Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Oo(n)}function Nc(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function bg(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&Ao(n,e)}function Ao(n,e){return Ao=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Ao(n,e)}function wg(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var Wc=function(n){bg(e,n);function e(t){var i;gg(this,e),i=vg(this,Oo(e).call(this,t)),wg(Nc(i),"onOptionChange",function(l){var a=parseInt(l,10),c=i.props,u=c.formData,h=c.onChange,d=c.options,m=c.registry,p=m.rootSchema,y=De(d[a],p,u),b=void 0;if(pi(u)==="object"&&(y.type==="object"||y.properties)){b=Object.assign({},u);var v=d.slice();v.splice(a,1);var C=!0,x=!1,k=void 0;try{for(var w=v[Symbol.iterator](),O;!(C=(O=w.next()).done);C=!0){var F=O.value;if(F.properties)for(var P in F.properties)b.hasOwnProperty(P)&&delete b[P]}}catch(B){x=!0,k=B}finally{try{!C&&w.return!=null&&w.return()}finally{if(x)throw k}}}h(Yr(d[a],b,p)),i.setState({selectedOption:parseInt(l,10)})});var r=i.props,s=r.formData,o=r.options;return i.state={selectedOption:i.getMatchingOption(s,o)},i}return yg(e,[{key:"componentDidUpdate",value:function(i,r){if(!Ut(this.props.formData,i.formData)&&this.props.idSchema.$id===i.idSchema.$id){var s=this.getMatchingOption(this.props.formData,this.props.options);if(!r||s===this.state.selectedOption)return;this.setState({selectedOption:s})}}},{key:"getMatchingOption",value:function(i,r){var s=this.props.registry.rootSchema,o=Xi(i,r,s);return o!==0?o:this&&this.state?this.state.selectedOption:0}},{key:"render",value:function(){var i=this.props,r=i.baseType,s=i.disabled,o=i.errorSchema,l=i.formData,a=i.idPrefix,c=i.idSchema,u=i.onBlur,h=i.onChange,d=i.onFocus,m=i.options,p=i.registry,y=i.uiSchema,b=i.schema,v=p.fields.SchemaField,C=p.widgets,x=this.state.selectedOption,k=Cn(y),w=k.widget,O=w===void 0?"select":w,F=mg(k,["widget"]),P=xn({type:"number"},O,C),B=m[x]||null,N;B&&(N=B.type?B:Object.assign({},B,{type:r}));var G=m.map(function(Q,he){return{label:Q.title||"Option ".concat(he+1),value:he}});return f.createElement("div",{className:"panel panel-default panel-body"},f.createElement("div",{className:"form-group"},f.createElement(P,ko({id:"".concat(c.$id).concat(b.oneOf?"__oneof_select":"__anyof_select"),schema:{type:"number",default:0},onChange:this.onOptionChange,onBlur:u,onFocus:d,value:x,options:{enumOptions:G}},F))),B!==null&&f.createElement(v,{schema:N,uiSchema:y,errorSchema:o,idSchema:c,idPrefix:a,formData:l,onChange:h,onBlur:u,onFocus:d,registry:p,disabled:s}))}}]),e}(f.Component);Wc.defaultProps={disabled:!1,errorSchema:{},idSchema:{},uiSchema:{}};var jc=Wc;function Vr(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vr=function(t){return typeof t}:Vr=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vr(n)}function Eo(){return Eo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Eo.apply(this,arguments)}function xg(n,e){if(n==null)return{};var t=Sg(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function Sg(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function Cg(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Vc(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function kg(n,e,t){return e&&Vc(n.prototype,e),t&&Vc(n,t),n}function Og(n,e){return e&&(Vr(e)==="object"||typeof e=="function")?e:$c(n)}function Po(n){return Po=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Po(n)}function $c(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Ag(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&Do(n,e)}function Do(n,e){return Do=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Do(n,e)}function Eg(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var Pg=/\.([0-9]*0)*$/,Dg=/[0.]0*$/,Hc=function(n){Ag(e,n);function e(t){var i;return Cg(this,e),i=Og(this,Po(e).call(this,t)),Eg($c(i),"handleChange",function(r){i.setState({lastValue:r}),"".concat(r).charAt(0)==="."&&(r="0".concat(r));var s=typeof r=="string"&&r.match(Pg)?mi(r.replace(Dg,"")):mi(r);i.props.onChange(s)}),i.state={lastValue:t.value},i}return kg(e,[{key:"render",value:function(){var i=this.props.registry.fields.StringField,r=this.props,s=r.formData,o=xg(r,["formData"]),l=this.state.lastValue,a=s;if(typeof l=="string"&&typeof a=="number"){var c=new RegExp("".concat(a).replace(".","\\.")+"\\.?0*$");l.match(c)&&(a=l)}return f.createElement(i,Eo({},o,{formData:a,onChange:this.handleChange}))}}]),e}(f.Component);Hc.defaultProps={uiSchema:{}};var Tg=Hc;function $r(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$r=function(t){return typeof t}:$r=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$r(n)}function To(){return To=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},To.apply(this,arguments)}function Mg(n){return Rg(n)||Bg(n)||Fg()}function Fg(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Bg(n){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]")return Array.from(n)}function Rg(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}function hi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){At(n,r,t[r])})}return n}function Ig(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Uc(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Lg(n,e,t){return e&&Uc(n.prototype,e),t&&Uc(n,t),n}function Ng(n,e){return e&&($r(e)==="object"||typeof e=="function")?e:Hn(n)}function Mo(n){return Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Mo(n)}function Hn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Wg(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&Fo(n,e)}function Fo(n,e){return Fo=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Fo(n,e)}function At(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jg(n){var e=n.TitleField,t=n.DescriptionField;return f.createElement("fieldset",{id:n.idSchema.$id},(n.uiSchema["ui:title"]||n.title)&&f.createElement(e,{id:"".concat(n.idSchema.$id,"__title"),title:n.title||n.uiSchema["ui:title"],required:n.required,formContext:n.formContext}),n.description&&f.createElement(t,{id:"".concat(n.idSchema.$id,"__description"),description:n.description,formContext:n.formContext}),n.properties.map(function(i){return i.content}),vu(n.schema,n.uiSchema,n.formData)&&f.createElement(se,{className:"object-property-expand",onClick:n.onAddClick(n.schema),disabled:n.disabled||n.readonly}))}var zc=function(n){Wg(e,n);function e(){var t,i;Ig(this,e);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=Ng(this,(t=Mo(e)).call.apply(t,[this].concat(s))),At(Hn(i),"state",{wasPropertyKeyModified:!1,additionalProperties:{}}),At(Hn(i),"onPropertyChange",function(l){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function(c,u){c===void 0&&a&&(c="");var h=hi({},i.props.formData,At({},l,c));i.props.onChange(h,u&&i.props.errorSchema&&hi({},i.props.errorSchema,At({},l,u)))}}),At(Hn(i),"onDropPropertyClick",function(l){return function(a){a.preventDefault();var c=i.props,u=c.onChange,h=c.formData,d=hi({},h);delete d[l],u(d)}}),At(Hn(i),"getAvailableKey",function(l,a){for(var c=0,u=l;a.hasOwnProperty(u);)u="".concat(l,"-").concat(++c);return u}),At(Hn(i),"onKeyChange",function(l){return function(a,c){if(l!==a){a=i.getAvailableKey(a,i.props.formData);var u=hi({},i.props.formData),h=At({},l,a),d=Object.keys(u).map(function(p){var y=h[p]||p;return At({},y,u[p])}),m=Object.assign.apply(Object,[{}].concat(Mg(d)));i.setState({wasPropertyKeyModified:!0}),i.props.onChange(m,c&&i.props.errorSchema&&hi({},i.props.errorSchema,At({},a,c)))}}}),At(Hn(i),"handleAddClick",function(l){return function(){var a=l.additionalProperties.type,c=hi({},i.props.formData);if(l.additionalProperties.hasOwnProperty("$ref")){var u=i.props.registry,h=u===void 0?ht():u,d=De({$ref:l.additionalProperties.$ref},h.rootSchema,i.props.formData);a=d.type}c[i.getAvailableKey("newKey",c)]=i.getDefaultValue(a),i.props.onChange(c)}}),i}return Lg(e,[{key:"isRequired",value:function(i){var r=this.props.schema;return Array.isArray(r.required)&&r.required.indexOf(i)!==-1}},{key:"getDefaultValue",value:function(i){switch(i){case"string":return"New Value";case"array":return[];case"boolean":return!1;case"null":return null;case"number":return 0;case"object":return{};default:return"New Value"}}},{key:"render",value:function(){var i=this,r=this.props,s=r.uiSchema,o=r.formData,l=r.errorSchema,a=r.idSchema,c=r.name,u=r.required,h=r.disabled,d=r.readonly,m=r.idPrefix,p=r.onBlur,y=r.onFocus,b=r.registry,v=b===void 0?ht():b,C=v.rootSchema,x=v.fields,k=v.formContext,w=x.SchemaField,O=x.TitleField,F=x.DescriptionField,P=De(this.props.schema,C,o),B=P.title===void 0?c:P.title,N=s["ui:description"]||P.description,G;try{var Q=Object.keys(P.properties||{});G=$0(Q,s["ui:order"])}catch(ae){return f.createElement("div",null,f.createElement("p",{className:"config-error",style:{color:"red"}},"Invalid ",c||"root"," object field configuration:",f.createElement("em",null,ae.message),"."),f.createElement("pre",null,JSON.stringify(P)))}var he=s["ui:ObjectFieldTemplate"]||v.ObjectFieldTemplate||jg,Ce={title:s["ui:title"]||B,description:N,TitleField:O,DescriptionField:F,properties:G.map(function(ae){var de=P.properties[ae].hasOwnProperty(Jr),ve=de?s.additionalProperties:s[ae],Te=ve&&ve["ui:widget"]==="hidden";return{content:f.createElement(w,{key:ae,name:ae,required:i.isRequired(ae),schema:P.properties[ae],uiSchema:ve,errorSchema:l[ae],idSchema:a[ae],idPrefix:m,formData:(o||{})[ae],wasPropertyKeyModified:i.state.wasPropertyKeyModified,onKeyChange:i.onKeyChange(ae),onChange:i.onPropertyChange(ae,de),onBlur:p,onFocus:y,registry:v,disabled:h,readonly:d,onDropPropertyClick:i.onDropPropertyClick}),name:ae,readonly:d,disabled:h,required:u,hidden:Te}}),readonly:d,disabled:h,required:u,idSchema:a,uiSchema:s,schema:P,formData:o,formContext:k,registry:v};return f.createElement(he,To({},Ce,{onAddClick:this.handleAddClick}))}}]),e}(f.Component);At(zc,"defaultProps",{uiSchema:{},formData:{},errorSchema:{},idSchema:{},required:!1,disabled:!1,readonly:!1});var Vg=zc;function Hr(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Hr=function(t){return typeof t}:Hr=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hr(n)}function $g(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Zc(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Hg(n,e,t){return e&&Zc(n.prototype,e),t&&Zc(n,t),n}function Ug(n,e){return e&&(Hr(e)==="object"||typeof e=="function")?e:zg(n)}function zg(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Bo(n){return Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bo(n)}function Zg(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&Ro(n,e)}function Ro(n,e){return Ro=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Ro(n,e)}function Io(){return Io=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Io.apply(this,arguments)}function qg(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){Kg(n,r,t[r])})}return n}function Kg(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gg(n,e){if(n==null)return{};var t=Jg(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function Jg(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}var Yg="*",Xg={array:"ArrayField",boolean:"BooleanField",integer:"NumberField",number:"NumberField",object:"ObjectField",string:"StringField",null:"NullField"};function _g(n,e,t,i){var r=e["ui:field"];if(typeof r=="function")return r;if(typeof r=="string"&&r in i)return i[r];var s=Xg[di(n)];return!s&&(n.anyOf||n.oneOf)?function(){return null}:s in i?i[s]:function(){var o=i.UnsupportedField;return f.createElement(o,{schema:n,idSchema:t,reason:"Unknown field type ".concat(n.type)})}}function qc(n){var e=n.label,t=n.required,i=n.id;return e?f.createElement("label",{className:"control-label",htmlFor:i},e,t&&f.createElement("span",{className:"required"},Yg)):null}function Qg(n){var e=n.id,t=n.label,i=n.onChange;return f.createElement("input",{className:"form-control",type:"text",id:e,onBlur:function(s){return i(s.target.value)},defaultValue:t})}function ey(n){var e=n.id,t=n.help;return t?typeof t=="string"?f.createElement("p",{id:e,className:"help-block"},t):f.createElement("div",{id:e,className:"help-block"},t):null}function ty(n){var e=n.errors,t=e===void 0?[]:e;return t.length===0?null:f.createElement("div",null,f.createElement("ul",{className:"error-detail bs-callout bs-callout-info"},t.filter(function(i){return!!i}).map(function(i,r){return f.createElement("li",{className:"text-danger",key:r},i)})))}function Kc(n){var e=n.id,t=n.label,i=n.children,r=n.errors,s=n.help,o=n.description,l=n.hidden,a=n.required,c=n.displayLabel;return l?f.createElement("div",{className:"hidden"},i):f.createElement(ny,n,c&&f.createElement(qc,{label:t,required:a,id:e}),c&&o?o:null,i,r,s)}Kc.defaultProps={hidden:!1,readonly:!1,required:!1,displayLabel:!0};function ny(n){var e=n.id,t=n.classNames,i=n.disabled,r=n.label,s=n.onKeyChange,o=n.onDropPropertyClick,l=n.readonly,a=n.required,c=n.schema,u="".concat(r," Key"),h=c.hasOwnProperty(Jr);return h?f.createElement("div",{className:t},f.createElement("div",{className:"row"},f.createElement("div",{className:"col-xs-5 form-additional"},f.createElement("div",{className:"form-group"},f.createElement(qc,{label:u,required:a,id:"".concat(e,"-key")}),f.createElement(Qg,{label:r,required:a,id:"".concat(e,"-key"),onChange:s}))),f.createElement("div",{className:"form-additional form-group col-xs-5"},n.children),f.createElement("div",{className:"col-xs-2"},f.createElement(fe,{type:"danger",icon:"remove",className:"array-item-remove btn-block",tabIndex:"-1",style:{border:"0"},disabled:i||l,onClick:o(r)})))):f.createElement("div",{className:t},n.children)}function iy(n){var e=n.uiSchema,t=n.formData,i=n.errorSchema,r=n.idPrefix,s=n.name,o=n.onChange,l=n.onKeyChange,a=n.onDropPropertyClick,c=n.required,u=n.registry,h=u===void 0?ht():u,d=n.wasPropertyKeyModified,m=d===void 0?!1:d,p=h.rootSchema,y=h.fields,b=h.formContext,v=e["ui:FieldTemplate"]||h.FieldTemplate||Kc,C=n.idSchema,x=De(n.schema,p,t);C=kn(Zn(x,null,p,t,r),C);var k=_g(x,e,C,y),w=y.DescriptionField,O=Boolean(n.disabled||e["ui:disabled"]),F=Boolean(n.readonly||e["ui:readonly"]||n.schema.readOnly||x.readOnly),P=Boolean(n.autofocus||e["ui:autofocus"]);if(Object.keys(x).length===0)return null;var B=bu(x,e,p),N=i.__errors,G=Gg(i,["__errors"]),Q=f.createElement(k,Io({},n,{idSchema:C,schema:x,uiSchema:qg({},e,{classNames:void 0}),disabled:O,readonly:F,autofocus:P,errorSchema:G,formContext:b,rawErrors:N})),he=C.$id,Ce;m?Ce=s:Ce=e["ui:title"]||n.schema.title||x.title||s;var ae=e["ui:description"]||n.schema.description||x.description,de=N,ve=e["ui:help"],Te=e["ui:widget"]==="hidden",Ze=["form-group","field","field-".concat(x.type),de&&de.length>0?"field-error has-error has-danger":"",e.classNames].join(" ").trim(),_e={description:f.createElement(w,{id:he+"__description",description:ae,formContext:b}),rawDescription:ae,help:f.createElement(ey,{id:he+"__help",help:ve}),rawHelp:typeof ve=="string"?ve:void 0,errors:f.createElement(ty,{errors:de}),rawErrors:de,id:he,label:Ce,hidden:Te,onChange:o,onKeyChange:l,onDropPropertyClick:a,required:c,disabled:O,readonly:F,displayLabel:B,classNames:Ze,formContext:b,formData:t,fields:y,schema:x,uiSchema:e,registry:h},kt=h.fields.AnyOfField,Vt=h.fields.OneOfField;return f.createElement(v,_e,f.createElement(f.Fragment,null,Q,x.anyOf&&!Xr(x)&&f.createElement(kt,{disabled:O,errorSchema:i,formData:t,idPrefix:r,idSchema:C,onBlur:n.onBlur,onChange:n.onChange,onFocus:n.onFocus,options:x.anyOf.map(function(cn){return De(cn,p,t)}),baseType:x.type,registry:h,schema:x,uiSchema:e}),x.oneOf&&!Xr(x)&&f.createElement(Vt,{disabled:O,errorSchema:i,formData:t,idPrefix:r,idSchema:C,onBlur:n.onBlur,onChange:n.onChange,onFocus:n.onFocus,options:x.oneOf.map(function(cn){return De(cn,p,t)}),baseType:x.type,registry:h,schema:x,uiSchema:e})))}var Gc=function(n){Zg(e,n);function e(){return $g(this,e),Ug(this,Bo(e).apply(this,arguments))}return Hg(e,[{key:"shouldComponentUpdate",value:function(i,r){return!Ut(this.props,i)}},{key:"render",value:function(){return iy(this.props)}}]),e}(f.Component);Gc.defaultProps={uiSchema:{},errorSchema:{},idSchema:{},disabled:!1,readonly:!1,autofocus:!1};var ry=Gc;function sy(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){oy(n,r,t[r])})}return n}function oy(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ly(n,e){if(n==null)return{};var t=ay(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function ay(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function Jc(n){var e=n.schema,t=n.name,i=n.uiSchema,r=n.idSchema,s=n.formData,o=n.required,l=n.disabled,a=n.readonly,c=n.autofocus,u=n.onChange,h=n.onBlur,d=n.onFocus,m=n.registry,p=m===void 0?ht():m,y=n.rawErrors,b=e.title,v=e.format,C=p.widgets,x=p.formContext,k=Xr(e)&&Qr(e),w=k?"select":"text";v&&V0(e,v,C)&&(w=v);var O=Cn(i),F=O.widget,P=F===void 0?w:F,B=O.placeholder,N=B===void 0?"":B,G=ly(O,["widget","placeholder"]),Q=xn(e,P,C);return f.createElement(Q,{options:sy({},G,{enumOptions:k}),schema:e,uiSchema:i,id:r&&r.$id,label:b===void 0?t:b,value:s,onChange:u,onBlur:h,onFocus:d,required:o,disabled:l,readonly:a,formContext:x,autofocus:c,registry:p,placeholder:N,rawErrors:y})}Jc.defaultProps={uiSchema:{},disabled:!1,readonly:!1,autofocus:!1};var cy=Jc,uy="*";function hy(n){var e=n.id,t=n.title,i=n.required;return f.createElement("legend",{id:e},t,i&&f.createElement("span",{className:"required"},uy))}var fy=hy;function Ur(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ur=function(t){return typeof t}:Ur=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ur(n)}function dy(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Yc(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function my(n,e,t){return e&&Yc(n.prototype,e),t&&Yc(n,t),n}function py(n,e){return e&&(Ur(e)==="object"||typeof e=="function")?e:gy(n)}function gy(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Lo(n){return Lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Lo(n)}function yy(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&No(n,e)}function No(n,e){return No=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},No(n,e)}var vy=function(n){yy(e,n);function e(){return dy(this,e),py(this,Lo(e).apply(this,arguments))}return my(e,[{key:"componentDidMount",value:function(){this.props.formData===void 0&&this.props.onChange(null)}},{key:"render",value:function(){return null}}]),e}(f.Component),by=vy;function wy(n){var e=n.schema,t=n.idSchema,i=n.reason;return f.createElement("div",{className:"unsupported-field"},f.createElement("p",null,"Unsupported field schema",t&&t.$id&&f.createElement("span",null," for"," field ",f.createElement("code",null,t.$id)),i&&f.createElement("em",null,": ",i),"."),e&&f.createElement("pre",null,JSON.stringify(e,null,2)))}var xy=wy,Sy={AnyOfField:jc,ArrayField:lg,BooleanField:hg,DescriptionField:dg,NumberField:Tg,ObjectField:Vg,OneOfField:jc,SchemaField:ry,StringField:cy,TitleField:fy,NullField:by,UnsupportedField:xy};function zr(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zr=function(t){return typeof t}:zr=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zr(n)}function Wo(){return Wo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Wo.apply(this,arguments)}function Cy(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Xc(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function ky(n,e,t){return e&&Xc(n.prototype,e),t&&Xc(n,t),n}function Oy(n,e){return e&&(zr(e)==="object"||typeof e=="function")?e:Zr(n)}function jo(n){return jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},jo(n)}function Zr(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Ay(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&Vo(n,e)}function Vo(n,e){return Vo=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Vo(n,e)}function Ki(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ey(n,e){for(var t=[],i=n;i<=e;i++)t.push({value:i,label:On(i,2)});return t}function Py(n){return Object.keys(n).every(function(e){return n[e]!==-1})}function Dy(n){var e=n.type,t=n.range,i=n.value,r=n.select,s=n.rootId,o=n.disabled,l=n.readonly,a=n.autofocus,c=n.registry,u=n.onBlur,h=s+"_"+e,d=c.widgets.SelectWidget;return f.createElement(d,{schema:{type:"integer"},id:h,className:"form-control",options:{enumOptions:Ey(t[0],t[1])},placeholder:e,value:i,disabled:o,readonly:l,autofocus:a,onChange:function(p){return r(e,p)},onBlur:u})}var _c=function(n){Ay(e,n);function e(t){var i;return Cy(this,e),i=Oy(this,jo(e).call(this,t)),Ki(Zr(i),"onChange",function(r,s){i.setState(Ki({},r,typeof s=="undefined"?-1:s),function(){Py(i.state)&&i.props.onChange(Ou(i.state,i.props.time))})}),Ki(Zr(i),"setNow",function(r){r.preventDefault();var s=i.props,o=s.time,l=s.disabled,a=s.readonly,c=s.onChange;if(!(l||a)){var u=Yi(new Date().toJSON(),o);i.setState(u,function(){return c(Ou(i.state,o))})}}),Ki(Zr(i),"clear",function(r){r.preventDefault();var s=i.props,o=s.time,l=s.disabled,a=s.readonly,c=s.onChange;l||a||i.setState(Yi("",o),function(){return c(void 0)})}),i.state=Yi(t.value,t.time),i}return ky(e,[{key:"componentDidUpdate",value:function(i,r){i.value&&i.value!==Yi(this.props.value,this.props.time)&&this.setState(Yi(this.props.value,this.props.time))}},{key:"shouldComponentUpdate",value:function(i,r){return ul(this,i,r)}},{key:"render",value:function(){var i=this,r=this.props,s=r.id,o=r.disabled,l=r.readonly,a=r.autofocus,c=r.registry,u=r.onBlur,h=r.options;return f.createElement("ul",{className:"list-inline"},this.dateElementProps.map(function(d,m){return f.createElement("li",{key:m},f.createElement(Dy,Wo({rootId:s,select:i.onChange},d,{disabled:o,readonly:l,registry:c,onBlur:u,autofocus:a&&m===0})))}),(h.hideNowButton!=="undefined"?!h.hideNowButton:!0)&&f.createElement("li",null,f.createElement("a",{href:"#",className:"btn btn-info btn-now",onClick:this.setNow},"Now")),(h.hideClearButton!=="undefined"?!h.hideClearButton:!0)&&f.createElement("li",null,f.createElement("a",{href:"#",className:"btn btn-warning btn-clear",onClick:this.clear},"Clear")))}},{key:"dateElementProps",get:function(){var i=this.props,r=i.time,s=i.options,o=this.state,l=o.year,a=o.month,c=o.day,u=o.hour,h=o.minute,d=o.second,m=[{type:"year",range:s.yearsRange,value:l},{type:"month",range:[1,12],value:a},{type:"day",range:[1,31],value:c}];return r&&m.push({type:"hour",range:[0,23],value:u},{type:"minute",range:[0,59],value:h},{type:"second",range:[0,59],value:d}),m}}]),e}(f.Component);Ki(_c,"defaultProps",{time:!1,disabled:!1,readonly:!1,autofocus:!1,options:{yearsRange:[1900,new Date().getFullYear()+2]}});var Qc=_c;function Ty(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){My(n,r,t[r])})}return n}function My(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $o(){return $o=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},$o.apply(this,arguments)}function eu(n){var e=n.registry.widgets.AltDateWidget;return f.createElement(e,$o({time:!0},n))}eu.defaultProps=Ty({},Qc.defaultProps,{time:!0});var Fy=eu;function By(n){return Ly(n)||Iy(n)||Ry()}function Ry(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Iy(n){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]")return Array.from(n)}function Ly(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}function Ho(){return Ho=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ho.apply(this,arguments)}function Ny(n,e){if(n==null)return{};var t=Wy(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function Wy(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function tu(n){if(!n.id)throw console.log("No id for",n),new Error("no id for props ".concat(JSON.stringify(n)));var e=n.value,t=n.readonly,i=n.disabled,r=n.autofocus,s=n.onBlur,o=n.onFocus,l=n.options,a=n.schema,c=n.uiSchema,u=n.formContext,h=n.registry,d=n.rawErrors,m=Ny(n,["value","readonly","disabled","autofocus","onBlur","onFocus","options","schema","uiSchema","formContext","registry","rawErrors"]);l.inputType?m.type=l.inputType:m.type||(a.type==="number"?(m.type="number",m.step="any"):a.type==="integer"?(m.type="number",m.step="1"):m.type="text"),l.autocomplete&&(m.autoComplete=l.autocomplete),a.multipleOf&&(m.step=a.multipleOf),typeof a.minimum!="undefined"&&(m.min=a.minimum),typeof a.maximum!="undefined"&&(m.max=a.maximum);var p=function(b){var v=b.target.value;return n.onChange(v===""?l.emptyValue:v)};return[f.createElement("input",Ho({key:m.id,className:"form-control",readOnly:t,disabled:i,autoFocus:r,value:e==null?"":e},m,{list:a.examples?"examples_".concat(m.id):null,onChange:p,onBlur:s&&function(y){return s(m.id,y.target.value)},onFocus:o&&function(y){return o(m.id,y.target.value)}})),a.examples?f.createElement("datalist",{key:"datalist_".concat(m.id),id:"examples_".concat(m.id)},By(new Set(a.examples.concat(a.default?[a.default]:[]))).map(function(y){return f.createElement("option",{key:y,value:y})})):null]}tu.defaultProps={required:!1,disabled:!1,readonly:!1,autofocus:!1};var jy=tu;function nu(n){var e=n.schema,t=n.id,i=n.value,r=n.disabled,s=n.readonly,o=n.label,l=n.autofocus,a=n.onBlur,c=n.onFocus,u=n.onChange,h=n.DescriptionField,d=_i(e);return f.createElement("div",{className:"checkbox ".concat(r||s?"disabled":"")},e.description&&f.createElement(h,{description:e.description}),f.createElement("label",null,f.createElement("input",{type:"checkbox",id:t,checked:typeof i=="undefined"?!1:i,required:d,disabled:r||s,autoFocus:l,onChange:function(p){return u(p.target.checked)},onBlur:a&&function(m){return a(t,m.target.checked)},onFocus:c&&function(m){return c(t,m.target.checked)}}),f.createElement("span",null,o)))}nu.defaultProps={autofocus:!1};var Vy=nu;function $y(n,e,t){var i=t.indexOf(n),r=e.slice(0,i).concat(n,e.slice(i));return r.sort(function(s,o){return t.indexOf(s)>t.indexOf(o)})}function Hy(n,e){return e.filter(function(t){return t!==n})}function iu(n){var e=n.id,t=n.disabled,i=n.options,r=n.value,s=n.autofocus,o=n.readonly,l=n.onChange,a=i.enumOptions,c=i.enumDisabled,u=i.inline;return f.createElement("div",{className:"checkboxes",id:e},a.map(function(h,d){var m=r.indexOf(h.value)!==-1,p=c&&c.indexOf(h.value)!=-1,y=t||p||o?"disabled":"",b=f.createElement("span",null,f.createElement("input",{type:"checkbox",id:"".concat(e,"_").concat(d),checked:m,disabled:t||p||o,autoFocus:s&&d===0,onChange:function(C){var x=a.map(function(k){var w=k.value;return w});C.target.checked?l($y(h.value,r,x)):l(Hy(h.value,r))}}),f.createElement("span",null,h.label));return u?f.createElement("label",{key:d,className:"checkbox-inline ".concat(y)},b):f.createElement("div",{key:d,className:"checkbox ".concat(y)},f.createElement("label",null,b))}))}iu.defaultProps={autofocus:!1,options:{inline:!1}};var Uy=iu;function Uo(){return Uo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Uo.apply(this,arguments)}function zy(n){var e=n.disabled,t=n.readonly,i=n.registry.widgets.BaseInput;return f.createElement(i,Uo({type:"color"},n,{disabled:e||t}))}var Zy=zy;function zo(){return zo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},zo.apply(this,arguments)}function qy(n){var e=n.onChange,t=n.registry.widgets.BaseInput;return f.createElement(t,zo({type:"date"},n,{onChange:function(r){return e(r||void 0)}}))}var Ky=qy;function Zo(){return Zo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Zo.apply(this,arguments)}function Gy(n){var e=n.value,t=n.onChange,i=n.registry.widgets.BaseInput;return f.createElement(i,Zo({type:"datetime-local"},n,{value:Au(e),onChange:function(s){return t(Eu(s))}}))}var Jy=Gy;function qo(){return qo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},qo.apply(this,arguments)}function Yy(n){var e=n.registry.widgets.BaseInput;return f.createElement(e,qo({type:"email"},n))}var Xy=Yy;function qr(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qr=function(t){return typeof t}:qr=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qr(n)}function _y(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function ru(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Qy(n,e,t){return e&&ru(n.prototype,e),t&&ru(n,t),n}function e0(n,e){return e&&(qr(e)==="object"||typeof e=="function")?e:su(n)}function Ko(n){return Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ko(n)}function su(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function t0(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&Go(n,e)}function Go(n,e){return Go=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Go(n,e)}function n0(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function i0(n,e){return n.replace(";base64",";name=".concat(encodeURIComponent(e),";base64"))}function r0(n){var e=n.name,t=n.size,i=n.type;return new Promise(function(r,s){var o=new window.FileReader;o.onerror=s,o.onload=function(l){r({dataURL:i0(l.target.result,e),name:e,size:t,type:i})},o.readAsDataURL(n)})}function s0(n){return Promise.all([].map.call(n,r0))}function o0(n){var e=n.filesInfo;return e.length===0?null:f.createElement("ul",{className:"file-info"},e.map(function(t,i){var r=t.name,s=t.size,o=t.type;return f.createElement("li",{key:i},f.createElement("strong",null,r)," (",o,", ",s," bytes)")}))}function l0(n){return n.filter(function(e){return typeof e!="undefined"}).map(function(e){var t=J0(e),i=t.blob,r=t.name;return{name:r,size:i.size,type:i.type}})}var ou=function(n){t0(e,n);function e(t){var i;_y(this,e),i=e0(this,Ko(e).call(this,t)),n0(su(i),"onChange",function(o){var l=i.props,a=l.multiple,c=l.onChange;s0(o.target.files).then(function(u){var h={values:u.map(function(d){return d.dataURL}),filesInfo:u};i.setState(h,function(){c(a?h.values:h.values[0])})})});var r=t.value,s=Array.isArray(r)?r:[r];return i.state={values:s,filesInfo:l0(s)},i}return Qy(e,[{key:"shouldComponentUpdate",value:function(i,r){return ul(this,i,r)}},{key:"render",value:function(){var i=this,r=this.props,s=r.multiple,o=r.id,l=r.readonly,a=r.disabled,c=r.autofocus,u=r.options,h=this.state.filesInfo;return f.createElement("div",null,f.createElement("p",null,f.createElement("input",{ref:function(m){return i.inputRef=m},id:o,type:"file",disabled:l||a,onChange:this.onChange,defaultValue:"",autoFocus:c,multiple:s,accept:u.accept})),f.createElement(o0,{filesInfo:h}))}}]),e}(f.Component);ou.defaultProps={autofocus:!1};var a0=ou;function c0(n){var e=n.id,t=n.value;return f.createElement("input",{type:"hidden",id:e,value:typeof t=="undefined"?"":t})}var u0=c0;function Jo(){return Jo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Jo.apply(this,arguments)}function h0(n){var e=n.registry.widgets.BaseInput;return f.createElement(e,Jo({type:"password"},n))}var f0=h0;function lu(n){var e=n.options,t=n.value,i=n.required,r=n.disabled,s=n.readonly,o=n.autofocus,l=n.onBlur,a=n.onFocus,c=n.onChange,u=n.id,h=Math.random().toString(),d=e.enumOptions,m=e.enumDisabled,p=e.inline;return f.createElement("div",{className:"field-radio-group",id:u},d.map(function(y,b){var v=y.value===t,C=m&&m.indexOf(y.value)!=-1,x=r||C||s?"disabled":"",k=f.createElement("span",null,f.createElement("input",{type:"radio",checked:v,name:h,required:i,value:y.value,disabled:r||C||s,autoFocus:o&&b===0,onChange:function(O){return c(y.value)},onBlur:l&&function(w){return l(u,w.target.value)},onFocus:a&&function(w){return a(u,w.target.value)}}),f.createElement("span",null,y.label));return p?f.createElement("label",{key:b,className:"radio-inline ".concat(x)},k):f.createElement("div",{key:b,className:"radio ".concat(x)},f.createElement("label",null,k))}))}lu.defaultProps={autofocus:!1};var d0=lu;function Yo(){return Yo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Yo.apply(this,arguments)}function m0(n){var e=n.schema,t=n.value,i=n.registry.widgets.BaseInput;return f.createElement("div",{className:"field-range-wrapper"},f.createElement(i,Yo({type:"range"},n,hl(e))),f.createElement("span",{className:"range-view"},t))}var p0=m0,g0=new Set(["number","integer"]);function Xo(n,e){var t=n.type,i=n.items;if(e!==""){{if(t==="array"&&i&&g0.has(i.type))return e.map(mi);if(t==="boolean")return e==="true";if(t==="number")return mi(e)}if(n.enum){if(n.enum.every(function(r){return pi(r)==="number"}))return mi(e);if(n.enum.every(function(r){return pi(r)==="boolean"}))return e==="true"}return e}}function _o(n,e){return e?[].slice.call(n.target.options).filter(function(t){return t.selected}).map(function(t){return t.value}):n.target.value}function au(n){var e=n.schema,t=n.id,i=n.options,r=n.value,s=n.required,o=n.disabled,l=n.readonly,a=n.multiple,c=n.autofocus,u=n.onChange,h=n.onBlur,d=n.onFocus,m=n.placeholder,p=i.enumOptions,y=i.enumDisabled,b=a?[]:"";return f.createElement("select",{id:t,multiple:a,className:"form-control",value:typeof r=="undefined"?b:r,required:s,disabled:o||l,autoFocus:c,onBlur:h&&function(v){var C=_o(v,a);h(t,Xo(e,C))},onFocus:d&&function(v){var C=_o(v,a);d(t,Xo(e,C))},onChange:function(C){var x=_o(C,a);u(Xo(e,x))}},!a&&e.default===void 0&&f.createElement("option",{value:""},m),p.map(function(v,C){var x=v.value,k=v.label,w=y&&y.indexOf(x)!=-1;return f.createElement("option",{key:C,value:x,disabled:w},k)}))}au.defaultProps={autofocus:!1};var y0=au;function cu(n){var e=n.id,t=n.options,i=n.placeholder,r=n.value,s=n.required,o=n.disabled,l=n.readonly,a=n.autofocus,c=n.onChange,u=n.onBlur,h=n.onFocus,d=function(p){var y=p.target.value;return c(y===""?t.emptyValue:y)};return f.createElement("textarea",{id:e,className:"form-control",value:r||"",placeholder:i,required:s,disabled:o,readOnly:l,autoFocus:a,rows:t.rows,onBlur:u&&function(m){return u(e,m.target.value)},onFocus:h&&function(m){return h(e,m.target.value)},onChange:d})}cu.defaultProps={autofocus:!1,options:{}};var v0=cu;function b0(n){var e=n.registry.widgets.BaseInput;return f.createElement(e,n)}var w0=b0;function Qo(){return Qo=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Qo.apply(this,arguments)}function x0(n){var e=n.registry.widgets.BaseInput;return f.createElement(e,Qo({type:"url"},n))}var S0=x0;function el(){return el=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},el.apply(this,arguments)}function C0(n){var e=n.registry.widgets.BaseInput;return f.createElement(e,el({type:"number"},n,hl(n.schema)))}var k0=C0,O0={BaseInput:jy,PasswordWidget:f0,RadioWidget:d0,UpDownWidget:k0,RangeWidget:p0,SelectWidget:y0,TextWidget:w0,DateWidget:Ky,DateTimeWidget:Jy,AltDateWidget:Qc,AltDateTimeWidget:Fy,EmailWidget:Xy,URLWidget:S0,TextareaWidget:v0,HiddenWidget:u0,ColorWidget:Zy,FileWidget:a0,CheckboxWidget:Vy,CheckboxesWidget:Uy},A0=g(25497),E0=g.n(A0),P0=g(84778),D0=g.n(P0);function uu(n){return F0(n)||M0(n)||T0()}function T0(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function M0(n){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]")return Array.from(n)}function F0(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}function fi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){Gi(n,r,t[r])})}return n}function Gi(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var wn=du(),hu=null,fu=null,tl="__rjsf_rootSchema";function du(){var n=new(D0())({errorDataPath:"property",allErrors:!0,multipleOfPrecision:8,schemaId:"auto",unknownFormats:"ignore"});return n.addFormat("data-url",/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/),n.addFormat("color",/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/),n}function B0(n){return n.length?n.reduce(function(e,t){var i=t.property,r=t.message,s=E0()(i),o=e;s.length>0&&s[0]===""&&s.splice(0,1);var l=!0,a=!1,c=void 0;try{for(var u=s.slice(0)[Symbol.iterator](),h;!(l=(h=u.next()).done);l=!0){var d=h.value;d in o||(o[d]={}),o=o[d]}}catch(m){a=!0,c=m}finally{try{!l&&u.return!=null&&u.return()}finally{if(a)throw c}}return Array.isArray(o.__errors)?o.__errors=o.__errors.concat(r):r&&(o.__errors=[r]),e},{}):{}}function Un(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"root",t=[];return"__errors"in n&&(t=t.concat(n.__errors.map(function(i){return{stack:"".concat(e,": ").concat(i)}}))),Object.keys(n).reduce(function(i,r){return r!=="__errors"&&(i=i.concat(Un(n[r],r))),i},t)}function nl(n){var e={__errors:[],addError:function(i){this.__errors.push(i)}};return ze(n)?Object.keys(n).reduce(function(t,i){return fi({},t,Gi({},i,nl(n[i])))},e):Array.isArray(n)?n.reduce(function(t,i,r){return fi({},t,Gi({},r,nl(i)))},e):e}function mu(n){return Object.keys(n).reduce(function(e,t){return t==="addError"?e:t==="__errors"?fi({},e,Gi({},t,n[t])):fi({},e,Gi({},t,mu(n[t])))},{})}function R0(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return n===null?[]:n.map(function(e){var t=e.dataPath,i=e.keyword,r=e.message,s=e.params,o=e.schemaPath,l="".concat(t);return{name:i,property:l,message:r,params:s,stack:"".concat(l," ").concat(r).trim(),schemaPath:o}})}function pu(n,e,t,i){var r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=e;n=Yr(e,n,o,!0);var l=!Ut(fu,r),a=!Ut(hu,s);(l||a)&&(wn=du()),r&&l&&Array.isArray(r)&&(wn.addMetaSchema(r),fu=r),s&&a&&ze(s)&&(Object.keys(s).forEach(function(v){wn.addFormat(v,s[v])}),hu=s);var c=null;try{wn.validate(e,n)}catch(v){c=v}var u=R0(wn.errors);wn.errors=null;var h=c&&c.message&&typeof c.message=="string"&&c.message.includes("no schema with key or ref ");h&&(u=[].concat(uu(u),[{stack:c.message}])),typeof i=="function"&&(u=i(u));var d=B0(u);if(h&&(d=fi({},d,{$schema:{__errors:[c.message]}})),typeof t!="function")return{errors:u,errorSchema:d};var m=t(n,nl(n)),p=mu(m),y=kn(d,p,!0),b=Un(y);return{errors:b,errorSchema:y}}function il(n){var e=n;if(n.constructor===Object){e=fi({},n);for(var t in e){var i=e[t];t==="$ref"&&typeof i=="string"&&i.startsWith("#")?e[t]=tl+i:e[t]=il(i)}}else if(Array.isArray(n)){e=uu(n);for(var r=0;r<e.length;r++)e[r]=il(e[r])}return e}function gu(n,e,t){try{return wn.addSchema(t,tl).validate(il(n),e)}catch{return!1}finally{wn.removeSchema(tl)}}function yu(n){var e=I0(n,"string");return Bt(e)==="symbol"?e:String(e)}function I0(n,e){if(Bt(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(Bt(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Kr(n){return W0(n)||N0(n)||L0()}function L0(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function N0(n){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]")return Array.from(n)}function W0(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}function Bt(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Bt=function(t){return typeof t}:Bt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(n)}function Gr(){return Gr=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Gr.apply(this,arguments)}function Rt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){rl(n,r,t[r])})}return n}function rl(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zn(n,e){if(n==null)return{};var t=j0(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function j0(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}var Jr="__additional_property",sl={boolean:{checkbox:"CheckboxWidget",radio:"RadioWidget",select:"SelectWidget",hidden:"HiddenWidget"},string:{text:"TextWidget",password:"PasswordWidget",email:"EmailWidget",hostname:"TextWidget",ipv4:"TextWidget",ipv6:"TextWidget",uri:"URLWidget","data-url":"FileWidget",radio:"RadioWidget",select:"SelectWidget",textarea:"TextareaWidget",hidden:"HiddenWidget",date:"DateWidget",datetime:"DateTimeWidget","date-time":"DateTimeWidget","alt-date":"AltDateWidget","alt-datetime":"AltDateTimeWidget",color:"ColorWidget",file:"FileWidget"},number:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},integer:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},array:{select:"SelectWidget",checkboxes:"CheckboxesWidget",files:"FileWidget",hidden:"HiddenWidget"}};function vu(n,e,t){if(!n.additionalProperties)return!1;var i=Cn(e),r=i.expandable;return r===!1?r:n.maxProperties!==void 0?Object.keys(t).length<n.maxProperties:!0}function ht(){return{fields:Sy,widgets:O0,definitions:{},rootSchema:{},formContext:{}}}function di(n){var e=n.type;return!e&&n.const?pi(n.const):!e&&n.enum?"string":!e&&(n.properties||n.additionalProperties)?"object":e instanceof Array&&e.length===2&&e.includes("null")?e.find(function(t){return t!=="null"}):e}function xn(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=di(n);function r(l){if(!l.MergedWidget){var a=l.defaultProps&&l.defaultProps.options||{};l.MergedWidget=function(c){var u=c.options,h=u===void 0?{}:u,d=zn(c,["options"]);return f.createElement(l,Gr({options:Rt({},a,h)},d))}}return l.MergedWidget}if(typeof e=="function"||Vi.isForwardRef(f.createElement(e))||Vi.isMemo(e))return r(e);if(typeof e!="string")throw new Error("Unsupported widget definition: ".concat(Bt(e)));if(t.hasOwnProperty(e)){var s=t[e];return xn(n,s,t)}if(!sl.hasOwnProperty(i))throw new Error('No widget for type "'.concat(i,'"'));if(sl[i].hasOwnProperty(e)){var o=t[sl[i][e]];return xn(n,o,t)}throw new Error('No widget "'.concat(e,'" for type "').concat(i,'"'))}function V0(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};try{return xn(n,e,t),!0}catch(i){if(i.message&&(i.message.startsWith("No widget")||i.message.startsWith("Unsupported widget")))return!1;throw i}}function Sn(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=ze(n)?n:{},o=ze(i)?i:{},l=e;if(ze(l)&&ze(s.default))l=kn(l,s.default);else if("default"in s)l=s.default;else if("$ref"in s){var a=al(s.$ref,t);return Sn(a,l,t,o,r)}else if("dependencies"in s){var c=Cu(s,t,o);return Sn(c,l,t,o,r)}else ll(s)?l=s.items.map(function(p,y){return Sn(p,Array.isArray(e)?e[y]:void 0,t,o,r)}):"oneOf"in s?s=s.oneOf[Xi(void 0,s.oneOf,t)]:"anyOf"in s&&(s=s.anyOf[Xi(void 0,s.anyOf,t)]);switch(typeof l=="undefined"&&(l=s.default),di(s)){case"object":return Object.keys(s.properties||{}).reduce(function(p,y){var b=Sn(s.properties[y],(l||{})[y],t,(o||{})[y],r);return(r||b!==void 0)&&(p[y]=b),p},{});case"array":if(Array.isArray(l)&&(l=l.map(function(p,y){return Sn(s.items[y]||s.additionalItems||{},p,t)})),Array.isArray(i)&&(l=i.map(function(p,y){return Sn(s.items,(l||{})[y],t,p)})),s.minItems){if(_r(s,t))return l||[];var u=l?l.length:0;if(s.minItems>u){var h=l||[],d=Array.isArray(s.items)?s.additionalItems:s.items,m=wo()(new Array(s.minItems-u),Sn(d,d.defaults,t));return h.concat(m)}}}return l}function Yr(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ze(n))throw new Error("Invalid schema: "+n);var r=De(n,t,e),s=Sn(r,n.default,t,e,i);return typeof e=="undefined"?s:ze(e)||Array.isArray(e)?ol(s,e):e===0||e===!1||e===""?e:e||s}function ol(n,e){if(Array.isArray(e))return Array.isArray(n)||(n=[]),e.map(function(i,r){return n[r]?ol(n[r],i):i});if(ze(e)){var t=Object.assign({},n);return Object.keys(e).reduce(function(i,r){return i[r]=ol(n?n[r]:{},e[r]),i},t)}else return e}function Cn(n){return Object.keys(n).filter(function(e){return e.indexOf("ui:")===0}).reduce(function(e,t){var i=n[t];return t==="ui:widget"&&ze(i)?(console.warn("Setting options via ui:widget object is deprecated, use ui:options instead"),Rt({},e,i.options||{},{widget:i.component})):t==="ui:options"&&ze(i)?Rt({},e,i):Rt({},e,rl({},t.substring(3),i))},{})}function bu(n,e,t){var i=Cn(e),r=i.label,s=r===void 0?!0:r,o=di(n);return o==="array"&&(s=_r(n,t)||wu(n,e,t)),o==="object"&&(s=!1),o==="boolean"&&!e["ui:widget"]&&(s=!1),e["ui:field"]&&(s=!1),s}function ze(n){return typeof File!="undefined"&&n instanceof File?!1:Bt(n)==="object"&&n!==null&&!Array.isArray(n)}function kn(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=Object.assign({},n);return Object.keys(e).reduce(function(r,s){var o=n?n[s]:{},l=e[s];return n&&n.hasOwnProperty(s)&&ze(l)?r[s]=kn(o,l,t):t&&Array.isArray(o)&&Array.isArray(l)?r[s]=o.concat(l):r[s]=l,r},i)}function mi(n){if(n!==""){if(n===null)return null;if(/\.$/.test(n)||/\.0$/.test(n))return n;var e=Number(n),t=typeof e=="number"&&!Number.isNaN(e);return/\.\d*0$/.test(n)?n:t?e:n}}function $0(n,e){if(!Array.isArray(e))return n;var t=function(h){return h.reduce(function(d,m){return d[m]=!0,d},{})},i=function(h){return h.length>1?"properties '".concat(h.join("', '"),"'"):"property '".concat(h[0],"'")},r=t(n),s=e.filter(function(u){return u==="*"||r[u]}),o=t(s),l=n.filter(function(u){return!o[u]}),a=s.indexOf("*");if(a===-1){if(l.length)throw new Error("uiSchema order list does not contain ".concat(i(l)));return s}if(a!==s.lastIndexOf("*"))throw new Error("uiSchema order list contains more than one wildcard item");var c=Kr(s);return c.splice.apply(c,[a,1].concat(Kr(l))),c}function H0(n){return Array.isArray(n.enum)&&n.enum.length===1||n.hasOwnProperty("const")}function U0(n){if(Array.isArray(n.enum)&&n.enum.length===1)return n.enum[0];if(n.hasOwnProperty("const"))return n.const;throw new Error("schema cannot be inferred as a constant")}function Xr(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=De(n,e),i=t.oneOf||t.anyOf;return Array.isArray(t.enum)?!0:Array.isArray(i)?i.every(function(r){return H0(r)}):!1}function _r(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return!n.uniqueItems||!n.items?!1:Xr(n.items,e)}function wu(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e["ui:widget"]==="files")return!0;if(n.items){var i=De(n.items,t);return i.type==="string"&&i.format==="data-url"}return!1}function ll(n){return Array.isArray(n.items)&&n.items.length>0&&n.items.every(function(e){return ze(e)})}function xu(n){return n.additionalItems===!0&&console.warn("additionalItems=true is currently not supported"),ze(n.additionalItems)}function Qr(n){if(n.enum)return n.enum.map(function(t,i){var r=n.enumNames&&n.enumNames[i]||String(t);return{label:r,value:t}});var e=n.oneOf||n.anyOf;return e.map(function(t,i){var r=U0(t),s=t.title||String(r);return{schema:t,label:s,value:r}})}function al(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=n;if(n.startsWith("#"))n=decodeURIComponent(n.substring(1));else throw new Error("Could not find a definition for ".concat(t,"."));var i=A.get(e,n);if(i===void 0)throw new Error("Could not find a definition for ".concat(t,"."));return i.hasOwnProperty("$ref")?al(i.$ref,e):i}var pi=function(e){if(Array.isArray(e))return"array";if(typeof e=="string")return"string";if(e==null)return"null";if(typeof e=="boolean")return"boolean";if(isNaN(e)){if(Bt(e)==="object")return"object"}else return"number";return"string"};function z0(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return n=Rt({},n,{properties:Rt({},n.properties)}),t=ze(t)?t:{},Object.keys(t).forEach(function(i){if(!n.properties.hasOwnProperty(i)){var r;n.additionalProperties.hasOwnProperty("$ref")?r=De({$ref:n.additionalProperties.$ref},e,t):n.additionalProperties.hasOwnProperty("type")?r=Rt({},n.additionalProperties):r={type:pi(t[i])},n.properties[i]=r,n.properties[i][Jr]=!0}}),n}function Z0(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.hasOwnProperty("$ref"))return Su(n,e,t);if(n.hasOwnProperty("dependencies")){var i=Cu(n,e,t);return De(i,e,t)}else return n.hasOwnProperty("allOf")?Rt({},n,{allOf:n.allOf.map(function(r){return De(r,e,t)})}):n}function Su(n,e,t){var i=al(n.$ref,e),r=n.$ref,s=zn(n,["$ref"]);return De(Rt({},i,s),e,t)}function De(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!ze(n))return{};var i=Z0(n,e,t);if("allOf"in n)try{i=$i()(Rt({},i,{allOf:i.allOf}))}catch(a){console.warn(`could not merge subschemas in allOf:
`+a);var r=i,s=r.allOf,o=zn(r,["allOf"]);return o}var l=i.hasOwnProperty("additionalProperties")&&i.additionalProperties!==!1;return l?z0(i,e,t):i}function Cu(n,e,t){var i=n.dependencies,r=i===void 0?{}:i,s=zn(n,["dependencies"]);return"oneOf"in s?s=s.oneOf[Xi(t,s.oneOf,e)]:"anyOf"in s&&(s=s.anyOf[Xi(t,s.anyOf,e)]),ku(r,s,e,t)}function ku(n,e,t,i){for(var r in n)if(i[r]!==void 0&&!(e.properties&&!(r in e.properties))){var s=n[r],o=zn(n,[r].map(yu));return Array.isArray(s)?e=q0(e,s):ze(s)&&(e=K0(e,t,i,r,s)),ku(o,e,t,i)}return e}function q0(n,e){if(!e)return n;var t=Array.isArray(n.required)?Array.from(new Set([].concat(Kr(n.required),Kr(e)))):e;return Rt({},n,{required:t})}function K0(n,e,t,i,r){var s=De(r,e,t),o=s.oneOf,l=zn(s,["oneOf"]);if(n=cl(n,l),o===void 0)return n;if(!Array.isArray(o))throw new Error("invalid: it is some ".concat(Bt(o)," instead of an array"));var a=o.map(function(c){return c.hasOwnProperty("$ref")?Su(c,e,t):c});return G0(n,e,t,i,a)}function G0(n,e,t,i,r){var s=r.filter(function(h){if(!h.properties)return!1;var d=h.properties[i];if(d){var m={type:"object",properties:rl({},i,d)},p=pu(t,m),y=p.errors;return y.length===0}});if(s.length!==1)return console.warn("ignoring oneOf in dependencies because there isn't exactly one subschema that is valid"),n;var o=s[0],l=o.properties,a=l[i],c=zn(l,[i].map(yu)),u=Rt({},o,{properties:c});return cl(n,De(u,e,t))}function cl(n,e){var t=Object.assign({},n);return Object.keys(e).reduce(function(i,r){var s=n?n[r]:{},o=e[r];return n&&n.hasOwnProperty(r)&&ze(o)?i[r]=cl(s,o):n&&e&&(di(n)==="object"||di(e)==="object")&&r==="required"&&Array.isArray(s)&&Array.isArray(o)?i[r]=Hi()(s,o):i[r]=o,i},t)}function es(n){return Object.prototype.toString.call(n)==="[object Arguments]"}function Ut(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(n===e)return!0;if(typeof n=="function"||typeof e=="function")return!0;if(Bt(n)!=="object"||Bt(e)!=="object")return!1;if(n===null||e===null)return!1;if(n instanceof Date&&e instanceof Date)return n.getTime()===e.getTime();if(n instanceof RegExp&&e instanceof RegExp)return n.source===e.source&&n.global===e.global&&n.multiline===e.multiline&&n.lastIndex===e.lastIndex&&n.ignoreCase===e.ignoreCase;if(es(n)||es(e)){if(!(es(n)&&es(e)))return!1;var r=Array.prototype.slice;return Ut(r.call(n),r.call(e),t,i)}else{if(n.constructor!==e.constructor)return!1;var s=Object.keys(n),o=Object.keys(e);if(s.length===0&&o.length===0)return!0;if(s.length!==o.length)return!1;for(var l=t.length;l--;)if(t[l]===n)return i[l]===e;t.push(n),i.push(e),s.sort(),o.sort();for(var a=s.length-1;a>=0;a--)if(s[a]!==o[a])return!1;for(var c,u=s.length-1;u>=0;u--)if(c=s[u],!Ut(n[c],e[c],t,i))return!1;return t.pop(),i.pop(),!0}}function ul(n,e,t){var i=n.props,r=n.state;return!Ut(i,e)||!Ut(r,t)}function Zn(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"root",s={$id:e||r};if("$ref"in n||"dependencies"in n||"allOf"in n){var o=De(n,t,i);return Zn(o,e,t,i,r)}if("items"in n&&!n.items.$ref)return Zn(n.items,e,t,i,r);if(n.type!=="object")return s;for(var l in n.properties||{}){var a=n.properties[l],c=s.$id+"_"+l;s[l]=Zn(ze(a)?a:{},c,t,(i||{})[l],r)}return s}function Ji(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r={$name:e.replace(/^\./,"")};if("$ref"in n||"dependencies"in n||"allOf"in n){var s=De(n,t,i);return Ji(s,e,t,i)}if(n.hasOwnProperty("additionalProperties")&&(r.__rjsf_additionalProperties=!0),n.hasOwnProperty("items")&&Array.isArray(i))i.forEach(function(l,a){r[a]=Ji(n.items,"".concat(e,".").concat(a),t,l)});else if(n.hasOwnProperty("properties"))for(var o in n.properties)r[o]=Ji(n.properties[o],"".concat(e,".").concat(o),t,(i||{})[o]);return r}function Yi(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!n)return{year:-1,month:-1,day:-1,hour:e?-1:0,minute:e?-1:0,second:e?-1:0};var t=new Date(n);if(Number.isNaN(t.getTime()))throw new Error("Unable to parse date "+n);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:e?t.getUTCHours():0,minute:e?t.getUTCMinutes():0,second:e?t.getUTCSeconds():0}}function Ou(n){var e=n.year,t=n.month,i=n.day,r=n.hour,s=r===void 0?0:r,o=n.minute,l=o===void 0?0:o,a=n.second,c=a===void 0?0:a,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,h=Date.UTC(e,t-1,i,s,l,c),d=new Date(h).toJSON();return u?d:d.slice(0,10)}function Au(n){if(!n)return"";var e=new Date(n),t=On(e.getFullYear(),4),i=On(e.getMonth()+1,2),r=On(e.getDate(),2),s=On(e.getHours(),2),o=On(e.getMinutes(),2),l=On(e.getSeconds(),2),a=On(e.getMilliseconds(),3);return"".concat(t,"-").concat(i,"-").concat(r,"T").concat(s,":").concat(o,":").concat(l,".").concat(a)}function Eu(n){if(n)return new Date(n).toJSON()}function On(n,e){for(var t=String(n);t.length<e;)t="0"+t;return t}function J0(n){var e=n.split(","),t=e[0].split(";"),i=t[0].replace("data:",""),r=t.filter(function(u){return u.split("=")[0]==="name"}),s;r.length!==1?s="unknown":s=r[0].split("=")[1];for(var o=atob(e[1]),l=[],a=0;a<o.length;a++)l.push(o.charCodeAt(a));var c=new window.Blob([new Uint8Array(l)],{type:i});return{blob:c,name:s}}function hl(n){var e={};return n.multipleOf&&(e.step=n.multipleOf),(n.minimum||n.minimum===0)&&(e.min=n.minimum),(n.maximum||n.maximum===0)&&(e.max=n.maximum),e}function Xi(n,e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.properties){var s={anyOf:Object.keys(r.properties).map(function(a){return{required:[a]}})},o=void 0;if(r.anyOf){var l=Gr({},r);l.allOf?l.allOf=l.allOf.slice():l.allOf=[],l.allOf.push(s),o=l}else o=Object.assign({},r,s);if(delete o.required,gu(o,n,t))return i}else if(gu(r,n,t))return i}return 0}function _i(n){return n.const||n.enum&&n.enum.length===1&&n.enum[0]===!0?!0:n.anyOf&&n.anyOf.length===1?_i(n.anyOf[0]):n.oneOf&&n.oneOf.length===1?_i(n.oneOf[0]):n.allOf?n.allOf.some(_i):!1}function fl(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){An(n,r,t[r])})}return n}function qn(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qn=function(t){return typeof t}:qn=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qn(n)}function Y0(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Pu(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function X0(n,e,t){return e&&Pu(n.prototype,e),t&&Pu(n,t),n}function _0(n,e){return e&&(qn(e)==="object"||typeof e=="function")?e:Kn(n)}function dl(n){return dl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},dl(n)}function Kn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Q0(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&ml(n,e)}function ml(n,e){return ml=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},ml(n,e)}function An(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var Du=function(n){Q0(e,n);function e(t){var i;return Y0(this,e),i=_0(this,dl(e).call(this,t)),An(Kn(i),"getUsedFormData",function(r,s){if(s.length===0&&qn(r)!=="object")return r;var o=Wi()(r,s);return Array.isArray(r)?Object.keys(o).map(function(l){return o[l]}):o}),An(Kn(i),"getFieldNames",function(r,s){var o=function l(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[""];return Object.keys(a).forEach(function(h){if(qn(a[h])==="object"){var d=u.map(function(m){return"".concat(m,".").concat(h)});a[h].__rjsf_additionalProperties&&a[h].$name!==""?c.push(a[h].$name):l(a[h],c,d)}else h==="$name"&&a[h]!==""&&u.forEach(function(m){m=m.replace(/^\./,"");var p=ji()(s,m);(qn(p)!=="object"||vo()(p))&&c.push(m)})}),c};return o(r)}),An(Kn(i),"onChange",function(r,s){if(ze(r)||Array.isArray(r)){var o=i.getStateFromProps(i.props,r);r=o.formData}var l=!i.props.noValidate&&i.props.liveValidate,a={formData:r},c=r;if(i.props.omitExtraData===!0&&i.props.liveOmit===!0){var u=De(i.state.schema,i.state.schema,r),h=Ji(u,"",i.state.schema,r),d=i.getFieldNames(h,r);c=i.getUsedFormData(r,d),a={formData:c}}if(l){var m=i.validate(c),p=m.errors,y=m.errorSchema,b=p,v=y;i.props.extraErrors&&(y=kn(y,i.props.extraErrors,!0),p=Un(y)),a={formData:c,errors:p,errorSchema:y,schemaValidationErrors:b,schemaValidationErrorSchema:v}}else if(!i.props.noValidate&&s){var C=i.props.extraErrors?kn(s,i.props.extraErrors,!0):s;a={formData:c,errorSchema:C,errors:Un(C)}}i.setState(a,function(){return i.props.onChange&&i.props.onChange(i.state)})}),An(Kn(i),"onBlur",function(){if(i.props.onBlur){var r;(r=i.props).onBlur.apply(r,arguments)}}),An(Kn(i),"onFocus",function(){if(i.props.onFocus){var r;(r=i.props).onFocus.apply(r,arguments)}}),An(Kn(i),"onSubmit",function(r){if(r.preventDefault(),r.target===r.currentTarget){r.persist();var s=i.state.formData;if(i.props.omitExtraData===!0){var o=De(i.state.schema,i.state.schema,s),l=Ji(o,"",i.state.schema,s),a=i.getFieldNames(l,s);s=i.getUsedFormData(s,a)}if(!i.props.noValidate){var c=i.validate(s),u=c.errors,h=c.errorSchema,d=u,m=h;if(Object.keys(u).length>0){i.props.extraErrors&&(h=kn(h,i.props.extraErrors,!0),u=Un(h)),i.setState({errors:u,errorSchema:h,schemaValidationErrors:d,schemaValidationErrorSchema:m},function(){i.props.onError?i.props.onError(u):console.error("Form validation failed",u)});return}}var p,y;i.props.extraErrors?(p=i.props.extraErrors,y=Un(p)):(p={},y=[]),i.setState({formData:s,errors:y,errorSchema:p,schemaValidationErrors:[],schemaValidationErrorSchema:{}},function(){i.props.onSubmit&&i.props.onSubmit(fl({},i.state,{formData:s,status:"submitted"}),r)})}}),i.state=i.getStateFromProps(t,t.formData),i.props.onChange&&!Ut(i.state.formData,i.props.formData)&&i.props.onChange(i.state),i.formElement=null,i}return X0(e,[{key:"UNSAFE_componentWillReceiveProps",value:function(i){var r=this.getStateFromProps(i,i.formData);!Ut(r.formData,i.formData)&&!Ut(r.formData,this.state.formData)&&this.props.onChange&&this.props.onChange(r),this.setState(r)}},{key:"getStateFromProps",value:function(i,r){var s=this.state||{},o="schema"in i?i.schema:this.props.schema,l="uiSchema"in i?i.uiSchema:this.props.uiSchema,a=typeof r!="undefined",c="liveValidate"in i?i.liveValidate:this.props.liveValidate,u=a&&!i.noValidate&&c,h=o,d=Yr(o,r,h),m=De(o,h,d),p=i.customFormats,y=i.additionalMetaSchemas,b=function(){return i.noValidate?{errors:[],errorSchema:{}}:i.liveValidate?{errors:s.errors||[],errorSchema:s.errorSchema||{}}:{errors:s.schemaValidationErrors||[],errorSchema:s.schemaValidationErrorSchema||{}}},v,C,x,k;if(u){var w=this.validate(d,o,y,p);v=w.errors,C=w.errorSchema,x=v,k=C}else{var O=b();v=O.errors,C=O.errorSchema,x=s.schemaValidationErrors,k=s.schemaValidationErrorSchema}i.extraErrors&&(C=kn(C,i.extraErrors,!0),v=Un(C));var F=Zn(m,l["ui:rootFieldId"],h,d,i.idPrefix),P={schema:o,uiSchema:l,idSchema:F,formData:d,edit:a,errors:v,errorSchema:C,additionalMetaSchemas:y};return x&&(P.schemaValidationErrors=x,P.schemaValidationErrorSchema=k),P}},{key:"shouldComponentUpdate",value:function(i,r){return ul(this,i,r)}},{key:"validate",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.props.schema,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.props.additionalMetaSchemas,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:this.props.customFormats,l=this.props,a=l.validate,c=l.transformErrors,u=this.getRegistry(),h=u.rootSchema,d=De(r,h,i);return pu(i,d,a,c,s,o)}},{key:"renderErrors",value:function(){var i=this.state,r=i.errors,s=i.errorSchema,o=i.schema,l=i.uiSchema,a=this.props,c=a.ErrorList,u=a.showErrorList,h=a.formContext;return r.length&&u!=!1?f.createElement(c,{errors:r,errorSchema:s,schema:o,uiSchema:l,formContext:h}):null}},{key:"getRegistry",value:function(){var i=ht(),r=i.fields,s=i.widgets;return{fields:fl({},r,this.props.fields),widgets:fl({},s,this.props.widgets),ArrayFieldTemplate:this.props.ArrayFieldTemplate,ObjectFieldTemplate:this.props.ObjectFieldTemplate,FieldTemplate:this.props.FieldTemplate,definitions:this.props.schema.definitions||{},rootSchema:this.props.schema,formContext:this.props.formContext||{}}}},{key:"submit",value:function(){this.formElement&&this.formElement.dispatchEvent(new CustomEvent("submit",{cancelable:!0}))}},{key:"render",value:function(){var i=this,r=this.props,s=r.children,o=r.id,l=r.idPrefix,a=r.className,c=r.tagName,u=r.name,h=r.method,d=r.target,m=r.action,p=r.autocomplete,y=r.autoComplete,b=r.enctype,v=r.acceptcharset,C=r.noHtml5Validate,x=r.disabled,k=r.readonly,w=r.formContext,O=this.state,F=O.schema,P=O.uiSchema,B=O.formData,N=O.errorSchema,G=O.idSchema,Q=this.getRegistry(),he=Q.fields.SchemaField,Ce=c||"form";p&&console.warn("Using autocomplete property of Form is deprecated, use autoComplete instead.");var ae=y||p;return f.createElement(Ce,{className:a||"rjsf",id:o,name:u,method:h,target:d,action:m,autoComplete:ae,encType:b,acceptCharset:v,noValidate:C,onSubmit:this.onSubmit,ref:function(ve){i.formElement=ve}},this.renderErrors(),f.createElement(he,{schema:F,uiSchema:P,errorSchema:N,idSchema:G,idPrefix:l,formContext:w,formData:B,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,registry:Q,disabled:x,readonly:k}),s||f.createElement("div",null,f.createElement("button",{type:"submit",className:"btn btn-info"},"Submit")))}}]),e}(f.Component);An(Du,"defaultProps",{uiSchema:{},noValidate:!1,liveValidate:!1,disabled:!1,readonly:!1,noHtml5Validate:!1,ErrorList:bo,omitExtraData:!1});function pl(){return pl=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},pl.apply(this,arguments)}function Tu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.forEach(function(r){ev(n,r,t[r])})}return n}function ev(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tv(n,e){if(n==null)return{};var t=nv(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(n,i)||(t[i]=n[i]))}return t}function nv(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function Mu(n){return(0,f.forwardRef)(function(e,t){var i=e.fields,r=e.widgets,s=tv(e,["fields","widgets"]);return i=Tu({},n.fields,i),r=Tu({},n.widgets,r),f.createElement(rv,pl({},n,s,{fields:i,widgets:r,ref:t}))})}Mu.propTypes={widgets:ie().object,fields:ie().object};var iv=Mu,rv=Du,Fu=g(65549),sv=g(90324),ov=g(70595),lv=g(17373),Bu=g(11776),Ru=g(38402),av=g(86136),cv=g(16715),uv=g(49378),Iu=g(64860),hv=g(85256),Lu=g(74828),Nu=g(29611),Wu=g(21324),gl=g(5806),yl=g(84899),fv=g(64326),dv=g(44962),mv=g(2682),pv=g(11433),vl=g(86619);function Qi(){return Qi=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Qi.apply(this,arguments)}function bl(n){if(n==null)throw new TypeError("Cannot destructure undefined")}function ju(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}var wl=function(e){return f.createElement(st.Z,Object.assign({},e,{color:"secondary"}),f.createElement(Fu.Z,null)," Add Item")},gv={remove:lv.Z,plus:Fu.Z,"arrow-up":sv.Z,"arrow-down":ov.Z},ts=function(e){var t=e.icon,i=e.iconProps,r=ju(e,["icon","className","iconProps"]),s=gv[t];return f.createElement(st.Z,Object.assign({},r,{size:"small"}),f.createElement(s,Object.assign({},i)))},yv=_r,vv=ht,bv=function(e){var t=e.schema,i=e.registry,r=i===void 0?vv():i;return yv(t,r.rootSchema)?f.createElement(xv,Object.assign({},e)):f.createElement(Sv,Object.assign({},e))},Vu=function(e){var t=e.TitleField,i=e.idSchema,r=e.title,s=e.required;if(!r)return null;var o=i.$id+"__title";return f.createElement(t,{id:o,title:r,required:s})},wv=function(e){var t=e.DescriptionField,i=e.idSchema,r=e.description;if(!r)return null;var s=i.$id+"__description";return f.createElement(t,{id:s,description:r})},$u=function(e){var t={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold",minWidth:0};return f.createElement(ye.Z,{container:!0,key:e.key,alignItems:"center"},f.createElement(ye.Z,{item:!0,xs:!0,style:{overflow:"auto"}},f.createElement(me.Z,{mb:2},f.createElement(bt.Z,{elevation:2},f.createElement(me.Z,{p:2},e.children)))),e.hasToolbar&&f.createElement(ye.Z,{item:!0},(e.hasMoveUp||e.hasMoveDown)&&f.createElement(ts,{icon:"arrow-up",className:"array-item-move-up",tabIndex:-1,style:t,iconProps:{fontSize:"small"},disabled:e.disabled||e.readonly||!e.hasMoveUp,onClick:e.onReorderClick(e.index,e.index-1)}),(e.hasMoveUp||e.hasMoveDown)&&f.createElement(ts,{icon:"arrow-down",tabIndex:-1,style:t,iconProps:{fontSize:"small"},disabled:e.disabled||e.readonly||!e.hasMoveDown,onClick:e.onReorderClick(e.index,e.index+1)}),e.hasRemove&&f.createElement(ts,{icon:"remove",tabIndex:-1,style:t,iconProps:{fontSize:"small"},disabled:e.disabled||e.readonly,onClick:e.onDropIndexClick(e.index)})))},xv=function(e){return f.createElement("fieldset",{className:e.className},f.createElement(Vu,{key:"array-field-title-"+e.idSchema.$id,TitleField:e.TitleField,idSchema:e.idSchema,title:e.uiSchema["ui:title"]||e.title,required:e.required}),(e.uiSchema["ui:description"]||e.schema.description)&&f.createElement("div",{className:"field-description",key:"field-description-"+e.idSchema.$id},e.uiSchema["ui:description"]||e.schema.description),f.createElement("div",{className:"row array-item-list",key:"array-item-list-"+e.idSchema.$id},e.items&&e.items.map($u)),e.canAdd&&f.createElement(wl,{className:"array-item-add",onClick:e.onAddClick,disabled:e.disabled||e.readonly}))},Sv=function(e){return f.createElement(bt.Z,{elevation:2},f.createElement(me.Z,{p:2},f.createElement(Vu,{key:"array-field-title-"+e.idSchema.$id,TitleField:e.TitleField,idSchema:e.idSchema,title:e.uiSchema["ui:title"]||e.title,required:e.required}),(e.uiSchema["ui:description"]||e.schema.description)&&f.createElement(wv,{key:"array-field-description-"+e.idSchema.$id,DescriptionField:e.DescriptionField,idSchema:e.idSchema,description:e.uiSchema["ui:description"]||e.schema.description}),f.createElement(ye.Z,{container:!0,key:"array-item-list-"+e.idSchema.$id},e.items&&e.items.map(function(t){return $u(t)}),e.canAdd&&f.createElement(ye.Z,{container:!0,justify:"flex-end"},f.createElement(ye.Z,{item:!0},f.createElement(me.Z,{mt:2},f.createElement(wl,{className:"array-item-add",onClick:e.onAddClick,disabled:e.disabled||e.readonly})))))))},Cv=function(e){var t=e.errors;return f.createElement(bt.Z,{elevation:2},f.createElement(me.Z,{mb:2,p:2},f.createElement(S.Z,{variant:"h6"},"Errors"),f.createElement(Bu.Z,{dense:!0},t.map(function(i,r){return f.createElement(Ru.Z,{key:r},f.createElement(av.Z,null,f.createElement(cv.Z,{color:"error"})),f.createElement(uv.Z,{primary:i.stack}))}))))},kv=(0,Iu.Z)({root:{marginTop:5}}),Ov=function(e){var t=e.description;if(t){var i=kv();return f.createElement(S.Z,{variant:"subtitle2",className:i.root},t)}return null},Av=function(e){var t=e.title;return f.createElement(f.Fragment,null,f.createElement(me.Z,{mb:1,mt:1},f.createElement(S.Z,{variant:"h5"},t),f.createElement(hv.Z,null)))},Ev={DescriptionField:Ov,TitleField:Av},Pv=Jr,Dv=function(e){var t=e.children,i=e.disabled,r=e.id,s=e.label,o=e.onDropPropertyClick,l=e.onKeyChange,a=e.readonly,c=e.required,u=e.schema,h=s+" Key",d=u.hasOwnProperty(Pv),m={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"};if(!d)return f.createElement(f.Fragment,null,t);var p=function(b){var v=b.target;return l(v.value)};return f.createElement(ye.Z,{container:!0,key:r+"-key",alignItems:"center",spacing:2},f.createElement(ye.Z,{item:!0,xs:!0},f.createElement(Ot.Z,{fullWidth:!0,required:c},f.createElement(Pe.Z,null,h),f.createElement(Nu.Z,{defaultValue:s,disabled:i||a,id:r+"-key",name:r+"-key",onBlur:a?void 0:p,type:"text"}))),f.createElement(ye.Z,{item:!0,xs:!0},t),f.createElement(ye.Z,{item:!0},f.createElement(ts,{icon:"remove",tabIndex:-1,style:m,disabled:i||a,onClick:o(s)})))},Tv=function(e){var t=e.id,i=e.children,r=e.classNames,s=e.disabled,o=e.displayLabel,l=e.hidden,a=e.label,c=e.onDropPropertyClick,u=e.onKeyChange,h=e.readonly,d=e.required,m=e.rawErrors,p=m===void 0?[]:m,y=e.rawHelp,b=e.rawDescription,v=e.schema;return l?i:f.createElement(Dv,{classNames:r,disabled:s,id:t,label:a,onDropPropertyClick:c,onKeyChange:u,readonly:h,required:d,schema:v},f.createElement(Ot.Z,{fullWidth:!0,error:!!p.length,required:d},i,o&&b?f.createElement(S.Z,{variant:"caption",color:"textSecondary"},b):null,p.length>0&&f.createElement(Bu.Z,{dense:!0,disablePadding:!0},p.map(function(C,x){return f.createElement(Ru.Z,{key:x,disableGutters:!0},f.createElement(Lu.Z,{id:t},C))})),y&&f.createElement(Lu.Z,{id:t},y)))},Mv=vu,Fv=(0,Iu.Z)({root:{marginTop:10}}),Bv=function(e){var t=e.DescriptionField,i=e.description,r=e.TitleField,s=e.title,o=e.properties,l=e.required,a=e.disabled,c=e.readonly,u=e.uiSchema,h=e.idSchema,d=e.schema,m=e.formData,p=e.onAddClick,y=Fv();return f.createElement(f.Fragment,null,(u["ui:title"]||s)&&f.createElement(r,{id:h.$id+"-title",title:s,required:l}),i&&f.createElement(t,{id:h.$id+"-description",description:i}),f.createElement(ye.Z,{container:!0,spacing:2,className:y.root},o.map(function(b,v){return b.hidden?b.content:f.createElement(ye.Z,{item:!0,xs:12,key:v,style:{marginBottom:"10px"}},b.content)}),Mv(d,u,m)&&f.createElement(ye.Z,{container:!0,justify:"flex-end"},f.createElement(ye.Z,{item:!0},f.createElement(wl,{className:"object-property-expand",onClick:p(d),disabled:a||c})))))},Rv=_i,Iv=function(e){var t=e.schema,i=e.id,r=e.value,s=e.disabled,o=e.readonly,l=e.label,a=e.autofocus,c=e.onChange,u=e.onBlur,h=e.onFocus,d=Rv(t),m=function(v,C){return bl(v),c(C)},p=function(v){var C=v.target.value;return u(i,C)},y=function(v){var C=v.target.value;return h(i,C)};return f.createElement(gl.Z,{control:f.createElement(Wu.Z,{id:i,checked:typeof r=="undefined"?!1:r,required:d,disabled:s||o,autoFocus:a,onChange:m,onBlur:p,onFocus:y}),label:l})},Lv=function(e,t,i){var r=i.indexOf(e),s=t.slice(0,r).concat(e,t.slice(r));return s.sort(function(o,l){return i.indexOf(o)>i.indexOf(l)})},Nv=function(e,t){return t.filter(function(i){return i!==e})},Wv=function(e){var t=e.schema,i=e.label,r=e.id,s=e.disabled,o=e.options,l=e.value,a=e.autofocus,c=e.readonly,u=e.required,h=e.onChange,d=e.onBlur,m=e.onFocus,p=o.enumOptions,y=o.enumDisabled,b=o.inline,v=function(w){return function(O){var F=O.target.checked,P=p.map(function(B){var N=B.value;return N});h(F?Lv(w.value,l,P):Nv(w.value,l))}},C=function(w){var O=w.target.value;return d(r,O)},x=function(w){var O=w.target.value;return m(r,O)};return f.createElement(f.Fragment,null,f.createElement(yl.Z,{required:u,htmlFor:r},i||t.title),f.createElement(fv.Z,{row:!!b},p.map(function(k,w){var O=l.indexOf(k.value)!==-1,F=y&&y.indexOf(k.value)!=-1,P=f.createElement(Wu.Z,{id:r+"_"+w,checked:O,disabled:s||F||c,autoFocus:a&&w===0,onChange:v(k),onBlur:C,onFocus:x});return f.createElement(gl.Z,{control:P,key:w,label:k.label})})))},jv=function(e){var t=e.registry,i=t.widgets.TextWidget;return f.createElement(i,Object.assign({type:"color"},e))},Vv=function(e){var t=e.registry,i=t.widgets.TextWidget;return f.createElement(i,Object.assign({type:"date",InputLabelProps:{shrink:!0}},e))},$v=Eu,Hv=Au,Uv=function(e){var t=e.registry,i=t.widgets.TextWidget,r=Hv(e.value),s=function(l){e.onChange($v(l))};return f.createElement(i,Object.assign({type:"datetime-local",InputLabelProps:{shrink:!0}},e,{value:r,onChange:s}))},zv=function(e){var t=e.registry,i=t.widgets.TextWidget;return f.createElement(i,Object.assign({type:"email"},e))},Zv=function(e){var t=e.registry,i=t.widgets.TextWidget;return f.createElement(i,Object.assign({type:"password"},e))},qv=function(e){var t=e.id,i=e.schema,r=e.options,s=e.value,o=e.required,l=e.disabled,a=e.readonly,c=e.label,u=e.onChange,h=e.onBlur,d=e.onFocus,m=r.enumOptions,p=r.enumDisabled,y=function(k,w){return bl(k),u(i.type=="boolean"?w!=="false":w)},b=function(k){var w=k.target.value;return h(t,w)},v=function(k){var w=k.target.value;return d(t,w)},C=r?r.inline:!1;return f.createElement(f.Fragment,null,f.createElement(yl.Z,{required:o,htmlFor:t},c||i.title),f.createElement(mv.Z,{value:""+s,row:C,onChange:y,onBlur:b,onFocus:v},m.map(function(x,k){var w=p&&p.indexOf(x.value)!=-1,O=f.createElement(gl.Z,{control:f.createElement(dv.Z,{color:"primary",key:k}),label:""+x.label,value:""+x.value,key:k,disabled:l||w||a});return O})))},Kv=hl,Gv=function(e){var t=e.value,i=e.readonly,r=e.disabled,s=e.onBlur,o=e.onFocus,l=e.options,a=e.schema,c=e.onChange,u=e.required,h=e.label,d=e.id,m=Qi({value:t,label:h,id:d},Kv(a)),p=function(C,x){return bl(C),c(x===""?l.emptyValue:x)},y=function(C){var x=C.target.value;return s(d,x)},b=function(C){var x=C.target.value;return o(d,x)};return f.createElement(f.Fragment,null,f.createElement(yl.Z,{required:u,id:d},h),f.createElement(pv.Z,Object.assign({disabled:r||i,onChange:p,onBlur:y,onFocus:b,valueLabelDisplay:"auto"},m)))},xl=mi,Hu=pi,Jv=new Set(["number","integer"]),Sl=function(e,t){var i=e.type,r=e.items;if(t!==""){{if(i==="array"&&r&&Jv.has(r.type))return t.map(xl);if(i==="boolean")return t==="true";if(i==="number")return xl(t)}if(e.enum){if(e.enum.every(function(s){return Hu(s)==="number"}))return xl(t);if(e.enum.every(function(s){return Hu(s)==="boolean"}))return t==="true"}return t}},Yv=function(e){var t=e.schema,i=e.id,r=e.options,s=e.label,o=e.required,l=e.disabled,a=e.readonly,c=e.value,u=e.multiple,h=e.autofocus,d=e.onChange,m=e.onBlur,p=e.onFocus,y=e.rawErrors,b=y===void 0?[]:y,v=r.enumOptions,C=r.enumDisabled,x=u?[]:"",k=function(P){var B=P.target.value;return d(Sl(t,B))},w=function(P){var B=P.target.value;return m(i,Sl(t,B))},O=function(P){var B=P.target.value;return p(i,Sl(t,B))};return f.createElement(vl.Z,{id:i,label:s||t.title,select:!0,value:typeof c=="undefined"?x:c,required:o,disabled:l||a,autoFocus:h,error:b.length>0,onChange:k,onBlur:w,onFocus:O,InputLabelProps:{shrink:!0},SelectProps:{multiple:typeof u=="undefined"?!1:u}},v.map(function(F,P){var B=F.value,N=F.label,G=C&&C.indexOf(B)!=-1;return f.createElement(ct.Z,{key:P,value:B,disabled:G},N)}))},Xv=function(e){var t=e.id,i=e.placeholder,r=e.value,s=e.required,o=e.disabled,l=e.autofocus,a=e.label,c=e.readonly,u=e.onBlur,h=e.onFocus,d=e.onChange,m=e.options,p=e.schema,y=e.rawErrors,b=y===void 0?[]:y,v=function(w){var O=w.target.value;return d(O===""?m.emptyValue:O)},C=function(w){var O=w.target.value;return u(t,O)},x=function(w){var O=w.target.value;return h(t,O)};return f.createElement(vl.Z,{id:t,label:a||p.title,placeholder:i,disabled:o||c,value:r,required:s,autoFocus:l,multiline:!0,rows:m.rows||5,error:b.length>0,onChange:v,onBlur:C,onFocus:x})},_v=bu,Qv=function(e){var t=e.id,i=e.placeholder,r=e.required,s=e.readonly,o=e.disabled,l=e.type,a=e.label,c=e.value,u=e.onChange,h=e.onBlur,d=e.onFocus,m=e.autofocus,p=e.options,y=e.schema,b=e.uiSchema,v=e.rawErrors,C=v===void 0?[]:v,x=ju(e,["id","placeholder","required","readonly","disabled","type","label","value","onChange","onBlur","onFocus","autofocus","options","schema","uiSchema","rawErrors","formContext","registry"]),k=function(N){var G=N.target.value;return u(G===""?p.emptyValue:G)},w=function(N){var G=N.target.value;return h(t,G)},O=function(N){var G=N.target.value;return d(t,G)},F=_v(y,b),P=(l||y.type)==="string"?"text":""+(l||y.type);return f.createElement(vl.Z,Object.assign({id:t,placeholder:i,label:F?a||y.title:!1,autoFocus:m,required:r,disabled:o||s,type:P,value:c||c===0?c:"",error:C.length>0,onChange:k,onBlur:w,onFocus:O},x))},eb=function(e){var t=e.id,i=e.required,r=e.readonly,s=e.disabled,o=e.label,l=e.value,a=e.onChange,c=e.onBlur,u=e.onFocus,h=e.autofocus,d=function(b){var v=b.target.value;return a(v)},m=function(b){var v=b.target.value;return c(t,v)},p=function(b){var v=b.target.value;return u(t,v)};return f.createElement(Ot.Z,{fullWidth:!0,required:i},f.createElement(Pe.Z,null,o),f.createElement(Nu.Z,{id:t,autoFocus:h,required:i,type:"number",disabled:s||r,value:l||l===0?l:"",onChange:d,onBlur:m,onFocus:p}))},tb=function(e){var t=e.registry,i=t.widgets.TextWidget;return f.createElement(i,Object.assign({type:"url"},e))},nb={CheckboxWidget:Iv,CheckboxesWidget:Wv,ColorWidget:jv,DateWidget:Vv,DateTimeWidget:Uv,EmailWidget:zv,PasswordWidget:Zv,RadioWidget:qv,RangeWidget:Gv,SelectWidget:Yv,TextareaWidget:Xv,TextWidget:Qv,UpDownWidget:eb,URLWidget:tb},ib=ht,Uu=ib(),rb=Uu.fields,sb=Uu.widgets,ob=function(){return f.createElement(me.Z,{marginTop:3},f.createElement(st.Z,{type:"submit",variant:"contained",color:"primary"},"Submit"))},lb={children:f.createElement(ob,null),ArrayFieldTemplate:bv,fields:Qi({},rb,Ev),FieldTemplate:Tv,ObjectFieldTemplate:Bv,widgets:Qi({},sb,nb),ErrorList:Cv},CO=null,kO=null,ab=g(9850),cb=g.n(ab),ub=g(72779),hb=g.n(ub),fb=g(48760),db=["true","false","on","off","yes","no"],mb=new RegExp("\\b(("+db.join(")|(")+"))$","i");const pb={token:function(n,e){var t=n.peek(),i=e.escaped;if(e.escaped=!1,t=="#"&&(n.pos==0||/\s/.test(n.string.charAt(n.pos-1))))return n.skipToEnd(),"comment";if(n.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(e.literal&&n.indentation()>e.keyCol)return n.skipToEnd(),"string";if(e.literal&&(e.literal=!1),n.sol()){if(e.keyCol=0,e.pair=!1,e.pairStart=!1,n.match("---")||n.match("..."))return"def";if(n.match(/^\s*-\s+/))return"meta"}if(n.match(/^(\{|\}|\[|\])/))return t=="{"?e.inlinePairs++:t=="}"?e.inlinePairs--:t=="["?e.inlineList++:e.inlineList--,"meta";if(e.inlineList>0&&!i&&t==",")return n.next(),"meta";if(e.inlinePairs>0&&!i&&t==",")return e.keyCol=0,e.pair=!1,e.pairStart=!1,n.next(),"meta";if(e.pairStart){if(n.match(/^\s*(\||\>)\s*/))return e.literal=!0,"meta";if(n.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(e.inlinePairs==0&&n.match(/^\s*-?[0-9\.\,]+\s?$/)||e.inlinePairs>0&&n.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(n.match(mb))return"keyword"}return!e.pair&&n.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(e.pair=!0,e.keyCol=n.indentation(),"atom"):e.pair&&n.match(/^:\s*/)?(e.pairStart=!0,"meta"):(e.pairStart=!1,e.escaped=t=="\\",n.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}};let gi="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<gi.length;n++)gi[n]+=gi[n-1];function gb(n){for(let e=1;e<gi.length;e+=2)if(gi[e]>n)return gi[e-1]<=n;return!1}function zu(n){return n>=127462&&n<=127487}const Zu=8205;function Et(n,e,t=!0,i=!0){return(t?qu:yb)(n,e,i)}function qu(n,e,t){if(e==n.length)return e;e&&Ku(n.charCodeAt(e))&&Gu(n.charCodeAt(e-1))&&e--;let i=ot(n,e);for(e+=It(i);e<n.length;){let r=ot(n,e);if(i==Zu||r==Zu||t&&gb(r))e+=It(r),i=r;else if(zu(r)){let s=0,o=e-2;for(;o>=0&&zu(ot(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function yb(n,e,t){for(;e>0;){let i=qu(n,e-2,t);if(i<e)return i;e--}return 0}function Ku(n){return n>=56320&&n<57344}function Gu(n){return n>=55296&&n<56320}function ot(n,e){let t=n.charCodeAt(e);if(!Gu(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return Ku(i)?(t-55296<<10)+(i-56320)+65536:t}function Cl(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function It(n){return n<65536?1:2}function er(n,e,t=n.length){let i=0;for(let r=0;r<t;)n.charCodeAt(r)==9?(i+=e-i%e,r++):(i++,r=Et(n,r));return i}function kl(n,e,t,i){for(let r=0,s=0;;){if(s>=e)return r;if(r==n.length)break;s+=n.charCodeAt(r)==9?t-s%t:1,r=Et(n,r)}return i===!0?-1:n.length}class Ee{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){let r=[];return this.decompose(0,e,r,2),i.length&&i.decompose(0,i.length,r,3),this.decompose(t,this.length,r,1),Kt.from(r,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let i=[];return this.decompose(e,t,i,0),Kt.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),r=new tr(this),s=new tr(e);for(let o=t,l=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(l+=r.value.length,r.done||l>=i)return!0}}iter(e=1){return new tr(this,e)}iterRange(e,t=this.length){return new Yu(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;i=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Xu(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Ee.empty:e.length<=32?new He(e):Kt.from(He.split(e,[]))}}class He extends Ee{constructor(e,t=vb(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.text[s],l=r+o.length;if((t?i:l)>=e)return new bb(r,l,i,o);r=l+1,i++}}decompose(e,t,i,r){let s=e<=0&&t>=this.length?this:new He(Ju(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=i.pop(),l=ns(s.text,o.text.slice(),0,s.length);if(l.length<=32)i.push(new He(l,o.length+s.length));else{let a=l.length>>1;i.push(new He(l.slice(0,a)),new He(l.slice(a)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof He))return super.replace(e,t,i);let r=ns(this.text,ns(i.text,Ju(this.text,0,e)),t),s=this.length+i.length-(t-e);return r.length<=32?new He(r,s):Kt.from(He.split(r,[]),s)}sliceString(e,t=this.length,i=`
`){let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(r+=i),e<a&&t>s&&(r+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],r=-1;for(let s of e)i.push(s),r+=s.length+1,i.length==32&&(t.push(new He(i,r)),i=[],r=-1);return r>-1&&t.push(new He(i,r)),t}}class Kt extends Ee{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,r){for(let s=0;;s++){let o=this.children[s],l=r+o.length,a=i+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,i,r);r=l+1,i=a+1}}decompose(e,t,i,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let c=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!c?i.push(l):l.decompose(e-o,t-o,i,c)}o=a+1}}replace(e,t,i){if(i.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,i),c=this.lines-o.lines+a.lines;if(a.lines<c>>5-1&&a.lines>c>>5+1){let u=this.children.slice();return u[r]=a,new Kt(u,this.length-(t-e)+i.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(r+=i),e<a&&t>o&&(r+=l.sliceString(e-o,t-o,i)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Kt))return 0;let i=0,[r,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==l)return i;let a=this.children[r],c=e.children[s];if(a!=c)return i+a.scanIdentical(c,t);i+=a.length+1}}static from(e,t=e.reduce((i,r)=>i+r.length+1,-1)){let i=0;for(let m of e)i+=m.lines;if(i<32){let m=[];for(let p of e)p.flatten(m);return new He(m,t)}let r=Math.max(32,i>>5),s=r<<1,o=r>>1,l=[],a=0,c=-1,u=[];function h(m){let p;if(m.lines>s&&m instanceof Kt)for(let y of m.children)h(y);else m.lines>o&&(a>o||!a)?(d(),l.push(m)):m instanceof He&&a&&(p=u[u.length-1])instanceof He&&m.lines+p.lines<=32?(a+=m.lines,c+=m.length+1,u[u.length-1]=new He(p.text.concat(m.text),p.length+1+m.length)):(a+m.lines>r&&d(),a+=m.lines,c+=m.length+1,u.push(m))}function d(){a!=0&&(l.push(u.length==1?u[0]:Kt.from(u,c)),c=-1,a=u.length=0)}for(let m of e)h(m);return d(),l.length==1?l[0]:new Kt(l,t)}}Ee.empty=new He([""],0);function vb(n){let e=-1;for(let t of n)e+=t.length+1;return e}function ns(n,e,t=0,i=1e9){for(let r=0,s=0,o=!0;s<n.length&&r<=i;s++){let l=n[s],a=r+l.length;a>=t&&(a>i&&(l=l.slice(0,i-r)),r<t&&(l=l.slice(t-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function Ju(n,e,t){return ns(n,[""],e,t)}class tr{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof He?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,r=this.nodes[i],s=this.offsets[i],o=s>>1,l=r instanceof He?r.text.length:r.children.length;if(o==(t>0?l:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof He){let a=r.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof He?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Yu{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new tr(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=i?r:t<0?r.slice(r.length-i):r.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Xu{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:r}=this.inner.next(e);return t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(Ee.prototype[Symbol.iterator]=function(){return this.iter()},tr.prototype[Symbol.iterator]=Yu.prototype[Symbol.iterator]=Xu.prototype[Symbol.iterator]=function(){return this});class bb{constructor(e,t,i,r){this.from=e,this.to=t,this.number=i,this.text=r}get length(){return this.to-this.from}}const Ol=/\r\n?|\n/;var ft=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(ft||(ft={}));class hn{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(i,r,s),r+=s):r+=o,i+=s}}iterChangedRanges(e,t=!1){Al(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];r<0?e.push(i,r):e.push(r,i)}return new hn(e)}composeDesc(e){return this.empty?e:e.empty?this:_u(this,e)}mapDesc(e,t=!1){return e.empty?this:El(this,e,t)}mapPos(e,t=-1,i=ft.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],c=r+l;if(a<0){if(c>e)return s+(e-r);s+=l}else{if(i!=ft.Simple&&c>=e&&(i==ft.TrackDel&&r<e&&c>e||i==ft.TrackBefore&&r<e||i==ft.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!l)return e==r||t<0?s:s+a;s+=a}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let i=0,r=0;i<this.sections.length&&r<=t;){let s=this.sections[i++],o=this.sections[i++],l=r+s;if(o>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+i+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new hn(e)}}class Je extends hn{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Al(this,(t,i,r,s,o)=>e=e.replace(r,r+(i-t),o),!1),e}mapDesc(e,t=!1){return El(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=o;let a=r>>1;for(;i.length<a;)i.push(Ee.empty);i.push(o?e.slice(s,s+o):Ee.empty)}s+=o}return new Je(t,i)}compose(e){return this.empty?e:e.empty?this:_u(this,e,!0)}map(e,t=!1){return e.empty?this:El(this,e,t,!0)}iterChanges(e,t=!1){Al(this,e,t)}get desc(){return new hn(this.sections)}filter(e){let t=[],i=[],r=[],s=new nr(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let u=Math.min(s.len,a-l);dt(r,u,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;dt(t,u,h),h>0&&Gn(i,t,s.text),s.forward(u),l+=u}let c=e[o++];for(;l<c;){if(s.done)break e;let u=Math.min(s.len,c-l);dt(t,u,-1),dt(r,u,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(u),l+=u}}return{changes:new Je(t,i),filtered:new hn(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],r=this.sections[t+1];r<0?e.push(i):r==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let r=[],s=[],o=0,l=null;function a(u=!1){if(!u&&!r.length)return;o<t&&dt(r,t-o,-1);let h=new Je(r,s);l=l?l.compose(h.map(l)):h,r=[],s=[],o=0}function c(u){if(Array.isArray(u))for(let h of u)c(h);else if(u instanceof Je){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);a(),l=l?l.compose(u.map(l)):u}else{let{from:h,to:d=h,insert:m}=u;if(h>d||h<0||d>t)throw new RangeError(`Invalid change range ${h} to ${d} (in doc of length ${t})`);let p=m?typeof m=="string"?Ee.of(m.split(i||Ol)):m:Ee.empty,y=p.length;if(h==d&&y==0)return;h<o&&a(),h>o&&dt(r,h-o,-1),dt(r,d-h,y),Gn(s,r,p),o=d}}return c(e),a(!l),l}static empty(e){return new Je(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;i.length<r;)i.push(Ee.empty);i[r]=Ee.of(s.slice(1)),t.push(s[0],i[r].length)}}}return new Je(t,i)}}function dt(n,e,t,i=!1){if(e==0&&t<=0)return;let r=n.length-2;r>=0&&t<=0&&t==n[r+1]?n[r]+=e:e==0&&n[r]==0?n[r+1]+=t:i?(n[r]+=e,n[r+1]+=t):n.push(e,t)}function Gn(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(Ee.empty);n.push(t)}}function Al(n,e,t){let i=n.inserted;for(let r=0,s=0,o=0;o<n.sections.length;){let l=n.sections[o++],a=n.sections[o++];if(a<0)r+=l,s+=l;else{let c=r,u=s,h=Ee.empty;for(;c+=l,u+=a,a&&i&&(h=h.append(i[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],a=n.sections[o++];e(r,c,s,u,h),r=c,s=u}}}function El(n,e,t,i=!1){let r=[],s=i?[]:null,o=new nr(n),l=new nr(e);for(let a=0,c=0;;)if(o.ins==-1)a+=o.len,o.next();else if(l.ins==-1&&c<a){let u=Math.min(l.len,a-c);l.forward(u),dt(r,u,-1),c+=u}else if(l.ins>=0&&(o.done||c<a||c==a&&(l.len<o.len||l.len==o.len&&!t))){for(dt(r,l.ins,-1);a>c&&!o.done&&a+o.len<c+l.len;)a+=o.len,o.next();c+=l.len,l.next()}else if(o.ins>=0){let u=0,h=a+o.len;for(;;)if(l.ins>=0&&c>a&&c+l.len<h)u+=l.ins,c+=l.len,l.next();else if(l.ins==-1&&c<h){let d=Math.min(l.len,h-c);u+=d,l.forward(d),c+=d}else break;dt(r,u,o.ins),s&&Gn(s,r,o.text),a=h,o.next()}else{if(o.done&&l.done)return s?new Je(r,s):new hn(r);throw new Error("Mismatched change set lengths")}}function _u(n,e,t=!1){let i=[],r=t?[]:null,s=new nr(n),o=new nr(e);for(let l=!1;;){if(s.done&&o.done)return r?new Je(i,r):new hn(i);if(s.ins==0)dt(i,s.len,0,l),s.next();else if(o.len==0&&!o.done)dt(i,0,o.ins,l),r&&Gn(r,i,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),c=i.length;if(s.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;dt(i,a,u,l),r&&u&&Gn(r,i,o.text)}else o.ins==-1?(dt(i,s.off?0:s.len,a,l),r&&Gn(r,i,s.textBit(a))):(dt(i,s.off?0:s.len,o.off?0:o.ins,l),r&&!o.off&&Gn(r,i,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||i.length>c),s.forward2(a),o.forward(a)}}}}class nr{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Ee.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?Ee.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class yi{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let i,r;return this.empty?i=r=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),i==this.from&&r==this.to?this:new yi(i,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return T.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return T.range(this.anchor,i)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return T.range(e.anchor,e.head)}}class T{constructor(e,t=0){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:T.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new T([this.main])}addRange(e,t=!0){return T.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,T.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new T(e.ranges.map(t=>yi.fromJSON(t)),e.main)}static single(e,t=e){return new T([T.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=i:s.from<i)return wb(e.slice(),t);i=s.to}return new T(e,t)}static cursor(e,t=0,i,r){return new yi(e,e,(t==0?0:t<0?4:8)|(i==null?3:Math.min(2,i))|(r!=null?r:33554431)<<5)}static range(e,t,i){let r=(i!=null?i:33554431)<<5;return t<e?new yi(t,e,16|r|8):new yi(e,t,r|(t>e?4:0))}}function wb(n,e=0){let t=n[e];n.sort((i,r)=>i.from-r.from),e=n.indexOf(t);for(let i=1;i<n.length;i++){let r=n[i],s=n[i-1];if(r.empty?r.from<=s.to:r.from<s.to){let o=s.from,l=Math.max(r.to,s.to);i<=e&&e--,n.splice(--i,2,r.anchor>r.head?T.range(l,o):T.range(o,l))}}return new T(n,e)}function Qu(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Pl=0;class ne{constructor(e,t,i,r,s){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=r,this.extensions=s,this.id=Pl++,this.default=e([])}static define(e={}){return new ne(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:Dl),!!e.static,e.enables)}of(e){return new is([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new is(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new is(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function Dl(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class is{constructor(e,t,i,r){this.dependencies=e,this.facet=t,this.type=i,this.value=r,this.id=Pl++}dynamicSlot(e){var t;let i=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,c=!1,u=[];for(let h of this.dependencies)h=="doc"?a=!0:h=="selection"?c=!0:(((t=e[h.id])!==null&&t!==void 0?t:1)&1)==0&&u.push(e[h.id]);return{create(h){return h.values[o]=i(h),1},update(h,d){if(a&&d.docChanged||c&&(d.docChanged||d.selection)||u.some(m=>(Jn(h,m)&1)>0)){let m=i(h);if(l?!eh(m,h.values[o],r):!r(m,h.values[o]))return h.values[o]=m,1}return 0},reconfigure(h,d){let m=i(h),p=d.config.address[s];if(p!=null){let y=os(d,p);if(l?eh(m,y,r):r(m,y))return h.values[o]=y,0}return h.values[o]=m,1}}}}function eh(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function xb(n,e,t){let i=t.map(a=>n[a.id]),r=t.map(a=>a.type),s=i.filter(a=>!(a&1)),o=n[e.id]>>1;function l(a){let c=[];for(let u=0;u<i.length;u++){let h=os(a,i[u]);if(r[u]==2)for(let d of h)c.push(d);else c.push(h)}return e.combine(c)}return{create(a){for(let c of i)Jn(a,c);return a.values[o]=l(a),1},update(a,c){if(!s.some(h=>Jn(a,h)&1))return 0;let u=l(a);return e.compare(u,a.values[o])?0:(a.values[o]=u,1)},reconfigure(a,c){let u=i.some(p=>Jn(a,p)&1),h=c.config.facets[e.id],d=c.facet(e);if(h&&!u&&Dl(t,h))return a.values[o]=d,0;let m=l(a);return e.compare(m,d)?(a.values[o]=d,0):(a.values[o]=m,1)}}}const th=ne.define({static:!0});class qe{constructor(e,t,i,r,s){this.id=e,this.createF=t,this.updateF=i,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new qe(Pl++,e.create,e.update,e.compare||((i,r)=>i===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(th).find(i=>i.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,r)=>{let s=i.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(i.values[t]=o,1)},reconfigure:(i,r)=>r.config.address[this.id]!=null?(i.values[t]=r.field(this),0):(i.values[t]=this.create(i),1)}}init(e){return[this,th.of({field:this,create:e})]}get extension(){return this}}const fn={lowest:4,low:3,default:2,high:1,highest:0};function En(n){return e=>new nh(e,n)}const vi={lowest:En(fn.lowest),low:En(fn.low),default:En(fn.default),high:En(fn.high),highest:En(fn.highest),fallback:En(fn.lowest),extend:En(fn.high),override:En(fn.highest)};class nh{constructor(e,t){this.inner=e,this.prec=t}}class rs{of(e){return new Tl(this,e)}reconfigure(e){return rs.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Tl{constructor(e,t){this.compartment=e,this.inner=t}}class ss{constructor(e,t,i,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let r=[],s=Object.create(null),o=new Map;for(let d of Sb(e,t,o))d instanceof qe?r.push(d):(s[d.facet.id]||(s[d.facet.id]=[])).push(d);let l=Object.create(null),a=[],c=[];for(let d of r)l[d.id]=c.length<<1,c.push(m=>d.slot(m));let u=i==null?void 0:i.config.facets;for(let d in s){let m=s[d],p=m[0].facet,y=u&&u[d]||[];if(m.every(b=>b.type==0))if(l[p.id]=a.length<<1|1,Dl(y,m))a.push(i.facet(p));else{let b=p.combine(m.map(v=>v.value));a.push(i&&p.compare(b,i.facet(p))?i.facet(p):b)}else{for(let b of m)b.type==0?(l[b.id]=a.length<<1|1,a.push(b.value)):(l[b.id]=c.length<<1,c.push(v=>b.dynamicSlot(v)));l[p.id]=c.length<<1,c.push(b=>xb(b,p,m))}}let h=c.map(d=>d(l));return new ss(e,o,h,l,a,s)}}function Sb(n,e,t){let i=[[],[],[],[],[]],r=new Map;function s(o,l){let a=r.get(o);if(a!=null){if(a>=l)return;let c=i[a].indexOf(o);c>-1&&i[a].splice(c,1),o instanceof Tl&&t.delete(o.compartment)}if(r.set(o,l),Array.isArray(o))for(let c of o)s(c,l);else if(o instanceof Tl){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;t.set(o.compartment,c),s(c,l)}else if(o instanceof nh)s(o.inner,o.prec);else if(o instanceof qe)i[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof is)i[l].push(o),o.facet.extensions&&s(o.facet.extensions,l);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,l)}}return s(n,fn.default),i.reduce((o,l)=>o.concat(l))}function Jn(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let r=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|r}function os(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const ih=ne.define(),rh=ne.define({combine:n=>n.some(e=>e),static:!0}),sh=ne.define({combine:n=>n.length?n[0]:void 0,static:!0}),oh=ne.define(),lh=ne.define(),ah=ne.define(),ch=ne.define({combine:n=>n.length?n[0]:!1});class Pn{constructor(e,t){this.type=e,this.value=t}static define(){return new Cb}}class Cb{of(e){return new Pn(this,e)}}class kb{constructor(e){this.map=e}of(e){return new ue(this,e)}}class ue{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new ue(this.type,t)}is(e){return this.type==e}static define(e={}){return new kb(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let r of e){let s=r.map(t);s&&i.push(s)}return i}}ue.reconfigure=ue.define(),ue.appendConfig=ue.define();class Ye{constructor(e,t,i,r,s,o){this.startState=e,this.changes=t,this.selection=i,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Qu(i,t.newLength),s.some(l=>l.type==Ye.time)||(this.annotations=s.concat(Ye.time.of(Date.now())))}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Ye.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Ye.time=Pn.define(),Ye.userEvent=Pn.define(),Ye.addToHistory=Pn.define(),Ye.remote=Pn.define();function Ob(n,e){let t=[];for(let i=0,r=0;;){let s,o;if(i<n.length&&(r==e.length||e[r]>=n[i]))s=n[i++],o=n[i++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function uh(n,e,t){var i;let r,s,o;return t?(r=e.changes,s=Je.empty(e.changes.length),o=n.changes.compose(e.changes)):(r=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(i=n.selection)===null||i===void 0?void 0:i.map(r),effects:ue.mapEffects(n.effects,r).concat(ue.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Ml(n,e,t){let i=e.selection,r=bi(e.annotations);return e.userEvent&&(r=r.concat(Ye.userEvent.of(e.userEvent))),{changes:e.changes instanceof Je?e.changes:Je.of(e.changes||[],t,n.facet(sh)),selection:i&&(i instanceof T?i:T.single(i.anchor,i.head)),effects:bi(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function hh(n,e,t){let i=Ml(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;i=uh(i,Ml(n,e[s],o?i.changes.newLength:n.doc.length),o)}let r=new Ye(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return Eb(t?Ab(r):r)}function Ab(n){let e=n.startState,t=!0;for(let r of e.facet(oh)){let s=r(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:Ob(t,s))}if(t!==!0){let r,s;if(t===!1)s=n.changes.invertedDesc,r=Je.empty(e.doc.length);else{let o=n.changes.filter(t);r=o.changes,s=o.filtered.invertedDesc}n=new Ye(e,r,n.selection&&n.selection.map(s),ue.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let i=e.facet(lh);for(let r=i.length-1;r>=0;r--){let s=i[r](n);s instanceof Ye?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Ye?n=s[0]:n=hh(e,bi(s),!1)}return n}function Eb(n){let e=n.startState,t=e.facet(ah),i=n;for(let r=t.length-1;r>=0;r--){let s=t[r](n);s&&Object.keys(s).length&&(i=uh(n,Ml(e,s,n.changes.newLength),!0))}return i==n?n:new Ye(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const Pb=[];function bi(n){return n==null?Pb:Array.isArray(n)?n:[n]}var mt=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(mt||(mt={}));const Db=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Fl;try{Fl=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Tb(n){if(Fl)return Fl.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||Db.test(t)))return!0}return!1}function Mb(n){return e=>{if(!/\S/.test(e))return mt.Space;if(Tb(e))return mt.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return mt.Word;return mt.Other}}class we{constructor(e,t,i,r,s,o){this.config=e,this.doc=t,this.selection=i,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)Jn(this,l<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return Jn(this,i),os(this,i)}update(...e){return hh(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:r}=t;for(let o of e.effects)o.is(rs.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,a)=>r.set(a,l)),t=null),r.set(o.value.compartment,o.value.extension)):o.is(ue.reconfigure)?(t=null,i=o.value):o.is(ue.appendConfig)&&(t=null,i=bi(i).concat(o.value));let s;t?s=e.startState.values.slice():(t=ss.resolve(i,r,this),s=new we(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,a)=>a.reconfigure(l,this),null).values),new we(t,e.newDoc,e.newSelection,s,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:T.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),r=this.changes(i.changes),s=[i.range],o=bi(i.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),c=this.changes(a.changes),u=c.map(r);for(let d=0;d<l;d++)s[d]=s[d].map(u);let h=r.mapDesc(c,!0);s.push(a.range.map(h)),r=r.compose(u),o=ue.mapEffects(o,u).concat(ue.mapEffects(bi(a.effects),h))}return{changes:r,selection:T.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Je?e:Je.of(e,this.doc.length,this.facet(we.lineSeparator))}toText(e){return Ee.of(e.split(this.facet(we.lineSeparator)||Ol))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Jn(this,t),os(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let r=e[i];r instanceof qe&&(t[i]=r.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(i)for(let s in i){let o=i[s],l=e[s];r.push(o.init(a=>o.spec.fromJSON(l,a)))}return we.create({doc:e.doc,selection:T.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=ss.resolve(e.extensions||[],new Map),i=e.doc instanceof Ee?e.doc:Ee.of((e.doc||"").split(t.staticFacet(we.lineSeparator)||Ol)),r=e.selection?e.selection instanceof T?e.selection:T.single(e.selection.anchor,e.selection.head):T.single(0);return Qu(r,i.length),t.staticFacet(rh)||(r=r.asSingle()),new we(t,i,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(we.tabSize)}get lineBreak(){return this.facet(we.lineSeparator)||`
`}get readOnly(){return this.facet(ch)}phrase(e){for(let t of this.facet(we.phrases))if(Object.prototype.hasOwnProperty.call(t,e))return t[e];return e}languageDataAt(e,t,i=-1){let r=[];for(let s of this.facet(ih))for(let o of s(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return Mb(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-i,l=e-i;for(;o>0;){let a=Et(t,o,!1);if(s(t.slice(a,o))!=mt.Word)break;o=a}for(;l<r;){let a=Et(t,l);if(s(t.slice(l,a))!=mt.Word)break;l=a}return o==l?null:T.range(o+i,l+i)}}we.allowMultipleSelections=rh,we.tabSize=ne.define({combine:n=>n.length?n[0]:4}),we.lineSeparator=sh,we.readOnly=ch,we.phrases=ne.define(),we.languageData=ih,we.changeFilter=oh,we.transactionFilter=lh,we.transactionExtender=ah,rs.reconfigure=ue.define();function dn(n,e,t={}){let i={};for(let r of n)for(let s of Object.keys(r)){let o=r[s],l=i[s];if(l===void 0)i[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))i[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)i[r]===void 0&&(i[r]=e[r]);return i}const Bl="\u037C",fh=typeof Symbol=="undefined"?"__"+Bl:Symbol.for(Bl),Rl=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),dh=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class Dn{constructor(e,t){this.rules=[];let{finish:i}=t||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,c){let u=[],h=/^@(\w+)\b/.exec(o[0]),d=h&&h[1]=="keyframes";if(h&&l==null)return a.push(o[0]+";");for(let m in l){let p=l[m];if(/&/.test(m))s(m.split(/,\s*/).map(y=>o.map(b=>y.replace(/&/,b))).reduce((y,b)=>y.concat(b)),p,a);else if(p&&typeof p=="object"){if(!h)throw new RangeError("The value of a property ("+m+") should be a primitive value.");s(r(m),p,u,d)}else p!=null&&u.push(m.replace(/_.*/,"").replace(/[A-Z]/g,y=>"-"+y.toLowerCase())+": "+p+";")}(u.length||d)&&a.push((i&&!h&&!c?o.map(i):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=dh[fh]||1;return dh[fh]=e+1,Bl+e.toString(36)}static mount(e,t){(e[Rl]||new Fb(e)).mount(Array.isArray(t)?t:[t])}}let ls=null;class Fb{constructor(e){if(!e.head&&e.adoptedStyleSheets&&typeof CSSStyleSheet!="undefined"){if(ls)return e.adoptedStyleSheets=[ls.sheet].concat(e.adoptedStyleSheets),e[Rl]=ls;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),ls=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[],e[Rl]=this}mount(e){let t=this.sheet,i=0,r=0;for(let s=0;s<e.length;s++){let o=e[s],l=this.modules.indexOf(o);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,o),t)for(let a=0;a<o.rules.length;a++)t.insertRule(o.rules[a],i++)}else{for(;r<l;)i+=this.modules[r++].rules.length;i+=o.rules.length,r++}}if(!t){let s="";for(let o=0;o<this.modules.length;o++)s+=this.modules[o].getRules()+`
`;this.styleTag.textContent=s}}}class Yn{eq(e){return this==e}range(e,t=e){return new Il(e,t,this)}}Yn.prototype.startSide=Yn.prototype.endSide=0,Yn.prototype.point=!1,Yn.prototype.mapMode=ft.TrackDel;class Il{constructor(e,t,i){this.from=e,this.to=t,this.value=i}}function Ll(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Nl{constructor(e,t,i,r){this.from=e,this.to=t,this.value=i,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,r=0){let s=i?this.to:this.from;for(let o=r,l=s.length;;){if(o==l)return o;let a=o+l>>1,c=s[a]-e||(i?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return c>=0?o:l;c>=0?l=a:o=a+1}}between(e,t,i,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let i=[],r=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],u=this.from[a]+e,h=this.to[a]+e,d,m;if(u==h){let p=t.mapPos(u,c.startSide,c.mapMode);if(p==null||(d=m=p,c.startSide!=c.endSide&&(m=t.mapPos(u,c.endSide),m<d)))continue}else if(d=t.mapPos(u,c.startSide),m=t.mapPos(h,c.endSide),d>m||d==m&&c.startSide>0&&c.endSide<=0)continue;(m-d||c.endSide-c.startSide)<0||(o<0&&(o=d),c.point&&(l=Math.max(l,m-d)),i.push(c),r.push(d-o),s.push(m-o))}return{mapped:i.length?new Nl(r,s,i,l):null,pos:o}}}class ke{constructor(e,t,i=ke.empty,r){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=r}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(Ll)),this.isEmpty)return t.length?ke.of(t):this;let l=new ph(this,null,-1).goto(0),a=0,c=[],u=new Tn;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let h=t[a++];u.addInner(h.from,h.to,h.value)||c.push(h)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&u.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||r>l.to||s<l.from||o(l.from,l.to,l.value))&&(u.addInner(l.from,l.to,l.value)||c.push(new Il(l.from,l.to,l.value))),l.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?ke.empty:this.nextLayer.update({add:c,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],r=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],c=e.touchesRange(l,l+a.length);if(c===!1)r=Math.max(r,a.maxPoint),t.push(a),i.push(e.mapPos(l));else if(c===!0){let{mapped:u,pos:h}=a.map(l,e);u&&(r=Math.max(r,u.maxPoint),t.push(u),i.push(h))}}let s=this.nextLayer.map(e);return t.length==0?s:new ke(i,t,s,r)}between(e,t,i){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return ir.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return ir.from(e).goto(t)}static compare(e,t,i,r,s=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),a=mh(o,l,i),c=new rr(o,a,s),u=new rr(l,a,s);i.iterGaps((h,d,m)=>gh(c,h,u,d,m,r)),i.empty&&i.length==0&&gh(c,0,u,0,0,r)}static eq(e,t,i=0,r){r==null&&(r=1e9);let s=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),o=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=mh(s,o),a=new rr(s,l,0).goto(i),c=new rr(o,l,0).goto(i);for(;;){if(a.to!=c.to||!jl(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>r)return!0;a.next(),c.next()}}static spans(e,t,i,r,s=-1){var o;let l=new rr(e,null,s,(o=r.filterPoint)===null||o===void 0?void 0:o.bind(r)).goto(t),a=t,c=l.openStart;for(;;){let u=Math.min(l.to,i);if(l.point?(r.point(a,u,l.point,l.activeForPoint(l.to),c),c=l.openEnd(u)+(l.to>u?1:0)):u>a&&(r.span(a,u,l.active,c),c=l.openEnd(u)),l.to>i)break;a=l.to,l.next()}return c}static of(e,t=!1){let i=new Tn;for(let r of e instanceof Il?[e]:t?Bb(e):e)i.add(r.from,r.to,r.value);return i.finish()}}ke.empty=new ke([],[],null,-1);function Bb(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(Ll(e,i)>0)return n.slice().sort(Ll);e=i}return n}ke.empty.nextLayer=ke.empty;class Tn{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Nl(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new Tn)).add(e,t,i)}addInner(e,t,i){let r=e-this.lastTo||i.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(ke.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=new ke(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function mh(n,e,t){let i=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&i.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=i.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class ph{constructor(e,t,i,r=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class ir{constructor(e){this.heap=e}static from(e,t=null,i=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&r.push(new ph(o,t,i,s));return r.length==1?r[0]:new ir(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)Wl(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)Wl(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Wl(this.heap,0)}}}function Wl(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let r=n[i];if(i+1<n.length&&r.compare(n[i+1])>=0&&(r=n[i+1],i++),t.compare(r)<0)break;n[i]=t,n[e]=r,e=i}}class rr{constructor(e,t,i,r=()=>!0){this.minPoint=i,this.filterPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=ir.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){as(this.active,e),as(this.activeTo,e),as(this.activeRank,e),this.minActive=yh(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=s;)t++;cs(this.active,t,i),cs(this.activeTo,t,r),cs(this.activeRank,t,s),e&&cs(e,t,this.cursor.from),this.minActive=yh(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null,r=0;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&as(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else if(!this.filterPoint(this.cursor.from,this.cursor.to,this.cursor.value,this.cursor.rank))this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.from<e&&(r=1),this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){let s=0;for(;s<i.length&&i[s]<e;)s++;this.openStart=s+r}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function gh(n,e,t,i,r,s){n.goto(e),t.goto(i);let o=i+r,l=i,a=i-e;for(;;){let c=n.to+a-t.to||n.endSide-t.endSide,u=c<0?n.to+a:t.to,h=Math.min(u,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&jl(n.activeForPoint(n.to+a),t.activeForPoint(t.to))||s.comparePoint(l,h,n.point,t.point):h>l&&!jl(n.active,t.active)&&s.compareRange(l,h,n.active,t.active),u>o)break;l=u,c<=0&&n.next(),c>=0&&t.next()}}function jl(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function as(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function cs(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function yh(n,e){let t=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||n[r].endSide-n[t].endSide)<0&&(t=r,i=e[r]);return t}for(var Mn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},us={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},vh=typeof navigator!="undefined"&&/Chrome\/(\d+)/.exec(navigator.userAgent),Rb=typeof navigator!="undefined"&&/Apple Computer/.test(navigator.vendor),Ib=typeof navigator!="undefined"&&/Gecko\/\d+/.test(navigator.userAgent),bh=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),Lb=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Nb=vh&&(bh||+vh[1]<57)||Ib&&bh,nt=0;nt<10;nt++)Mn[48+nt]=Mn[96+nt]=String(nt);for(var nt=1;nt<=24;nt++)Mn[nt+111]="F"+nt;for(var nt=65;nt<=90;nt++)Mn[nt]=String.fromCharCode(nt+32),us[nt]=String.fromCharCode(nt);for(var Vl in Mn)us.hasOwnProperty(Vl)||(us[Vl]=Mn[Vl]);function Wb(n){var e=Nb&&(n.ctrlKey||n.altKey||n.metaKey)||(Rb||Lb)&&n.shiftKey&&n.key&&n.key.length==1,t=!e&&n.key||(n.shiftKey?us:Mn)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function hs(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function wi(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function jb(){let n=document.activeElement;for(;n&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function $l(n,e){if(!e.anchorNode)return!1;try{return wi(n,e.anchorNode)}catch{return!1}}function sr(n){return n.nodeType==3?or(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function fs(n,e,t,i){return t?wh(n,e,t,i,-1)||wh(n,e,t,i,1):!1}function Hl(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function wh(n,e,t,i,r){for(;;){if(n==t&&e==i)return!0;if(e==(r<0?0:ds(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=Hl(n)+(r<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=r<0?ds(n):0}else return!1}}function ds(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const xh={left:0,right:0,top:0,bottom:0};function ms(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Vb(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function $b(n,e,t,i,r,s,o,l){let a=n.ownerDocument,c=a.defaultView;for(let u=n;u;)if(u.nodeType==1){let h,d=u==a.body;if(d)h=Vb(c);else{if(u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.parentNode;continue}let y=u.getBoundingClientRect();h={left:y.left,right:y.left+u.clientWidth,top:y.top,bottom:y.top+u.clientHeight}}let m=0,p=0;if(r=="nearest")e.top<h.top?(p=-(h.top-e.top+o),t>0&&e.bottom>h.bottom+p&&(p=e.bottom-h.bottom+p+o)):e.bottom>h.bottom&&(p=e.bottom-h.bottom+o,t<0&&e.top-p<h.top&&(p=-(h.top+p-e.top+o)));else{let y=e.bottom-e.top,b=h.bottom-h.top;p=(r=="center"&&y<=b?e.top+y/2-b/2:r=="start"||r=="center"&&t<0?e.top-o:e.bottom-b+o)-h.top}if(i=="nearest"?e.left<h.left?(m=-(h.left-e.left+s),t>0&&e.right>h.right+m&&(m=e.right-h.right+m+s)):e.right>h.right&&(m=e.right-h.right+s,t<0&&e.left<h.left+m&&(m=-(h.left+m-e.left+s))):m=(i=="center"?e.left+(e.right-e.left)/2-(h.right-h.left)/2:i=="start"==l?e.left-s:e.right-(h.right-h.left)+s)-h.left,m||p)if(d)c.scrollBy(m,p);else{if(p){let y=u.scrollTop;u.scrollTop+=p,p=u.scrollTop-y}if(m){let y=u.scrollLeft;u.scrollLeft+=m,m=u.scrollLeft-y}e={left:e.left-m,top:e.top-p,right:e.right-m,bottom:e.bottom-p}}if(d)break;u=u.assignedSlot||u.parentNode,i=r="nearest"}else if(u.nodeType==11)u=u.host;else break}class Hb{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,i,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=r}}let xi=null;function Sh(n){if(n.setActive)return n.setActive();if(xi)return n.focus(xi);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(xi==null?{get preventScroll(){return xi={preventScroll:!0},!0}}:void 0),!xi){xi=!1;for(let t=0;t<e.length;){let i=e[t++],r=e[t++],s=e[t++];i.scrollTop!=r&&(i.scrollTop=r),i.scrollLeft!=s&&(i.scrollLeft=s)}}}let Ch;function or(n,e,t=e){let i=Ch||(Ch=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function lr(n,e,t){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0},r=new KeyboardEvent("keydown",i);r.synthetic=!0,n.dispatchEvent(r);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,n.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function Ub(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function kh(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}class it{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new it(e.parentNode,Hl(e),t)}static after(e,t){return new it(e.parentNode,Hl(e)+1,t)}}const Ul=[];class $e{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(this.dirty&2){let t=this.dom,i=null,r;for(let s of this.children){if(s.dirty){if(!s.dom&&(r=i?i.nextSibling:t.firstChild)){let o=$e.get(r);(!o||!o.parent&&o.constructor==s.constructor)&&s.reuseDOM(r)}s.sync(e),s.dirty=0}if(r=i?i.nextSibling:t.firstChild,e&&!e.written&&e.node==t&&r!=s.dom&&(e.written=!0),s.dom.parentNode==t)for(;r&&r!=s.dom;)r=Oh(r);else t.insertBefore(s.dom,r);i=s.dom}for(r=i?i.nextSibling:t.firstChild,r&&e&&e.node==t&&(e.written=!0);r;)r=Oh(r)}else if(this.dirty&1)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let r=ds(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!$e.get(i);)i=i.nextSibling;if(!i)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==i)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let r=-1,s=-1,o=-1,l=-1;for(let a=0,c=i,u=i;a<this.children.length;a++){let h=this.children[a],d=c+h.length;if(c<e&&d>t)return h.domBoundsAround(e,t,c);if(d>=e&&r==-1&&(r=a,s=c),c>t&&h.dom.parentNode==this.dom){o=a,l=u;break}u=d,c=d+h.breakAfter}return{from:s,to:l<0?i+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=Ul){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&s.destroy()}this.children.splice(e,t-e,...i);for(let r=0;r<i.length;r++)i[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Ah(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,i,r,s,o){return!1}become(e){return!1}getSide(){return 0}destroy(){this.parent=null}}$e.prototype.breakAfter=0;function Oh(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Ah{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Eh(n,e,t,i,r,s,o,l,a){let{children:c}=n,u=c.length?c[e]:null,h=s.length?s[s.length-1]:null,d=h?h.breakAfter:o;if(!(e==i&&u&&!o&&!d&&s.length<2&&u.merge(t,r,s.length?h:null,t==0,l,a))){if(i<c.length){let m=c[i];m&&r<m.length?(e==i&&(m=m.split(r),r=0),!d&&h&&m.merge(0,r,h,!0,0,a)?s[s.length-1]=m:(r&&m.merge(0,r,null,!1,0,a),s.push(m))):m!=null&&m.breakAfter&&(h?h.breakAfter=1:o=1),i++}for(u&&(u.breakAfter=o,t>0&&(!o&&s.length&&u.merge(t,u.length,s[0],!1,l,0)?u.breakAfter=s.shift().breakAfter:(t<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(t,u.length,null,!1,l,0),e++));e<i&&s.length;)if(c[i-1].become(s[s.length-1]))i--,s.pop(),a=s.length?0:l;else if(c[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&i<c.length&&!c[e-1].breakAfter&&c[i].merge(0,0,c[e-1],!1,l,a)&&e--,(e<i||s.length)&&n.replaceChildren(e,i,s)}}function Ph(n,e,t,i,r,s){let o=n.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:c,off:u}=o.findPos(e,-1),h=e-t;for(let d of i)h+=d.length;n.length+=h,Eh(n,c,u,l,a,i,0,r,s)}let Pt=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},zl=typeof document!="undefined"?document:{documentElement:{style:{}}};const Zl=/Edge\/(\d+)/.exec(Pt.userAgent),Dh=/MSIE \d/.test(Pt.userAgent),ql=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pt.userAgent),ps=!!(Dh||ql||Zl),Th=!ps&&/gecko\/(\d+)/i.test(Pt.userAgent),Kl=!ps&&/Chrome\/(\d+)/.exec(Pt.userAgent),Mh="webkitFontSmoothing"in zl.documentElement.style,Fh=!ps&&/Apple Computer/.test(Pt.vendor),Bh=Fh&&(/Mobile\/\w+/.test(Pt.userAgent)||Pt.maxTouchPoints>2);var oe={mac:Bh||/Mac/.test(Pt.platform),windows:/Win/.test(Pt.platform),linux:/Linux|X11/.test(Pt.platform),ie:ps,ie_version:Dh?zl.documentMode||6:ql?+ql[1]:Zl?+Zl[1]:0,gecko:Th,gecko_version:Th?+(/Firefox\/(\d+)/.exec(Pt.userAgent)||[0,0])[1]:0,chrome:!!Kl,chrome_version:Kl?+Kl[1]:0,ios:Bh,android:/Android\b/.test(Pt.userAgent),webkit:Mh,safari:Fh,webkit_version:Mh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:zl.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const zb=256;class Fn extends $e{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return i&&(!(i instanceof Fn)||this.length-(t-e)+i.length>zb)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Fn(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new it(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Gl(this.dom,e,t)}}class Gt extends $e{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let r of t)r.setParent(this)}setAttrs(e){if(kh(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,i,r,s,o){return i&&(!(i instanceof Gt&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(Ph(this,e,t,i?i.children:[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,r=-1,s=0;for(let l of this.children){let a=i+l.length;a>e&&t.push(i<e?l.split(e-i):l),r<0&&i>=e&&(r=s),i=a,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Gt(this.mark,t,o)}domAtPos(e){return Lh(this.dom,this.children,e)}coordsAt(e,t){return Wh(this,e,t)}}function Gl(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let r=e,s=e,o=0;e==0&&t<0||e==i&&t>=0?oe.chrome||oe.gecko||(e?(r--,o=1):(s++,o=-1)):t<0?r--:s++;let l=or(n,r,s).getClientRects();if(!l.length)return xh;let a=l[(o?o<0:t>=0)?0:l.length-1];return oe.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),o?ms(a,o<0):a||null}class Bn extends $e{constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}static create(e,t,i){return new(e.customView||Bn)(e,t,i)}split(e){let t=Bn.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,i,r,s,o){return i&&(!(i instanceof Bn)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof Bn&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Ee.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,i=t&&t.state.doc,r=this.posAtStart;return i?i.slice(r,r+this.length):Ee.empty}domAtPos(e){return e==0?it.before(this.dom):it.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),r=null;if(!i.length)return xh;for(let s=e>0?i.length-1:0;r=i[s],!(e>0?s==0:s==i.length-1||r.top<r.bottom);s+=e>0?-1:1);return e==0&&t>0||e==this.length&&t<=0?r:ms(r,e==0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Rh extends Bn{domAtPos(e){let{topView:t,text:i}=this.widget;return t?Jl(e,0,t,i,(r,s)=>r.domAtPos(s),r=>new it(i,Math.min(r,i.nodeValue.length))):new it(i,Math.min(e,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:i,text:r}=this.widget;return i?Ih(e,t,i,r):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:i,text:r}=this.widget;return i?Jl(e,t,i,r,(s,o,l)=>s.coordsAt(o,l),(s,o)=>Gl(r,s,o)):Gl(r,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}}function Jl(n,e,t,i,r,s){if(t instanceof Gt){for(let o of t.children){let l=wi(o.dom,i),a=l?i.nodeValue.length:o.length;if(n<a||n==a&&o.getSide()<=0)return l?Jl(n,e,o,i,r,s):r(o,n,e);n-=a}return r(t,t.length,-1)}else return t.dom==i?s(n,e):r(t,n,e)}function Ih(n,e,t,i){if(t instanceof Gt)for(let r of t.children){let s=0,o=wi(r.dom,i);if(wi(r.dom,n))return s+(o?Ih(n,e,r,i):r.localPosFromDOM(n,e));s+=o?i.nodeValue.length:r.length}else if(t.dom==i)return Math.min(e,i.nodeValue.length);return t.localPosFromDOM(n,e)}class Si extends $e{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Si&&e.side==this.side}split(){return new Si(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return it.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),i=Zb(this,this.side>0?-1:1);return i&&i.top<t.bottom&&i.bottom>t.top?{left:t.left,right:t.right,top:i.top,bottom:i.bottom}:t}get overrideDOMText(){return Ee.empty}}Fn.prototype.children=Bn.prototype.children=Si.prototype.children=Ul;function Zb(n,e){let t=n.parent,i=t?t.children.indexOf(n):-1;for(;t&&i>=0;)if(e<0?i>0:i<t.children.length){let r=t.children[i+e];if(r instanceof Fn){let s=r.coordsAt(e<0?r.length:0,e);if(s)return s}i+=e}else if(t instanceof Gt&&t.parent)i=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let r=t.dom.lastChild;if(r&&r.nodeName=="BR")return r.getClientRects()[0];break}}function Lh(n,e,t){let i=0;for(let r=0;i<e.length;i++){let s=e[i],o=r+s.length;if(!(o==r&&s.getSide()<=0)){if(t>r&&t<o&&s.dom.parentNode==n)return s.domAtPos(t-r);if(t<=r)break;r=o}}for(;i>0;i--){let r=e[i-1].dom;if(r.parentNode==n)return it.after(r)}return new it(n,0)}function Nh(n,e,t){let i,{children:r}=n;t>0&&e instanceof Gt&&r.length&&(i=r[r.length-1])instanceof Gt&&i.mark.eq(e.mark)?Nh(i,e.children[0],t-1):(r.push(e),e.setParent(n)),n.length+=e.length}function Wh(n,e,t){for(let s=0,o=0;o<n.children.length;o++){let l=n.children[o],a=s+l.length,c;if((t<=0||a==n.length||l.getSide()>0?a>=e:a>e)&&(e<a||o+1==n.children.length||(c=n.children[o+1]).length||c.getSide()>0)){let u=0;if(a==s){if(l.getSide()<=0)continue;u=t=-l.getSide()}let h=l.coordsAt(Math.max(0,e-s),t);return u&&h?ms(h,t<0):h}s=a}let i=n.dom.lastChild;if(!i)return n.dom.getBoundingClientRect();let r=sr(i);return r[r.length-1]||null}function Yl(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}function Xl(n,e){if(n==e)return!0;if(!n||!e)return!1;let t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r of t)if(i.indexOf(r)==-1||n[r]!==e[r])return!1;return!0}function _l(n,e,t){if(e)for(let i in e)t&&i in t||n.removeAttribute(i);if(t)for(let i in t)e&&e[i]==t[i]||n.setAttribute(i,t[i])}class Jt{eq(e){return!1}updateDOM(e){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var Me=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(Me||(Me={}));class te extends Yn{constructor(e,t,i,r){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=r}get heightRelevant(){return!1}static mark(e){return new gs(e)}static widget(e){let t=e.side||0,i=!!e.block;return t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8,new Xn(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,r;if(e.isBlockGap)i=-5e8,r=4e8;else{let{start:s,end:o}=jh(e,t);i=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new Xn(e,i,r,t,e.widget||null,!0)}static line(e){return new ar(e)}static set(e,t=!1){return ke.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}te.none=ke.empty;class gs extends te{constructor(e){let{start:t,end:i}=jh(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof gs&&this.tagName==e.tagName&&this.class==e.class&&Xl(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}gs.prototype.point=!1;class ar extends te{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof ar&&Xl(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}ar.prototype.mapMode=ft.TrackBefore,ar.prototype.point=!0;class Xn extends te{constructor(e,t,i,r,s,o){super(t,i,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?ft.TrackBefore:ft.TrackAfter:ft.TrackDel}get type(){return this.startSide<this.endSide?Me.WidgetRange:this.startSide<=0?Me.WidgetBefore:Me.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Xn&&qb(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Xn.prototype.point=!0;function jh(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t!=null?t:e,end:i!=null?i:e}}function qb(n,e){return n==e||!!(n&&e&&n.compare(e))}function Ql(n,e,t,i=0){let r=t.length-1;r>=0&&t[r]+i>=n?t[r]=Math.max(t[r],e):t.push(n,e)}class pt extends $e{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,r,s,o){if(i){if(!(i instanceof pt))return!1;this.dom||i.transferDOM(this)}return r&&this.setDeco(i?i.attrs:null),Ph(this,e,t,i?i.children:[],s,o),!0}split(e){let t=new pt;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:r}=this.childPos(e);r&&(t.append(this.children[i].split(r),0),this.children[i].merge(r,this.children[i].length,null,!1,0,0),i++);for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){!this.dom||(e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Xl(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Nh(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=Yl(t,this.attrs||{})),i&&(this.attrs=Yl({class:i},this.attrs||{}))}domAtPos(e){return Lh(this.dom,this.children,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?this.dirty&4&&(kh(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(_l(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let i=this.dom.lastChild;for(;i&&$e.get(i)instanceof Gt;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((t=$e.get(i))===null||t===void 0?void 0:t.isEditable)==!1&&(!oe.ios||!this.children.some(r=>r instanceof Fn))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof Fn))return null;let i=sr(t.dom);if(i.length!=1)return null;e+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}}coordsAt(e,t){return Wh(this,e,t)}become(e){return!1}get type(){return Me.Text}static find(e,t){for(let i=0,r=0;i<e.children.length;i++){let s=e.children[i],o=r+s.length;if(o>=t){if(s instanceof pt)return s;if(o>t)break}r=o+s.breakAfter}return null}}class _n extends $e{constructor(e,t,i){super(),this.widget=e,this.length=t,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,r,s,o){return i&&(!(i instanceof _n)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?it.before(this.dom):it.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new _n(this.widget,t,this.type);return i.breakAfter=this.breakAfter,i}get children(){return Ul}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ee.empty}domBoundsAround(){return null}become(e){return e instanceof _n&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ea{constructor(e,t,i,r){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsBelow=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof _n&&e.type==Me.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new pt),this.atCursorPos=!0),this.curLine}flushBuffer(e){this.pendingBuffer&&(this.curLine.append(ys(new Si(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer([]),this.curLine=null,this.content.push(e)}finish(e){e?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(0,i)),this.getLine().append(ys(new Fn(this.text.slice(this.textOff,this.textOff+r)),t),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=0}}span(e,t,i,r){this.buildText(t-e,i,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,i,r,s){let o=t-e;if(i instanceof Xn)if(i.block){let{type:l}=i;l==Me.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new _n(i.widget||new Vh("div"),o,l))}else{let l=Bn.create(i.widget||new Vh("span"),o,i.startSide),a=this.atCursorPos&&!l.isEditable&&s<=r.length&&(e<t||i.startSide>0),c=!l.isEditable&&(e<t||i.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!a&&(this.pendingBuffer=0),this.flushBuffer(r),a&&(u.append(ys(new Si(1),r),s),s=r.length+Math.max(0,s-r.length)),u.append(ys(l,r),s),this.atCursorPos=c,this.pendingBuffer=c?e<t?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}filterPoint(e,t,i,r){if(r<this.disallowBlockEffectsBelow&&i instanceof Xn){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}return!0}static build(e,t,i,r,s){let o=new ea(e,t,i,s);return o.openEnd=ke.spans(r,t,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function ys(n,e){for(let t of e)n=new Gt(t,[n],n.length);return n}class Vh extends Jt{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const Kb=[],$h=ne.define(),Hh=ne.define(),Uh=ne.define(),zh=ne.define(),ta=ne.define(),Zh=ne.define(),na=ue.define({map:(n,e)=>n.map(e)}),qh=ue.define({map:(n,e)=>n.map(e)});class Ci{constructor(e,t="nearest",i="nearest",r=5,s=5){this.range=e,this.y=t,this.x=i,this.yMargin=r,this.xMargin=s}map(e){return e.empty?this:new Ci(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const Kh=ue.define({map:(n,e)=>n.map(e)});function Dt(n,e,t){let i=n.facet(zh);i.length?i[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const cr=ne.define({combine:n=>n.length?n[0]:!0});class Gb{constructor(e,t){this.field=e,this.get=t}}class lt{from(e){return new Gb(this,e)}static define(){return new lt}}lt.decorations=lt.define(),lt.atomicRanges=lt.define(),lt.scrollMargins=lt.define();let Jb=0;const ur=ne.define();class Ue{constructor(e,t,i){this.id=e,this.create=t,this.fields=i,this.extension=ur.of(this)}static define(e,t){let{eventHandlers:i,provide:r,decorations:s}=t||{},o=[];if(r)for(let l of Array.isArray(r)?r:[r])o.push(l);return i&&o.push(Gh.from(l=>({plugin:l,handlers:i}))),s&&o.push(lt.decorations.from(s)),new Ue(Jb++,e,o)}static fromClass(e,t){return Ue.define(i=>new e(i),t)}}const Gh=lt.define();class ia{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}takeField(e,t){if(this.spec)for(let{field:i,get:r}of this.spec.fields)i==e&&t.push(r(this.value))}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(Dt(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Dt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){Dt(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Jh=ne.define(),ra=ne.define(),Qn=ne.define(),hr=ne.define();class Yt{constructor(e,t,i,r){this.fromA=e,this.toA=t,this.fromB=i,this.toB=r}join(e){return new Yt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let r=0,s=0,o=0,l=0;;r++){let a=r==e.length?null:e[r],c=o-l,u=a?a.fromB:1e9;for(;s<t.length&&t[s]<u;){let h=t[s],d=t[s+1],m=Math.max(l,h),p=Math.min(u,d);if(m<=p&&new Yt(m+c,p+c,m,p).addToSet(i),d>u)break;s+=2}if(!a)return i;new Yt(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),o=a.toA,l=a.toB}}}class Yh{constructor(e,t,i=Kb){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Je.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let r=[];this.changes.iterChangedRanges((o,l,a,c)=>r.push(new Yt(o,l,a,c))),this.changedRanges=r;let s=e.hasFocus;s!=e.inputState.notifiedFocused&&(e.inputState.notifiedFocused=s,this.flags|=1)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var xe=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(xe||(xe={}));const sa=xe.LTR,Yb=xe.RTL;function Xh(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const Xb=Xh("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),_b=Xh("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),oa=Object.create(null),Xt=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);oa[e]=t,oa[t]=-e}function Qb(n){return n<=247?Xb[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?_b[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203||n==8204?256:1}const ew=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class ki{constructor(e,t,i){this.from=e,this.to=t,this.level=i}get dir(){return this.level%2?Yb:sa}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,i,r){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==i)return o;(s<0||(r!=0?r<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}const je=[];function _h(n,e){let t=n.length,i=e==sa?1:2,r=e==sa?2:1;if(!n||i==1&&!ew.test(n))return Qh(t);for(let o=0,l=i,a=i;o<t;o++){let c=Qb(n.charCodeAt(o));c==512?c=l:c==8&&a==4&&(c=16),je[o]=c==4?2:c,c&7&&(a=c),l=c}for(let o=0,l=i,a=i;o<t;o++){let c=je[o];if(c==128)o<t-1&&l==je[o+1]&&l&24?c=je[o]=l:je[o]=256;else if(c==64){let u=o+1;for(;u<t&&je[u]==64;)u++;let h=o&&l==8||u<t&&je[u]==8?a==1?1:8:256;for(let d=o;d<u;d++)je[d]=h;o=u-1}else c==8&&a==1&&(je[o]=1);l=c,c&7&&(a=c)}for(let o=0,l=0,a=0,c,u,h;o<t;o++)if(u=oa[c=n.charCodeAt(o)])if(u<0){for(let d=l-3;d>=0;d-=3)if(Xt[d+1]==-u){let m=Xt[d+2],p=m&2?i:m&4?m&1?r:i:0;p&&(je[o]=je[Xt[d]]=p),l=d;break}}else{if(Xt.length==189)break;Xt[l++]=o,Xt[l++]=c,Xt[l++]=a}else if((h=je[o])==2||h==1){let d=h==i;a=d?0:1;for(let m=l-3;m>=0;m-=3){let p=Xt[m+2];if(p&2)break;if(d)Xt[m+2]|=2;else{if(p&4)break;Xt[m+2]|=4}}}for(let o=0;o<t;o++)if(je[o]==256){let l=o+1;for(;l<t&&je[l]==256;)l++;let a=(o?je[o-1]:i)==1,c=(l<t?je[l]:i)==1,u=a==c?a?1:2:i;for(let h=o;h<l;h++)je[h]=u;o=l-1}let s=[];if(i==1)for(let o=0;o<t;){let l=o,a=je[o++]!=1;for(;o<t&&a==(je[o]!=1);)o++;if(a)for(let c=o;c>l;){let u=c,h=je[--c]!=2;for(;c>l&&h==(je[c-1]!=2);)c--;s.push(new ki(c,u,h?2:1))}else s.push(new ki(l,o,0))}else for(let o=0;o<t;){let l=o,a=je[o++]==2;for(;o<t&&a==(je[o]==2);)o++;s.push(new ki(l,o,a?1:2))}return s}function Qh(n){return[new ki(0,n,0)]}let ef="";function tf(n,e,t,i,r){var s;let o=i.head-n.from,l=-1;if(o==0){if(!r||!n.length)return null;e[0].level!=t&&(o=e[0].side(!1,t),l=0)}else if(o==n.length){if(r)return null;let d=e[e.length-1];d.level!=t&&(o=d.side(!0,t),l=e.length-1)}l<0&&(l=ki.find(e,o,(s=i.bidiLevel)!==null&&s!==void 0?s:-1,i.assoc));let a=e[l];o==a.side(r,t)&&(a=e[l+=r?1:-1],o=a.side(!r,t));let c=r==(a.dir==t),u=Et(n.text,o,c);if(ef=n.text.slice(Math.min(o,u),Math.max(o,u)),u!=a.side(r,t))return T.cursor(u+n.from,c?-1:1,a.level);let h=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return!h&&a.level!=t?T.cursor(r?n.to:n.from,r?-1:1,t):h&&h.level<a.level?T.cursor(h.side(!r,t)+n.from,r?1:-1,h.level):T.cursor(u+n.from,r?-1:1,a.level)}const Rn="\uFFFF";class nf{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(we.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Rn}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let r=e;;){this.findPointBefore(i,r),this.readNode(r);let s=r.nextSibling;if(s==t)break;let o=$e.get(r),l=$e.get(s);(o&&l?o.breakAfter:(o?o.breakAfter:rf(r))||rf(s)&&(r.nodeName!="BR"||r.cmIgnore))&&this.lineBreak(),r=s}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(l=r.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(i,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);i=s+o}}readNode(e){if(e.cmIgnore)return;let t=$e.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let r=i.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+Math.min(t,i.offset))}}function rf(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class sf{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class of extends $e{constructor(e){super(),this.view=e,this.compositionDeco=te.none,this.decorations=[],this.pluginDecorationLength=0,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new pt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Yt(0,0,0,e.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:o,toA:l})=>l<this.minWidthFrom||o>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=te.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=nw(this.view,e.changes)),(oe.ie||oe.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,r=this.updateDeco(),s=ow(i,r,e.changes);return t=Yt.extendWithRanges(t,s),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.minWidth=this.minWidth?this.minWidth+"px":"";let s=oe.chrome||oe.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(s),this.dirty=0,s&&(s.written||i.selectionRange.focusNode!=s.node)&&(this.forceSelection=!0),this.dom.style.height=""});let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)s instanceof _n&&s.widget instanceof lf&&r.push(s.dom);i.updateGaps(r)}updateChildren(e,t){let i=this.childCursor(t);for(let r=e.length-1;;r--){let s=r>=0?e[r]:null;if(!s)break;let{fromA:o,toA:l,fromB:a,toB:c}=s,{content:u,breakAtStart:h,openStart:d,openEnd:m}=ea.build(this.view.state.doc,a,c,this.decorations,this.pluginDecorationLength),{i:p,off:y}=i.findPos(l,1),{i:b,off:v}=i.findPos(o,-1);Eh(this,b,v,p,y,u,h,d,m)}}updateSelection(e=!1,t=!1){if(e&&this.view.observer.readSelectionRange(),!(t||this.mayControlSelection())||oe.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,s=this.domAtPos(r.anchor),o=r.empty?s:this.domAtPos(r.head);if(oe.gecko&&r.empty&&tw(s)){let a=document.createTextNode("");this.view.observer.ignore(()=>s.node.insertBefore(a,s.node.childNodes[s.offset]||null)),s=o=new it(a,0),i=!0}let l=this.view.observer.selectionRange;(i||!l.focusNode||!fs(s.node,s.offset,l.anchorNode,l.anchorOffset)||!fs(o.node,o.offset,l.focusNode,l.focusOffset))&&(this.view.observer.ignore(()=>{oe.android&&oe.chrome&&this.dom.contains(l.focusNode)&&lw(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let a=hs(this.root);if(r.empty){if(oe.gecko){let c=rw(s.node,s.offset);if(c&&c!=3){let u=cf(s.node,s.offset,c==1?1:-1);u&&(s=new it(u,c==1?0:u.nodeValue.length))}}a.collapse(s.node,s.offset),r.bidiLevel!=null&&l.cursorBidiLevel!=null&&(l.cursorBidiLevel=r.bidiLevel)}else if(a.extend)a.collapse(s.node,s.offset),a.extend(o.node,o.offset);else{let c=document.createRange();r.anchor>r.head&&([s,o]=[o,s]),c.setEnd(o.node,o.offset),c.setStart(s.node,s.offset),a.removeAllRanges(),a.addRange(c)}}),this.view.observer.setSelectionRange(s,o)),this.impreciseAnchor=s.precise?null:new it(l.anchorNode,l.anchorOffset),this.impreciseHead=o.precise?null:new it(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main,t=hs(this.root);if(!e.empty||!e.assoc||!t.modify)return;let i=pt.find(this,e.head);if(!i)return;let r=i.posAtStart;if(e.head==r||e.head==r+i.length)return;let s=this.coordsAt(e.head,-1),o=this.coordsAt(e.head,1);if(!s||!o||s.bottom>o.top)return;let l=this.domAtPos(e.head+e.assoc);t.collapse(l.node,l.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(cr)?this.root.activeElement==this.dom:$l(this.dom,this.view.observer.selectionRange)}nearest(e){for(let t=e;t;){let i=$e.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(i<r.length||r instanceof pt)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){for(let i=this.length,r=this.children.length-1;;r--){let s=this.children[r],o=i-s.breakAfter-s.length;if(e>o||e==o&&s.type!=Me.WidgetBefore&&s.type!=Me.WidgetAfter&&(!r||t==2||this.children[r-1].breakAfter||this.children[r-1].type==Me.WidgetBefore&&t>-2))return s.coordsAt(e-o,t);i=o}}measureVisibleLineHeights(){let e=[],{from:t,to:i}=this.view.viewState.viewport,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1;for(let l=0,a=0;a<this.children.length;a++){let c=this.children[a],u=l+c.length;if(u>i)break;if(l>=t){let h=c.dom.getBoundingClientRect();if(e.push(h.height),s){let d=c.dom.lastChild,m=d?sr(d):[];if(m.length){let p=m[m.length-1],y=this.view.textDirection==xe.LTR?p.right-h.left:h.right-p.left;y>o&&(o=y,this.minWidth=r,this.minWidthFrom=l,this.minWidthTo=u)}}}l=u+c.breakAfter}return e}measureTextSize(){for(let r of this.children)if(r instanceof pt){let s=r.measureTextSize();if(s)return s}let e=document.createElement("div"),t,i;return e.className="cm-line",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let r=sr(e.firstChild)[0];t=e.getBoundingClientRect().height,i=r?r.width/27:7,e.remove()}),{lineHeight:t,charWidth:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Ah(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,r=0;;r++){let s=r==t.viewports.length?null:t.viewports[r],o=s?s.from-1:this.length;if(o>i){let l=t.lineBlockAt(o).bottom-t.lineBlockAt(i).top;e.push(te.replace({widget:new lf(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return te.set(e)}updateDeco(){let e=this.view.pluginField(lt.decorations);return this.pluginDecorationLength=e.length,this.decorations=[...e,...this.view.state.facet(Qn),this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!i)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,r.left),top:Math.min(i.top,r.top),right:Math.max(i.right,r.right),bottom:Math.max(i.bottom,r.bottom)});let s=0,o=0,l=0,a=0;for(let u of this.view.pluginField(lt.scrollMargins))if(u){let{left:h,right:d,top:m,bottom:p}=u;h!=null&&(s=Math.max(s,h)),d!=null&&(o=Math.max(o,d)),m!=null&&(l=Math.max(l,m)),p!=null&&(a=Math.max(a,p))}let c={left:i.left-s,top:i.top-l,right:i.right+o,bottom:i.bottom+a};$b(this.view.scrollDOM,c,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==xe.LTR)}}function tw(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class lf extends Jt{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function af(n){let e=n.observer.selectionRange,t=e.focusNode&&cf(e.focusNode,e.focusOffset,0);if(!t)return null;let i=n.docView.nearest(t);if(!i)return null;if(i instanceof pt){let r=t;for(;r.parentNode!=i.dom;)r=r.parentNode;let s=r.previousSibling;for(;s&&!$e.get(s);)s=s.previousSibling;let o=s?$e.get(s).posAtEnd:i.posAtStart;return{from:o,to:o,node:r,text:t}}else{for(;;){let{parent:s}=i;if(!s)return null;if(s instanceof pt)break;i=s}let r=i.posAtStart;return{from:r,to:r+i.length,node:i.dom,text:t}}}function nw(n,e){let t=af(n);if(!t)return te.none;let{from:i,to:r,node:s,text:o}=t,l=e.mapPos(i,1),a=Math.max(l,e.mapPos(r,-1)),{state:c}=n,u=s.nodeType==3?s.nodeValue:new nf([],c).readRange(s.firstChild,null).text;if(a-l<u.length)if(c.doc.sliceString(l,Math.min(c.doc.length,l+u.length),Rn)==u)a=l+u.length;else if(c.doc.sliceString(Math.max(0,a-u.length),a,Rn)==u)l=a-u.length;else return te.none;else if(c.doc.sliceString(l,a,Rn)!=u)return te.none;let h=$e.get(s);return h instanceof Rh?h=h.widget.topView:h&&(h.parent=null),te.set(te.replace({widget:new iw(s,o,h)}).range(l,a))}class iw extends Jt{constructor(e,t,i){super(),this.top=e,this.text=t,this.topView=i}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return Rh}}function cf(n,e,t){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0&&t<=0)n=n.childNodes[e-1],e=ds(n);else if(n.nodeType==1&&e<n.childNodes.length&&t>=0)n=n.childNodes[e],e=0;else return null}}function rw(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}class sw{constructor(){this.changes=[]}compareRange(e,t){Ql(e,t,this.changes)}comparePoint(e,t){Ql(e,t,this.changes)}}function ow(n,e,t){let i=new sw;return ke.compare(n,e,t,i),i.changes}function lw(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function aw(n,e,t=1){let i=n.charCategorizer(e),r=n.doc.lineAt(e),s=e-r.from;if(r.length==0)return T.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,l=s;t<0?o=Et(r.text,s,!1):l=Et(r.text,s);let a=i(r.text.slice(o,l));for(;o>0;){let c=Et(r.text,o,!1);if(i(r.text.slice(c,o))!=a)break;o=c}for(;l<r.length;){let c=Et(r.text,l);if(i(r.text.slice(l,c))!=a)break;l=c}return T.range(o+r.from,l+r.from)}function cw(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function uw(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function la(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function uf(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function hf(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function aa(n,e,t){let i,r,s,o,l,a,c,u;for(let m=n.firstChild;m;m=m.nextSibling){let p=sr(m);for(let y=0;y<p.length;y++){let b=p[y];r&&la(r,b)&&(b=uf(hf(b,r.bottom),r.top));let v=cw(e,b),C=uw(t,b);if(v==0&&C==0)return m.nodeType==3?ff(m,e,t):aa(m,e,t);(!i||o>C||o==C&&s>v)&&(i=m,r=b,s=v,o=C),v==0?t>b.bottom&&(!c||c.bottom<b.bottom)?(l=m,c=b):t<b.top&&(!u||u.top>b.top)&&(a=m,u=b):c&&la(c,b)?c=hf(c,b.bottom):u&&la(u,b)&&(u=uf(u,b.top))}}if(c&&c.bottom>=t?(i=l,r=c):u&&u.top<=t&&(i=a,r=u),!i)return{node:n,offset:0};let h=Math.max(r.left,Math.min(r.right,e));if(i.nodeType==3)return ff(i,h,t);if(!s&&i.contentEditable=="true")return aa(i,h,t);let d=Array.prototype.indexOf.call(n.childNodes,i)+(e>=(r.left+r.right)/2?1:0);return{node:n,offset:d}}function ff(n,e,t){let i=n.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<i;l++){let a=or(n,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let u=a[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let h=(u.top>t?u.top-t:t-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&h<s){let d=e>=(u.left+u.right)/2,m=d;if((oe.chrome||oe.gecko)&&or(n,l).getBoundingClientRect().left==u.right&&(m=!d),h<=0)return{node:n,offset:l+(m?1:0)};r=l+(m?1:0),s=h}}}return{node:n,offset:r>-1?r:o>0?n.nodeValue.length:0}}function df(n,{x:e,y:t},i,r=-1){var s;let o=n.contentDOM.getBoundingClientRect(),l=o.top+n.viewState.paddingTop,a,{docHeight:c}=n.viewState,u=t-l;if(u<0)return 0;if(u>c)return n.state.doc.length;for(let v=n.defaultLineHeight/2,C=!1;a=n.elementAtHeight(u),a.type!=Me.Text;)for(;u=r>0?a.bottom+v:a.top-v,!(u>=0&&u<=c);){if(C)return i?null:0;C=!0,r=-r}t=l+u;let h=a.from;if(h<n.viewport.from)return n.viewport.from==0?0:i?null:mf(n,o,a,e,t);if(h>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:i?null:mf(n,o,a,e,t);let d=n.dom.ownerDocument,m=n.root.elementFromPoint?n.root:d,p=m.elementFromPoint(e,t);p&&!n.contentDOM.contains(p)&&(p=null),p||(e=Math.max(o.left+1,Math.min(o.right-1,e)),p=m.elementFromPoint(e,t),p&&!n.contentDOM.contains(p)&&(p=null));let y,b=-1;if(p&&((s=n.docView.nearest(p))===null||s===void 0?void 0:s.isEditable)!=!1){if(d.caretPositionFromPoint){let v=d.caretPositionFromPoint(e,t);v&&({offsetNode:y,offset:b}=v)}else if(d.caretRangeFromPoint){let v=d.caretRangeFromPoint(e,t);v&&({startContainer:y,startOffset:b}=v,oe.safari&&hw(y,b,e)&&(y=void 0))}}if(!y||!n.docView.dom.contains(y)){let v=pt.find(n.docView,h);if(!v)return u>a.top+a.height/2?a.to:a.from;({node:y,offset:b}=aa(v.dom,e,t))}return n.docView.posFromDOM(y,b)}function mf(n,e,t,i,r){let s=Math.round((i-e.left)*n.defaultCharacterWidth);n.lineWrapping&&t.height>n.defaultLineHeight*1.5&&(s+=Math.floor((r-t.top)/n.defaultLineHeight)*n.viewState.heightOracle.lineLength);let o=n.state.sliceDoc(t.from,t.to);return t.from+kl(o,s,n.state.tabSize)}function hw(n,e,t){let i;if(n.nodeType!=3||e!=(i=n.nodeValue.length))return!1;for(let r=n.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return or(n,i-1,i).getBoundingClientRect().left>t}function fw(n,e,t,i){let r=n.state.doc.lineAt(e.head),s=!i||!n.lineWrapping?null:n.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let a=n.dom.getBoundingClientRect(),c=n.posAtCoords({x:t==(n.textDirection==xe.LTR)?a.right-1:a.left+1,y:(s.top+s.bottom)/2});if(c!=null)return T.cursor(c,t?-1:1)}let o=pt.find(n.docView,e.head),l=o?t?o.posAtEnd:o.posAtStart:t?r.to:r.from;return T.cursor(l,t?-1:1)}function pf(n,e,t,i){let r=n.state.doc.lineAt(e.head),s=n.bidiSpans(r);for(let o=e,l=null;;){let a=tf(r,s,n.textDirection,o,t),c=ef;if(!a){if(r.number==(t?n.state.doc.lines:1))return o;c=`
`,r=n.state.doc.line(r.number+(t?1:-1)),s=n.bidiSpans(r),a=T.cursor(t?r.from:r.to)}if(l){if(!l(c))return o}else{if(!i)return a;l=i(c)}o=a}}function dw(n,e,t){let i=n.state.charCategorizer(e),r=i(t);return s=>{let o=i(s);return r==mt.Space&&(r=o),r==o}}function mw(n,e,t,i){let r=e.head,s=t?1:-1;if(r==(t?n.state.doc.length:0))return T.cursor(r,e.assoc);let o=e.goalColumn,l,a=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(r),u=n.documentTop;if(c)o==null&&(o=c.left-a.left),l=s<0?c.top:c.bottom;else{let m=n.viewState.lineBlockAt(r-u);o==null&&(o=Math.min(a.right-a.left,n.defaultCharacterWidth*(r-m.from))),l=(s<0?m.top:m.bottom)+u}let h=a.left+o,d=i!=null?i:n.defaultLineHeight>>1;for(let m=0;;m+=10){let p=l+(d+m)*s,y=df(n,{x:h,y:p},!1,s);if(p<a.top||p>a.bottom||(s<0?y<r:y>r))return T.cursor(y,e.assoc,void 0,o)}}function ca(n,e,t){let i=n.pluginField(lt.atomicRanges);for(;;){let r=!1;for(let s of i)s.between(t.from-1,t.from+1,(o,l,a)=>{t.from>o&&t.from<l&&(t=e.from>t.from?T.cursor(o,1):T.cursor(l,-1),r=!0)});if(!r)return t}}class pw{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let t in Xe){let i=Xe[t];e.contentDOM.addEventListener(t,r=>{!vf(e,r)||this.ignoreDuringComposition(r)||t=="keydown"&&this.keydown(e,r)||(this.mustFlushObserver(r)&&e.observer.forceFlush(),this.runCustomHandlers(t,e,r)?r.preventDefault():i(e,r))}),this.registeredEvents.push(t)}this.notifiedFocused=e.hasFocus,this.ensureHandlers(e),oe.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e){let t=this.customHandlers=e.pluginField(Gh);for(let i of t)for(let r in i.handlers)this.registeredEvents.indexOf(r)<0&&r!="scroll"&&(this.registeredEvents.push(r),e.contentDOM.addEventListener(r,s=>{!vf(e,s)||this.runCustomHandlers(r,e,s)&&s.preventDefault()}))}runCustomHandlers(e,t,i){for(let r of this.customHandlers){let s=r.handlers[e];if(s)try{if(s.call(r.plugin,i,t)||i.defaultPrevented)return!0}catch(o){Dt(t.state,o)}}return!1}runScrollHandlers(e,t){for(let i of this.customHandlers){let r=i.handlers.scroll;if(r)try{r.call(i.plugin,t,e)}catch(s){Dt(e.state,s)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(oe.android&&oe.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return oe.ios&&(i=gf.find(r=>r.keyCode==t.keyCode))&&!(t.ctrlKey||t.altKey||t.metaKey)&&!t.synthetic?(this.pendingIOSKey=i,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,lr(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:oe.safari&&Date.now()-this.compositionEndedAt<500?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229||e.type=="compositionend"&&!oe.ios}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const gf=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],yf=[16,17,18,20,91,92,224,225];class gw{constructor(e,t,i,r){this.view=e,this.style=i,this.mustSelect=r,this.lastEvent=t;let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(we.allowMultipleSelections)&&yw(e,t),this.dragMove=vw(e,t),this.dragging=bw(e,t)&&ua(t)==1?null:!1,this.dragging===!1&&(t.preventDefault(),this.select(t))}move(e){if(e.buttons==0)return this.destroy();this.dragging===!1&&this.select(this.lastEvent=e)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function yw(n,e){let t=n.state.facet($h);return t.length?t[0](e):oe.mac?e.metaKey:e.ctrlKey}function vw(n,e){let t=n.state.facet(Hh);return t.length?t[0](e):oe.mac?!e.altKey:!e.ctrlKey}function bw(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=hs(n.root);if(i.rangeCount==0)return!0;let r=i.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function vf(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=$e.get(t))&&i.ignoreEvent(e))return!1;return!0}const Xe=Object.create(null),bf=oe.ie&&oe.ie_version<15||oe.ios&&oe.webkit_version<604;function ww(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),wf(n,t.value)},50)}function wf(n,e){let{state:t}=n,i,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(ha!=null&&t.selection.ranges.every(a=>a.empty)&&ha==s.toString()){let a=-1;i=t.changeByRange(c=>{let u=t.doc.lineAt(c.from);if(u.from==a)return{range:c};a=u.from;let h=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:u.from,insert:h},range:T.cursor(c.from+h.length)}})}else o?i=t.changeByRange(a=>{let c=s.line(r++);return{changes:{from:a.from,to:a.to,insert:c.text},range:T.cursor(a.from+c.length)}}):i=t.replaceSelection(s);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Xe.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():yf.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)};let xf=0;Xe.touchstart=(n,e)=>{xf=Date.now(),n.inputState.setSelectionOrigin("select.pointer")},Xe.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")},Xe.mousedown=(n,e)=>{if(n.observer.flush(),xf>Date.now()-2e3&&ua(e)==1)return;let t=null;for(let i of n.state.facet(Uh))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=Cw(n,e)),t){let i=n.root.activeElement!=n.contentDOM;i&&n.observer.ignore(()=>Sh(n.contentDOM)),n.inputState.startMouseSelection(new gw(n,e,t,i))}};function Sf(n,e,t,i){if(i==1)return T.cursor(e,t);if(i==2)return aw(n.state,e,t);{let r=pt.find(n.docView,e),s=n.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,l=r?r.posAtEnd:s.to;return l<n.state.doc.length&&l==s.to&&l++,T.range(o,l)}}let Cf=(n,e)=>n>=e.top&&n<=e.bottom,kf=(n,e,t)=>Cf(e,t)&&n>=t.left&&n<=t.right;function xw(n,e,t,i){let r=pt.find(n.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&kf(t,i,o))return-1;let l=r.coordsAt(s,1);return l&&kf(t,i,l)?1:o&&Cf(i,o)?-1:1}function Of(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:xw(n,t,e.clientX,e.clientY)}}const Sw=oe.ie&&oe.ie_version<=11;let Af=null,Ef=0,Pf=0;function ua(n){if(!Sw)return n.detail;let e=Af,t=Pf;return Af=n,Pf=Date.now(),Ef=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(Ef+1)%3:1}function Cw(n,e){let t=Of(n,e),i=ua(e),r=n.state.selection,s=t,o=e;return{update(l){l.docChanged&&(t&&(t.pos=l.changes.mapPos(t.pos)),r=r.map(l.changes),o=null)},get(l,a,c){let u;if(o&&l.clientX==o.clientX&&l.clientY==o.clientY?u=s:(u=s=Of(n,l),o=l),!u||!t)return r;let h=Sf(n,u.pos,u.bias,i);if(t.pos!=u.pos&&!a){let d=Sf(n,t.pos,t.bias,i),m=Math.min(d.from,h.from),p=Math.max(d.to,h.to);h=m<h.from?T.range(m,p):T.range(p,m)}return a?r.replaceRange(r.main.extend(h.from,h.to)):c?r.addRange(h):T.create([h])}}}Xe.dragstart=(n,e)=>{let{selection:{main:t}}=n.state,{mouseSelection:i}=n.inputState;i&&(i.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function Df(n,e,t,i){if(!t)return;let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=n.inputState,o=i&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:t},a=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}Xe.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let i=Array(t.length),r=0,s=()=>{++r==t.length&&Df(n,e,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[o]=l.result),s()},l.readAsText(t[o])}}else Df(n,e,e.dataTransfer.getData("Text"),!0)},Xe.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let t=bf?null:e.clipboardData;t?(wf(n,t.getData("text/plain")),e.preventDefault()):ww(n)};function kw(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function Ow(n){let e=[],t=[],i=!1;for(let r of n.selection.ranges)r.empty||(e.push(n.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),r=o.number}i=!0}return{text:e.join(n.lineBreak),ranges:t,linewise:i}}let ha=null;Xe.copy=Xe.cut=(n,e)=>{let{text:t,ranges:i,linewise:r}=Ow(n.state);if(!t&&!r)return;ha=r?t:null;let s=bf?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",t)):kw(n,t),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})},Xe.focus=Xe.blur=n=>{setTimeout(()=>{n.hasFocus!=n.inputState.notifiedFocused&&n.update([])},10)};function Tf(n,e){if(n.docView.compositionDeco.size){n.inputState.rapidCompositionStart=e;try{n.update([])}finally{n.inputState.rapidCompositionStart=!1}}}Xe.compositionstart=Xe.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0,n.docView.compositionDeco.size&&(n.observer.flush(),Tf(n,!0)))},Xe.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionFirstChange=null,setTimeout(()=>{n.inputState.composing<0&&Tf(n,!1)},50)},Xe.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()},Xe.beforeinput=(n,e)=>{var t;let i;if(oe.chrome&&oe.android&&(i=gf.find(r=>r.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>r+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const Mf=["pre-wrap","normal","pre-line","break-spaces"];class Ff{constructor(){this.doc=Ee.empty,this.lineWrapping=!1,this.direction=xe.LTR,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForStyle(e,t){return Mf.indexOf(e)>-1!=this.lineWrapping||this.direction!=t}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let r=e[i];r<0?i++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,i,r,s,o){let l=Mf.indexOf(e)>-1,a=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=l||this.direction!=t;if(this.lineWrapping=l,this.direction=t,this.lineHeight=i,this.charWidth=r,this.lineLength=s,a){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return a}}class Bf{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class mn{constructor(e,t,i,r,s){this.from=e,this.length=t,this.top=i,this.height=r,this.type=s}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new mn(this.from,this.length+e.length,this.top,this.height+e.height,t)}moveY(e){return e?new mn(this.from,this.length,this.top+e,this.height,Array.isArray(this.type)?this.type.map(t=>t.moveY(e)):this.type):this}}var Fe=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(Fe||(Fe={}));const vs=.001;class gt{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>vs&&(e.heightChanged=!0),this.height=t)}replace(e,t,i){return gt.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,r){let s=this;for(let o=r.length-1;o>=0;o--){let{fromA:l,toA:a,fromB:c,toB:u}=r[o],h=s.lineAt(l,Fe.ByPosNoHeight,t,0,0),d=h.to>=a?h:s.lineAt(a,Fe.ByPosNoHeight,t,0,0);for(u+=d.to-a,a=d.to;o>0&&h.from<=r[o-1].toA;)l=r[o-1].fromA,c=r[o-1].fromB,o--,l<h.from&&(h=s.lineAt(l,Fe.ByPosNoHeight,t,0,0));c+=h.from-l,l=h.from;let m=fa.build(i,e,c,u);s=s.replace(l,a,m)}return s.updateHeight(i,0)}static empty(){return new Tt(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,r=0,s=0;for(;;)if(t==i)if(r>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),i+=1+l.break,r-=l.size}else if(s>r*2){let l=e[i];l.break?e.splice(i,1,l.left,null,l.right):e.splice(i,1,l.left,l.right),i+=2+l.break,s-=l.size}else break;else if(r<s){let l=e[t++];l&&(r+=l.size)}else{let l=e[--i];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new Aw(gt.of(e.slice(0,t)),o,gt.of(e.slice(i)))}}gt.prototype.size=1;class Rf extends gt{constructor(e,t,i){super(e,t),this.type=i}blockAt(e,t,i,r){return new mn(r,this.length,i,this.height,this.type)}lineAt(e,t,i,r,s){return this.blockAt(0,i,r,s)}forEachLine(e,t,i,r,s,o){o(this.blockAt(0,i,r,s))}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Tt extends Rf{constructor(e,t){super(e,t,Me.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,i){let r=i[0];return i.length==1&&(r instanceof Tt||r instanceof rt&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof rt?r=new Tt(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):gt.of(i)}updateHeight(e,t=0,i=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(i||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class rt extends gt{constructor(e){super(e,0)}lines(e,t){let i=e.lineAt(t).number,r=e.lineAt(t+this.length).number;return{firstLine:i,lastLine:r,lineHeight:this.height/(r-i+1)}}blockAt(e,t,i,r){let{firstLine:s,lastLine:o,lineHeight:l}=this.lines(t,r),a=Math.max(0,Math.min(o-s,Math.floor((e-i)/l))),{from:c,length:u}=t.line(s+a);return new mn(c,u,i+l*a,l,Me.Text)}lineAt(e,t,i,r,s){if(t==Fe.ByHeight)return this.blockAt(e,i,r,s);if(t==Fe.ByPosNoHeight){let{from:h,to:d}=i.lineAt(e);return new mn(h,d-h,0,0,Me.Text)}let{firstLine:o,lineHeight:l}=this.lines(i,s),{from:a,length:c,number:u}=i.lineAt(e);return new mn(a,c,r+l*(u-o),l,Me.Text)}forEachLine(e,t,i,r,s,o){let{firstLine:l,lineHeight:a}=this.lines(i,s);for(let c=Math.max(e,s),u=Math.min(s+this.length,t);c<=u;){let h=i.lineAt(c);c==e&&(r+=a*(h.number-l)),o(new mn(h.from,h.length,r,a,Me.Text)),r+=a,c=h.to+1}}replace(e,t,i){let r=this.length-t;if(r>0){let s=i[i.length-1];s instanceof rt?i[i.length-1]=new rt(s.length+r):i.push(null,new rt(r-1))}if(e>0){let s=i[0];s instanceof rt?i[0]=new rt(e+s.length):i.unshift(new rt(e-1),null)}return gt.of(i)}decomposeLeft(e,t){t.push(new rt(e-1),null)}decomposeRight(e,t){t.push(null,new rt(this.length-e-1))}updateHeight(e,t=0,i=!1,r){let s=t+this.length;if(r&&r.from<=t+this.length&&r.more){let o=[],l=Math.max(t,r.from),a=-1,c=e.heightChanged;for(r.from>t&&o.push(new rt(r.from-t-1).updateHeight(e,t));l<=s&&r.more;){let h=e.doc.lineAt(l).length;o.length&&o.push(null);let d=r.heights[r.index++];a==-1?a=d:Math.abs(d-a)>=vs&&(a=-2);let m=new Tt(h,d);m.outdated=!1,o.push(m),l+=h+1}l<=s&&o.push(null,new rt(s-l).updateHeight(e,l));let u=gt.of(o);return e.heightChanged=c||a<0||Math.abs(u.height-this.height)>=vs||Math.abs(a-this.lines(e.doc,t).lineHeight)>=vs,u}else(i||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Aw extends gt{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,r){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,r):this.right.blockAt(e,t,s,r+this.left.length+this.break)}lineAt(e,t,i,r,s){let o=r+this.left.height,l=s+this.left.length+this.break,a=t==Fe.ByHeight?e<o:e<l,c=a?this.left.lineAt(e,t,i,r,s):this.right.lineAt(e,t,i,o,l);if(this.break||(a?c.to<l:c.from>l))return c;let u=t==Fe.ByPosNoHeight?Fe.ByPosNoHeight:Fe.ByPos;return a?c.join(this.right.lineAt(l,u,i,o,l)):this.left.lineAt(l,u,i,r,s).join(c)}forEachLine(e,t,i,r,s,o){let l=r+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,i,r,s,o),t>=a&&this.right.forEachLine(e,t,i,l,a,o);else{let c=this.lineAt(a,Fe.ByPos,i,r,s);e<c.from&&this.left.forEachLine(e,c.from-1,i,r,s,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,i,l,a,o)}}replace(e,t,i){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,i));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of i)s.push(l);if(e>0&&If(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),If(s,l)}return gt.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,r=i+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?gt.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,r){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return r&&r.from<=t+s.length&&r.more?a=s=s.updateHeight(e,t,i,r):s.updateHeight(e,t,i),r&&r.from<=l+o.length&&r.more?a=o=o.updateHeight(e,l,i,r):o.updateHeight(e,l,i),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function If(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof rt&&(i=n[e+1])instanceof rt&&n.splice(e-1,3,new rt(t.length+1+i.length))}const Ew=5;class fa{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Tt?r.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Tt(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let r=i.widget?i.widget.estimatedHeight:0;r<0&&(r=this.oracle.lineHeight);let s=t-e;i.block?this.addBlock(new Rf(s,r,i.type)):(s||r>=Ew)&&this.addLineDeco(r,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Tt(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new rt(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Tt)return e;let t=new Tt(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==Me.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=Me.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let i=this.ensureLine();i.length+=t,i.collapsed+=t,i.widgetHeight=Math.max(i.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Tt)&&!this.isCovered?this.nodes.push(new Tt(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let r of this.nodes)r instanceof Tt&&r.updateHeight(this.oracle,i),i+=r?r.length:1;return this.nodes}static build(e,t,i,r){let s=new fa(i,e);return ke.spans(t,i,r,s,0),s.finish(i)}}function Pw(n,e,t){let i=new Dw;return ke.compare(n,e,t,i,0),i.changes}class Dw{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,r){(e<t||i&&i.heightRelevant||r&&r.heightRelevant)&&Ql(e,t,this.changes,5)}}function Tw(n,e){let t=n.getBoundingClientRect(),i=Math.max(0,t.left),r=Math.min(innerWidth,t.right),s=Math.max(0,t.top),o=Math.min(innerHeight,t.bottom),l=n.ownerDocument.body;for(let a=n.parentNode;a&&a!=l;)if(a.nodeType==1){let c=a,u=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&u.overflow!="visible"){let h=c.getBoundingClientRect();i=Math.max(i,h.left),r=Math.min(r,h.right),s=Math.max(s,h.top),o=Math.min(o,h.bottom)}a=u.position=="absolute"||u.position=="fixed"?c.offsetParent:c.parentNode}else if(a.nodeType==11)a=a.host;else break;return{left:i-t.left,right:Math.max(i,r)-t.left,top:s-(t.top+e),bottom:Math.max(s,o)-(t.top+e)}}function Mw(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class da{constructor(e,t,i){this.from=e,this.to=t,this.size=i}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e){return te.replace({widget:new Fw(this.size,e)}).range(this.from,this.to)}}class Fw extends Jt{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Lf{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new Ff,this.scaler=jf,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.heightMap=gt.empty().applyChanges(e.facet(Qn),Ee.empty,this.heightOracle.setDoc(e.doc),[new Yt(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=te.set(this.lineGaps.map(t=>t.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let r=i?t.head:t.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new bs(s,o))}}this.viewports=e.sort((i,r)=>i.from-r.from),this.scaler=this.heightMap.height<=7e6?jf:new Iw(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:fr(e,this.scaler))})}update(e,t=null){let i=this.state;this.state=e.state;let r=this.state.facet(Qn),s=e.changedRanges,o=Yt.extendWithRanges(s,Pw(e.startState.facet(Qn),r,e?e.changes:Je.empty(this.state.doc.length))),l=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(r,i.doc,this.heightOracle.setDoc(this.state.doc),o),this.heightMap.height!=l&&(e.flags|=2);let a=o.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let c=!e.changes.empty||e.flags&2||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),c&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),r=this.heightOracle,s=i.whiteSpace,o=i.direction=="rtl"?xe.RTL:xe.LTR,l=this.heightOracle.mustRefreshForStyle(s,o),a=l||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight,c=0,u=0;if(this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=8),a){this.mustMeasureContent=!1,this.contentDOMHeight=t.clientHeight;let v=parseInt(i.paddingTop)||0,C=parseInt(i.paddingBottom)||0;(this.paddingTop!=v||this.paddingBottom!=C)&&(c|=8,this.paddingTop=v,this.paddingBottom=C)}let h=(this.printing?Mw:Tw)(t,this.paddingTop),d=h.top-this.pixelViewport.top,m=h.bottom-this.pixelViewport.bottom;this.pixelViewport=h;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(a=!0)),!this.inView)return 0;let y=t.clientWidth;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=y,this.editorHeight=e.scrollDOM.clientHeight,c|=8),a){let v=e.docView.measureVisibleLineHeights();if(r.mustRefreshForHeights(v)&&(l=!0),l||r.lineWrapping&&Math.abs(y-this.contentDOMWidth)>r.charWidth){let{lineHeight:C,charWidth:x}=e.docView.measureTextSize();l=r.refresh(s,o,C,x,y/x,v),l&&(e.docView.minWidth=0,c|=8)}d>0&&m>0?u=Math.max(d,m):d<0&&m<0&&(u=Math.min(d,m)),r.heightChanged=!1,this.heightMap=this.heightMap.updateHeight(r,0,l,new Bf(this.viewport.from,v)),r.heightChanged&&(c|=2)}let b=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return b&&(this.viewport=this.getViewport(u,this.scrollTarget)),this.updateForViewport(),(c&2||b)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(l?[]:this.lineGaps)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.state.doc,{visibleTop:o,visibleBottom:l}=this,a=new bs(r.lineAt(o-i*1e3,Fe.ByHeight,s,0,0).from,r.lineAt(l+(1-i)*1e3,Fe.ByHeight,s,0,0).to);if(t){let{head:c}=t.range;if(c<a.from||c>a.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=r.lineAt(c,Fe.ByPos,s,0,0),d;t.y=="center"?d=(h.top+h.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&c<a.from?d=h.top:d=h.bottom-u,a=new bs(r.lineAt(d-1e3/2,Fe.ByHeight,s,0,0).from,r.lineAt(d+u+1e3/2,Fe.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let i=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new bs(this.heightMap.lineAt(i,Fe.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(r,Fe.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Fe.ByPos,this.state.doc,0,0),{bottom:s}=this.heightMap.lineAt(t,Fe.ByPos,this.state.doc,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||r<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(i,250)))&&r>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let r of e)t.touchesRange(r.from,r.to)||i.push(new da(t.mapPos(r.from),t.mapPos(r.to),r.size));return i}ensureLineGaps(e){let t=[];if(this.heightOracle.direction!=xe.LTR)return t;for(let i of this.viewportLines){if(i.length<4e3)continue;let r=Bw(i.from,i.to,this.state);if(r.total<4e3)continue;let s,o;if(this.heightOracle.lineWrapping){let c=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;s=ws(r,(this.visibleTop-i.top-c)/i.height),o=ws(r,(this.visibleBottom-i.top+c)/i.height)}else{let c=r.total*this.heightOracle.charWidth,u=2e3*this.heightOracle.charWidth;s=ws(r,(this.pixelViewport.left-u)/c),o=ws(r,(this.pixelViewport.right+u)/c)}let l=[];s>i.from&&l.push({from:i.from,to:s}),o<i.to&&l.push({from:o,to:i.to});let a=this.state.selection.main;a.from>=i.from&&a.from<=i.to&&Wf(l,a.from-10,a.from+10),!a.empty&&a.to>=i.from&&a.to<=i.to&&Wf(l,a.to-10,a.to+10);for(let{from:c,to:u}of l)u-c>1e3&&t.push(Rw(e,h=>h.from>=i.from&&h.to<=i.to&&Math.abs(h.from-c)<1e3&&Math.abs(h.to-u)<1e3)||new da(c,u,this.gapSize(i,c,u,r)))}return t}gapSize(e,t,i,r){let s=Nf(r,i)-Nf(r,t);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){da.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=te.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.state.facet(Qn);this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];ke.spans(e,this.viewport.from,this.viewport.to,{span(r,s){t.push({from:r,to:s})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,s)=>r.from!=t[s].from||r.to!=t[s].to);return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||fr(this.heightMap.lineAt(e,Fe.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return fr(this.heightMap.lineAt(this.scaler.fromDOM(e),Fe.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return fr(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class bs{constructor(e,t){this.from=e,this.to=t}}function Bw(n,e,t){let i=[],r=n,s=0;return ke.spans(t.facet(Qn),n,e,{span(){},point(o,l){o>r&&(i.push({from:r,to:o}),s+=o-r),r=l}},20),r<e&&(i.push({from:r,to:e}),s+=e-r),{total:s,ranges:i}}function ws({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let r=0;;r++){let{from:s,to:o}=e[r],l=o-s;if(i<=l)return s+i;i-=l}}function Nf(n,e){let t=0;for(let{from:i,to:r}of n.ranges){if(e<=r){t+=e-i;break}t+=r-i}return t/n.total}function Wf(n,e,t){for(let i=0;i<n.length;i++){let r=n[i];if(r.from<t&&r.to>e){let s=[];r.from<e&&s.push({from:r.from,to:e}),r.to>t&&s.push({from:t,to:r.to}),n.splice(i,1,...s),i+=s.length-1}}}function Rw(n,e){for(let t of n)if(e(t))return t}const jf={toDOM(n){return n},fromDOM(n){return n},scale:1};class Iw{constructor(e,t,i){let r=0,s=0,o=0;this.viewports=i.map(({from:l,to:a})=>{let c=t.lineAt(l,Fe.ByPos,e,0,0).top,u=t.lineAt(a,Fe.ByPos,e,0,0).bottom;return r+=u-c,{from:l,to:a,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return r+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom,r=s.domBottom}}fromDOM(e){for(let t=0,i=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom,r=s.domBottom}}}function fr(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new mn(n.from,n.length,t,i-t,Array.isArray(n.type)?n.type.map(r=>fr(r,e)):n.type)}const xs=ne.define({combine:n=>n.join(" ")}),ma=ne.define({combine:n=>n.indexOf(!0)>-1}),pa=Dn.newName(),Vf=Dn.newName(),$f=Dn.newName(),Hf={"&light":"."+Vf,"&dark":"."+$f};function ga(n,e,t){return new Dn(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,r=>{if(r=="&")return n;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):n+" "+i}})}const Lw=ga("."+pa,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Hf),Nw={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ya=oe.ie&&oe.ie_version<=11;class Ww{constructor(e,t,i){this.view=e,this.onChange=t,this.onScrollChanged=i,this.active=!1,this.selectionRange=new Hb,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let s of r)this.queue.push(s);(oe.ie&&oe.ie_version<=11||oe.ios&&e.composing)&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),ya&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),typeof ResizeObserver=="function"&&(this.resize=new ResizeObserver(()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()}),this.resize.observe(e.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:t}=this,i=this.selectionRange;if(t.state.facet(cr)?t.root.activeElement!=this.dom:!$l(t.dom,i))return;let r=i.anchorNode&&t.docView.nearest(i.anchorNode);r&&r.ignoreEvent(e)||((oe.ie&&oe.ie_version<=11||oe.android&&oe.chrome)&&!t.state.selection.main.empty&&i.focusNode&&fs(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:e}=this.view,t=hs(e),i=oe.safari&&e.nodeType==11&&jb()==this.view.contentDOM&&jw(this.view)||t;return this.selectionRange.eq(i)?!1:(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Nw),ya&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!this.active||(this.active=!1,this.observer.disconnect(),ya&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){this.delayedAndroidKey||requestAnimationFrame(()=>{let i=this.delayedAndroidKey;this.delayedAndroidKey=null;let r=this.view.state;lr(this.view.contentDOM,i.key,i.keyCode)?this.processRecords():this.flush(),this.view.state==r&&this.view.update([])}),(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout(()=>{this.delayedFlush=-1,this.flush()},20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let e=this.queue;for(let s of this.observer.takeRecords())e.push(s);e.length&&(this.queue=[]);let t=-1,i=-1,r=!1;for(let s of e){let o=this.readMutation(s);!o||(o.typeOver&&(r=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:r}}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;e&&this.readSelectionRange();let{from:t,to:i,typeOver:r}=this.processRecords(),s=this.selectionChanged&&$l(this.dom,this.selectionRange);if(t<0&&!s)return;this.selectionChanged=!1;let o=this.view.state;this.onChange(t,i,r),this.view.state==o&&this.view.update([])}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let i=Uf(t,e.previousSibling||e.target.previousSibling,-1),r=Uf(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resize)===null||i===void 0||i.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function Uf(n,e,t){for(;e;){let i=$e.get(e);if(i&&i.parent==n)return i;let r=e.parentNode;e=r!=n.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function jw(n){let e=null;function t(a){a.preventDefault(),a.stopImmediatePropagation(),e=a.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let i=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=n.docView.domAtPos(n.state.selection.main.anchor);return fs(l.node,l.offset,s,o)&&([i,r,s,o]=[s,o,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o}}function Vw(n,e,t,i){let r,s,o=n.state.selection.main;if(e>-1){let l=n.docView.domBoundsAround(e,t,0);if(!l||n.state.readOnly)return;let{from:a,to:c}=l,u=n.docView.impreciseHead||n.docView.impreciseAnchor?[]:Hw(n),h=new nf(u,n.state);h.readRange(l.startDOM,l.endDOM);let d=o.from,m=null;(n.inputState.lastKeyCode===8&&n.inputState.lastKeyTime>Date.now()-100||oe.android&&h.text.length<c-a)&&(d=o.to,m="end");let p=$w(n.state.doc.sliceString(a,c,Rn),h.text,d-a,m);p&&(oe.chrome&&n.inputState.lastKeyCode==13&&p.toB==p.from+2&&h.text.slice(p.from,p.toB)==Rn+Rn&&p.toB--,r={from:a+p.from,to:a+p.toA,insert:Ee.of(h.text.slice(p.from,p.toB).split(Rn))}),s=Uw(u,a)}else if(n.hasFocus||!n.state.facet(cr)){let l=n.observer.selectionRange,{impreciseHead:a,impreciseAnchor:c}=n.docView,u=a&&a.node==l.focusNode&&a.offset==l.focusOffset||!wi(n.contentDOM,l.focusNode)?n.state.selection.main.head:n.docView.posFromDOM(l.focusNode,l.focusOffset),h=c&&c.node==l.anchorNode&&c.offset==l.anchorOffset||!wi(n.contentDOM,l.anchorNode)?n.state.selection.main.anchor:n.docView.posFromDOM(l.anchorNode,l.anchorOffset);(u!=o.head||h!=o.anchor)&&(s=T.single(h,u))}if(!(!r&&!s)){if(!r&&i&&!o.empty&&s&&s.main.empty?r={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4&&(r={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,r.from).append(r.insert).append(n.state.doc.slice(r.to,o.to))}),r){let l=n.state;if(oe.ios&&n.inputState.flushIOSKey(n)||oe.android&&(r.from==o.from&&r.to==o.to&&r.insert.length==1&&r.insert.lines==2&&lr(n.contentDOM,"Enter",13)||r.from==o.from-1&&r.to==o.to&&r.insert.length==0&&lr(n.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&r.insert.length==0&&lr(n.contentDOM,"Delete",46)))return;let a=r.insert.toString();if(n.state.facet(Zh).some(h=>h(n,r.from,r.to,a)))return;n.inputState.composing>=0&&n.inputState.composing++;let c;if(r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==r.from+r.insert.length)&&n.inputState.composing<0){let h=o.from<r.from?l.sliceDoc(o.from,r.from):"",d=o.to>r.to?l.sliceDoc(r.to,o.to):"";c=l.replaceSelection(n.state.toText(h+r.insert.sliceString(0,void 0,n.state.lineBreak)+d))}else{let h=l.changes(r),d=s&&!l.selection.main.eq(s.main)&&s.main.to<=h.newLength?s.main:void 0;if(l.selection.ranges.length>1&&n.inputState.composing>=0&&r.to<=o.to&&r.to>=o.to-10){let m=n.state.sliceDoc(r.from,r.to),p=af(n)||n.state.doc.lineAt(o.head),y=o.to-r.to,b=o.to-o.from;c=l.changeByRange(v=>{if(v.from==o.from&&v.to==o.to)return{changes:h,range:d||v.map(h)};let C=v.to-y,x=C-m.length;if(v.to-v.from!=b||n.state.sliceDoc(x,C)!=m||p&&v.to>=p.from&&v.from<=p.to)return{range:v};let k=l.changes({from:x,to:C,insert:r.insert}),w=v.to-o.to;return{changes:k,range:d?T.range(Math.max(0,d.anchor+w),Math.max(0,d.head+w)):v.map(k)}})}else c={changes:h,selection:d&&l.selection.replaceRange(d)}}let u="input.type";n.composing&&(u+=".compose",n.inputState.compositionFirstChange&&(u+=".start",n.inputState.compositionFirstChange=!1)),n.dispatch(c,{scrollIntoView:!0,userEvent:u})}else if(s&&!s.main.eq(o)){let l=!1,a="select";n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(l=!0),a=n.inputState.lastSelectionOrigin),n.dispatch({selection:s,scrollIntoView:l,userEvent:a})}}}function $w(n,e,t,i){let r=Math.min(n.length,e.length),s=0;for(;s<r&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&n.length==e.length)return null;let o=n.length,l=e.length;for(;o>0&&l>0&&n.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(i=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}return o<s&&n.length<e.length?(s-=t<=s&&t>=o?s-t:0,l=s+(l-o),o=s):l<s&&(s-=t<=s&&t>=l?s-t:0,o=s+(o-l),l=s),{from:s,toA:o,toB:l}}function Hw(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:r,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new sf(t,i)),(r!=t||s!=i)&&e.push(new sf(r,s))),e}function Uw(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?T.single(t+e,i+e):null}class _{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=e.root||Ub(e.parent)||document,this.viewState=new Lf(e.state||we.create()),this.plugins=this.state.facet(ur).map(t=>new ia(t));for(let t of this.plugins)t.update(this);this.observer=new Ww(this,(t,i,r)=>{Vw(this,t,i,r)},t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()}),this.inputState=new pw(this),this.docView=new of(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof Ye?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i,r=this.state;for(let o of e){if(o.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=o.state}if(this.destroyed){this.viewState.state=r;return}if(r.facet(we.phrases)!=this.state.facet(we.phrases))return this.setState(r);i=new Yh(this,r,e);let s=this.viewState.scrollTarget;try{this.updateState=2;for(let o of e){if(s&&(s=s.map(o.changes)),o.scrollIntoView){let{main:l}=o.state.selection;s=new Ci(l.empty?l:T.cursor(l.head,l.head>l.anchor?-1:1))}for(let l of o.effects)l.is(na)?s=new Ci(l.value):l.is(qh)?s=new Ci(l.value,"center"):l.is(Kh)&&(s=l.value)}this.viewState.update(i,s),this.bidiCache=Ss.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(hr)!=this.styleModules&&this.mountStyles(),this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(o=>o.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(xs)!=i.state.facet(xs)&&(this.viewState.mustMeasureContent=!0),(t||s||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!i.empty)for(let o of this.state.facet(ta))o(i)}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Lf(e),this.plugins=e.facet(ur).map(i=>new ia(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView=new of(this),this.inputState.ensureHandlers(this),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(ur),i=e.state.facet(ur);if(t!=i){let r=[];for(let s of i){let o=t.indexOf(s);if(o<0)r.push(new ia(s));else{let l=this.plugins[o];l.mustUpdate=e,r.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear(),this.inputState.ensureHandlers(this)}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.flush();let t=null;try{for(let i=0;;i++){this.updateState=1;let r=this.viewport,s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(i>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let o=[];s&4||([this.measureRequests,o]=[o,this.measureRequests]);let l=o.map(h=>{try{return h.read(this)}catch(d){return Dt(this.state,d),zf}}),a=new Yh(this,this.state),c=!1,u=!1;a.flags|=s,t?t.flags|=s:t=a,this.updateState=2,a.empty||(this.updatePlugins(a),this.inputState.update(a),this.updateAttrs(),c=this.docView.update(a));for(let h=0;h<o.length;h++)if(l[h]!=zf)try{let d=o[h];d.write&&d.write(l[h],this)}catch(d){Dt(this.state,d)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=!0),c&&this.docView.updateSelection(!0),this.viewport.from==r.from&&this.viewport.to==r.to&&!u&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let i of this.state.facet(ta))i(t)}get themeClasses(){return pa+" "+(this.state.facet(ma)?$f:Vf)+" "+this.state.facet(xs)}updateAttrs(){let e=Zf(this,Jh,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(cr)?"true":"false",class:"cm-content",style:`${oe.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Zf(this,ra,t),this.observer.ignore(()=>{_l(this.contentDOM,this.contentAttrs,t),_l(this.dom,this.editorAttrs,e)}),this.editorAttrs=e,this.contentAttrs=t}showAnnouncements(e){let t=!0;for(let i of e)for(let r of i.effects)if(r.is(_.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(hr),Dn.mount(this.root,this.styleModules.concat(Lw).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame(()=>this.measure())),e){if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}pluginField(e){let t=[];for(let i of this.plugins)i.update(this).takeField(e,t);return t}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}blockAtHeight(e,t){let i=va(t,this);return this.elementAtHeight(e-i).moveY(i)}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}visualLineAtHeight(e,t){let i=va(t,this);return this.lineBlockAtHeight(e-i).moveY(i)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}viewportLines(e,t){let i=va(t,this);for(let r of this.viewportLineBlocks)e(r.moveY(i))}get viewportLineBlocks(){return this.viewState.viewportLines}visualLineAt(e,t=0){return this.lineBlockAt(e).moveY(t+this.viewState.paddingTop)}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return ca(this,e,pf(this,e,t,i))}moveByGroup(e,t){return ca(this,e,pf(this,e,t,i=>dw(this,e.head,i)))}moveToLineBoundary(e,t,i=!0){return fw(this,e,t,i)}moveVertically(e,t,i){return ca(this,e,mw(this,e,t,i))}scrollPosIntoView(e){this.dispatch({effects:na.of(T.cursor(e))})}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),df(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[ki.find(s,e-r.from,-1,t)];return ms(i,o.dir==xe.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.heightOracle.direction}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>zw)return Qh(e.length);let t=this.textDirection;for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t)return r.order;let i=_h(e.text,this.textDirection);return this.bidiCache.push(new Ss(e.from,e.to,t,i)),i}get hasFocus(){var e;return(document.hasFocus()||oe.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Sh(this.contentDOM),this.docView.updateSelection()})}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Kh.of(new Ci(typeof e=="number"?T.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return Ue.define(()=>({}),{eventHandlers:e})}static theme(e,t){let i=Dn.newName(),r=[xs.of(i),hr.of(ga(`.${i}`,e))];return t&&t.dark&&r.push(ma.of(!0)),r}static baseTheme(e){return vi.lowest(hr.of(ga("."+pa,e,Hf)))}}_.scrollTo=na,_.centerOn=qh,_.styleModule=hr,_.inputHandler=Zh,_.exceptionSink=zh,_.updateListener=ta,_.editable=cr,_.mouseSelectionStyle=Uh,_.dragMovesSelection=Hh,_.clickAddsSelectionRange=$h,_.decorations=Qn,_.darkTheme=ma,_.contentAttributes=ra,_.editorAttributes=Jh,_.lineWrapping=_.contentAttributes.of({class:"cm-lineWrapping"}),_.announce=ue.define();const zw=4096;function va(n,e){return(n==null?e.contentDOM.getBoundingClientRect().top:n)+e.viewState.paddingTop}const zf={};class Ss{constructor(e,t,i,r){this.from=e,this.to=t,this.dir=i,this.order=r}static update(e,t){if(t.empty)return e;let i=[],r=e.length?e[e.length-1].dir:xe.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!t.touchesRange(o.from,o.to)&&i.push(new Ss(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.order))}return i}}function Zf(n,e,t){for(let i=n.state.facet(e),r=i.length-1;r>=0;r--){let s=i[r],o=typeof s=="function"?s(n):s;o&&Yl(o,t)}return t}const Zw=oe.mac?"mac":oe.windows?"win":oe.linux?"linux":"key";function qw(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let r,s,o,l;for(let a=0;a<t.length-1;++a){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(i="Alt-"+i),s&&(i="Ctrl-"+i),l&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function ba(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const Kw=_.domEventHandlers({keydown(n,e){return Gf(Kf(e.state),n,e,"editor")}}),dr=ne.define({enables:Kw}),qf=new WeakMap;function Kf(n){let e=n.facet(dr),t=qf.get(e);return t||qf.set(e,t=Yw(e.reduce((i,r)=>i.concat(r),[]))),t}function Gw(n,e,t){return Gf(Kf(n.state),e,n,t)}let In=null;const Jw=4e3;function Yw(n,e=Zw){let t=Object.create(null),i=Object.create(null),r=(o,l)=>{let a=i[o];if(a==null)i[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,c)=>{let u=t[o]||(t[o]=Object.create(null)),h=l.split(/ (?!$)/).map(p=>qw(p,e));for(let p=1;p<h.length;p++){let y=h.slice(0,p).join(" ");r(y,!0),u[y]||(u[y]={preventDefault:!0,commands:[b=>{let v=In={view:b,prefix:y,scope:o};return setTimeout(()=>{In==v&&(In=null)},Jw),!0}]})}let d=h.join(" ");r(d,!1);let m=u[d]||(u[d]={preventDefault:!1,commands:[]});m.commands.push(a),c&&(m.preventDefault=!0)};for(let o of n){let l=o[e]||o.key;if(!!l)for(let a of o.scope?o.scope.split(" "):["editor"])s(a,l,o.run,o.preventDefault),o.shift&&s(a,"Shift-"+l,o.shift,o.preventDefault)}return t}function Gf(n,e,t,i){let r=Wb(e),s=r.length==1&&r!=" ",o="",l=!1;In&&In.view==t&&In.scope==i&&(o=In.prefix+" ",(l=yf.indexOf(e.keyCode)<0)&&(In=null));let a=h=>{if(h){for(let d of h.commands)if(d(t))return!0;h.preventDefault&&(l=!0)}return!1},c=n[i],u;if(c){if(a(c[o+ba(r,e,!s)]))return!0;if(s&&(e.shiftKey||e.altKey||e.metaKey)&&(u=Mn[e.keyCode])&&u!=r){if(a(c[o+ba(u,e,!0)]))return!0}else if(s&&e.shiftKey&&a(c[o+ba(r,e,!0)]))return!0}return l}const Jf=!oe.ios,mr=ne.define({combine(n){return dn(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function Xw(n={}){return[mr.of(n),_w,Qw]}class Yf{constructor(e,t,i,r,s){this.left=e,this.top=t,this.width=i,this.height=r,this.className=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}const _w=Ue.fromClass(class{constructor(n){this.view=n,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=n.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=n.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),n.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(mr).cursorBlinkRate+"ms"}update(n){let e=n.startState.facet(mr)!=n.state.facet(mr);(e||n.selectionSet||n.geometryChanged||n.viewportChanged)&&this.view.requestMeasure(this.measureReq),n.transactions.some(t=>t.scrollIntoView)&&(this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),e&&this.setBlinkRate()}readPos(){let{state:n}=this.view,e=n.facet(mr),t=n.selection.ranges.map(r=>r.empty?[]:e1(this.view,r)).reduce((r,s)=>r.concat(s)),i=[];for(let r of n.selection.ranges){let s=r==n.selection.main;if(r.empty?!s||Jf:e.drawRangeCursor){let o=t1(this.view,r,s);o&&i.push(o)}}return{rangePieces:t,cursors:i}}drawSel({rangePieces:n,cursors:e}){if(n.length!=this.rangePieces.length||n.some((t,i)=>!t.eq(this.rangePieces[i]))){this.selectionLayer.textContent="";for(let t of n)this.selectionLayer.appendChild(t.draw());this.rangePieces=n}if(e.length!=this.cursors.length||e.some((t,i)=>!t.eq(this.cursors[i]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const i of e)this.cursorLayer.appendChild(i.draw())}else e.forEach((i,r)=>i.adjust(t[r]));this.cursors=e}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),Xf={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Jf&&(Xf[".cm-line"].caretColor="transparent !important");const Qw=vi.highest(_.theme(Xf));function _f(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==xe.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function Qf(n,e,t){let i=T.cursor(e);return{from:Math.max(t.from,n.moveToLineBoundary(i,!1,!0).from),to:Math.min(t.to,n.moveToLineBoundary(i,!0,!0).from),type:Me.Text}}function ed(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let i of t.type)if(i.to>e||i.to==e&&(i.to==t.to||i.type==Me.Text))return i}return t}function e1(n,e){if(e.to<=n.viewport.from||e.from>=n.viewport.to)return[];let t=Math.max(e.from,n.viewport.from),i=Math.min(e.to,n.viewport.to),r=n.textDirection==xe.LTR,s=n.contentDOM,o=s.getBoundingClientRect(),l=_f(n),a=window.getComputedStyle(s.firstChild),c=o.left+parseInt(a.paddingLeft)+Math.min(0,parseInt(a.textIndent)),u=o.right-parseInt(a.paddingRight),h=ed(n,t),d=ed(n,i),m=h.type==Me.Text?h:null,p=d.type==Me.Text?d:null;if(n.lineWrapping&&(m&&(m=Qf(n,t,m)),p&&(p=Qf(n,i,p))),m&&p&&m.from==p.from)return b(v(e.from,e.to,m));{let x=m?v(e.from,null,m):C(h,!1),k=p?v(null,e.to,p):C(d,!0),w=[];return(m||h).to<(p||d).from-1?w.push(y(c,x.bottom,u,k.top)):x.bottom<k.top&&n.elementAtHeight((x.bottom+k.top)/2).type==Me.Text&&(x.bottom=k.top=(x.bottom+k.top)/2),b(x).concat(w).concat(b(k))}function y(x,k,w,O){return new Yf(x-l.left,k-l.top-.01,w-x,O-k+.01,"cm-selectionBackground")}function b({top:x,bottom:k,horizontal:w}){let O=[];for(let F=0;F<w.length;F+=2)O.push(y(w[F],x,w[F+1],k));return O}function v(x,k,w){let O=1e9,F=-1e9,P=[];function B(Q,he,Ce,ae,de){let ve=n.coordsAtPos(Q,Q==w.to?-2:2),Te=n.coordsAtPos(Ce,Ce==w.from?2:-2);O=Math.min(ve.top,Te.top,O),F=Math.max(ve.bottom,Te.bottom,F),de==xe.LTR?P.push(r&&he?c:ve.left,r&&ae?u:Te.right):P.push(!r&&ae?c:Te.left,!r&&he?u:ve.right)}let N=x!=null?x:w.from,G=k!=null?k:w.to;for(let Q of n.visibleRanges)if(Q.to>N&&Q.from<G)for(let he=Math.max(Q.from,N),Ce=Math.min(Q.to,G);;){let ae=n.state.doc.lineAt(he);for(let de of n.bidiSpans(ae)){let ve=de.from+ae.from,Te=de.to+ae.from;if(ve>=Ce)break;Te>he&&B(Math.max(ve,he),x==null&&ve<=N,Math.min(Te,Ce),k==null&&Te>=G,de.dir)}if(he=ae.to+1,he>=Ce)break}return P.length==0&&B(N,x==null,G,k==null,n.textDirection),{top:O,bottom:F,horizontal:P}}function C(x,k){let w=o.top+(k?x.top:x.bottom);return{top:w,bottom:w,horizontal:[]}}}function t1(n,e,t){let i=n.coordsAtPos(e.head,e.assoc||1);if(!i)return null;let r=_f(n);return new Yf(i.left-r.left,i.top-r.top,-1,i.bottom-i.top,t?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const td=ue.define({map(n,e){return n==null?null:e.mapPos(n)}}),pr=qe.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(td)?i.value:t,n)}}),n1=Ue.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(pr);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(pr)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let n=this.view.state.field(pr),e=n!=null&&this.view.coordsAtPos(n);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(pr)!=n&&this.view.dispatch({effects:td.of(n)})}},{eventHandlers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function i1(){return[pr,n1]}function nd(n,e,t,i,r){e.lastIndex=0;for(let s=n.iterRange(t,i),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)r(o+l.index,o+l.index+l[0].length,l)}function r1(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:r,to:s}of t)r=Math.max(n.state.doc.lineAt(r).from,r-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class s1{constructor(e){let{regexp:t,decoration:i,boundary:r,maxLength:s=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=t,this.getDeco=typeof i=="function"?i:()=>i,this.boundary=r,this.maxLength=s}createDeco(e){let t=new Tn;for(let{from:i,to:r}of r1(e,this.maxLength))nd(e.state.doc,this.regexp,i,r,(s,o,l)=>t.add(s,o,this.getDeco(l,e,s)));return t.finish()}updateDeco(e,t){let i=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>e.view.viewport.from&&l<e.view.viewport.to&&(i=Math.min(l,i),r=Math.max(a,r))}),e.viewportChanged||r-i>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),i,r):t}updateRange(e,t,i,r){for(let s of e.visibleRanges){let o=Math.max(s.from,i),l=Math.min(s.to,r);if(l>o){let a=e.state.doc.lineAt(o),c=a.to<l?e.state.doc.lineAt(l):a,u=Math.max(s.from,a.from),h=Math.min(s.to,c.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){u=o;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){h=l;break}}let d=[],m;if(a==c)for(this.regexp.lastIndex=u-a.from;(m=this.regexp.exec(a.text))&&m.index<h-a.from;){let p=m.index+a.from;d.push(this.getDeco(m,e,p).range(p,p+m[0].length))}else nd(e.state.doc,this.regexp,u,h,(p,y,b)=>d.push(this.getDeco(b,e,p).range(p,y)));t=t.update({filterFrom:u,filterTo:h,filter:(p,y)=>p<u||y>h,add:d})}}return t}}const wa=/x/.unicode!=null?"gu":"g",o1=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\uFEFF\uFFF9-\uFFFC]`,wa),l1={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let xa=null;function a1(){var n;if(xa==null&&typeof document!="undefined"&&document.body){let e=document.body.style;xa=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return xa||!1}const Cs=ne.define({combine(n){let e=dn(n,{render:null,specialChars:o1,addSpecialChars:null});return(e.replaceTabs=!a1())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,wa)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,wa)),e}});function c1(n={}){return[Cs.of(n),u1()]}let id=null;function u1(){return id||(id=Ue.fromClass(class{constructor(n){this.view=n,this.decorations=te.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(Cs)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new s1({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:r}=t.state,s=ot(e[0],0);if(s==9){let o=r.lineAt(i),l=t.state.tabSize,a=er(o.text,l,i-o.from);return te.replace({widget:new m1((l-a%l)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=te.replace({widget:new d1(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(Cs);n.startState.facet(Cs)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const h1="\u2022";function f1(n){return n>=32?h1:n==10?"\u2424":String.fromCharCode(9216+n)}class d1 extends Jt{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=f1(this.code),i=e.state.phrase("Control character")+" "+(l1[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,i,t);if(r)return r;let s=document.createElement("span");return s.textContent=t,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class m1 extends Jt{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const rd=null;function OO(){return[rd,ra.of(n=>{var e;return((e=n.plugin(rd))===null||e===void 0?void 0:e.attrs)||null})]}function p1(){return y1}const g1=te.line({class:"cm-activeLine"}),y1=Ue.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){if(!i.empty)return te.none;let r=n.lineBlockAt(i.head);r.from>e&&(t.push(g1.range(r.from)),e=r.from)}return te.set(t)}},{decorations:n=>n.decorations});class v1 extends Jt{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}ignoreEvent(){return!1}}function b1(n){return Ue.fromClass(class{constructor(e){this.view=e,this.placeholder=te.set([te.widget({widget:new v1(n),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?te.none:this.placeholder}},{decorations:e=>e.decorations})}const AO={HeightMap:gt,HeightOracle:Ff,MeasuredHeights:Bf,QueryType:Fe,ChangedRange:Yt,computeOrder:_h,moveVisually:tf},Sa=ne.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function EO(n){return n?[Sa.of(n)]:[]}function gr(n,e){let t=n.plugin(sd),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const sd=Ue.fromClass(class{constructor(n){this.input=n.state.facet(Oi),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(Sa);this.top=new ks(n,!0,e.topContainer),this.bottom=new ks(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(Sa);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new ks(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new ks(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Oi);if(t!=this.input){let i=t.filter(a=>a),r=[],s=[],o=[],l=[];for(let a of i){let c=this.specs.indexOf(a),u;c<0?(u=a(n.view),l.push(u)):(u=this.panels[c],u.update&&u.update(n)),r.push(u),(u.top?s:o).push(u)}this.specs=i,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:lt.scrollMargins.from(n=>({top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}))});class ks{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=od(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=od(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function od(n){let e=n.nextSibling;return n.remove(),e}const w1=_.baseTheme({".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"}}),Oi=ne.define({enables:[sd,w1]}),x1=1024;let S1=0;class Lt{constructor(e,t){this.from=e,this.to=t}}class ge{constructor(e={}){this.id=S1++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=at.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}ge.closedBy=new ge({deserialize:n=>n.split(" ")}),ge.openedBy=new ge({deserialize:n=>n.split(" ")}),ge.group=new ge({deserialize:n=>n.split(" ")}),ge.contextHash=new ge({perNode:!0}),ge.lookAhead=new ge({perNode:!0}),ge.mounted=new ge({perNode:!0});class C1{constructor(e,t,i){this.tree=e,this.overlay=t,this.parser=i}}const k1=Object.create(null);class at{constructor(e,t,i,r=0){this.name=e,this.props=t,this.id=i,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):k1,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new at(e.name||"",t,e.id,i);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(ge.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let r of i.split(" "))t[r]=e[i];return i=>{for(let r=i.prop(ge.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?i.name:r[s]];if(o)return o}}}}at.none=new at("",Object.create(null),0,8);class Ca{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let r=null;for(let s of e){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}t.push(r?new at(i.name,r,i.id,i.flags):i)}return new Ca(t)}}const Os=new WeakMap,ld=new WeakMap;class Be{constructor(e,t,i,r,s){if(this.type=e,this.children=t,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=this.prop(ge.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let r=i.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e,t=0){let i=e!=null&&Os.get(this)||this.topNode,r=new yr(i);return e!=null&&(r.moveTo(e,t),Os.set(this,r._tree)),r}fullCursor(){return new yr(this.topNode,1)}get topNode(){return new _t(this,0,0,null)}resolve(e,t=0){let i=Ai(Os.get(this)||this.topNode,e,t,!1);return Os.set(this,i),i}resolveInner(e,t=0){let i=Ai(ld.get(this)||this.topNode,e,t,!0);return ld.set(this,i),i}iterate(e){let{enter:t,leave:i,from:r=0,to:s=this.length}=e;for(let o=this.cursor(),l=()=>o.node;;){let a=!1;if(o.from<=s&&o.to>=r&&(o.type.isAnonymous||t(o.type,o.from,o.to,l)!==!1)){if(o.firstChild())continue;o.type.isAnonymous||(a=!0)}for(;a&&i&&i(o.type,o.from,o.to,l),a=o.type.isAnonymous,!o.nextSibling();){if(!o.parent())return;a=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Aa(at.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,r)=>new Be(this.type,t,i,r,this.propValues),e.makeTree||((t,i,r)=>new Be(at.none,t,i,r)))}static build(e){return A1(e)}}Be.empty=new Be(at.none,[],[],0);class ka{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new ka(this.buffer,this.index)}}class ei{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return at.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,i==e)return s;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,i,r,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(ad(s,r,o[a+1],o[a+2])&&(l=a,i>0));a=o[a+3]);return l}slice(e,t,i,r){let s=this.buffer,o=new Uint16Array(t-e);for(let l=e,a=0;l<t;)o[a++]=s[l++],o[a++]=s[l++]-i,o[a++]=s[l++]-i,o[a++]=s[l++]-e;return new ei(o,r-i,this.set)}}function ad(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function cd(n,e){let t=n.childBefore(e);for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}function Ai(n,e,t,i){for(var r;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let s=!i&&n instanceof _t&&n.index<0?null:n.parent;if(!s)return n;n=s}if(i)for(let s=n,o=s.parent;o;s=o,o=s.parent)s instanceof _t&&s.index<0&&((r=o.enter(e,t,!0))===null||r===void 0?void 0:r.from)!=s.from&&(n=o);for(;;){let s=n.enter(e,t,i);if(!s)return n;n=s}}class _t{constructor(e,t,i,r){this.node=e,this._from=t,this.index=i,this._parent=r}get type(){return this.node.type}get name(){return this.node.type.name}get from(){return this._from}get to(){return this._from+this.node.length}nextChild(e,t,i,r,s=0){for(let o=this;;){for(let{children:l,positions:a}=o.node,c=t>0?l.length:-1;e!=c;e+=t){let u=l[e],h=a[e]+o._from;if(!!ad(r,i,h,h+u.length)){if(u instanceof ei){if(s&2)continue;let d=u.findChild(0,u.buffer.length,t,i-h,r);if(d>-1)return new Ln(new O1(o,u,e,h),null,d)}else if(s&1||!u.type.isAnonymous||Oa(u)){let d;if(!(s&1)&&u.props&&(d=u.prop(ge.mounted))&&!d.overlay)return new _t(d.tree,h,e,o);let m=new _t(u,h,e,o);return s&1||!m.type.isAnonymous?m:m.nextChild(t<0?u.children.length-1:0,t,i,r)}}}if(s&1||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent.node.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this.node.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this.node.children.length-1,-1,e,-2)}enter(e,t,i=!0,r=!0){let s;if(i&&(s=this.node.prop(ge.mounted))&&s.overlay){let o=e-this.from;for(let{from:l,to:a}of s.overlay)if((t>0?l<=o:l<o)&&(t<0?a>=o:a>o))return new _t(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r?0:2)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get cursor(){return new yr(this)}get tree(){return this.node}toTree(){return this.node}resolve(e,t=0){return Ai(this,e,t,!1)}resolveInner(e,t=0){return Ai(this,e,t,!0)}enterUnfinishedNodesBefore(e){return cd(this,e)}getChild(e,t=null,i=null){let r=As(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return As(this,e,t,i)}toString(){return this.node.toString()}}function As(n,e,t,i){let r=n.cursor,s=[];if(!r.firstChild())return s;if(t!=null){for(;!r.type.is(t);)if(!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}class O1{constructor(e,t,i,r){this.parent=e,this.buffer=t,this.index=i,this.start=r}}class Ln{constructor(e,t,i){this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new Ln(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i,r=!0){if(!r)return null;let{buffer:s}=this.context,o=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return o<0?null:new Ln(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Ln(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Ln(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get cursor(){return new yr(this)}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1],l=i.buffer[this.index+2];e.push(i.slice(r,s,o,l)),t.push(0)}return new Be(this.type,e,t,this.to-this.from)}resolve(e,t=0){return Ai(this,e,t,!1)}resolveInner(e,t=0){return Ai(this,e,t,!0)}enterUnfinishedNodesBefore(e){return cd(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let r=As(this,e,t,i);return r.length?r[0]:null}getChildren(e,t=null,i=null){return As(this,e,t,i)}}class yr{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof _t)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=i+r.buffer[e+1],this.to=i+r.buffer[e+2],!0}yield(e){return e?e instanceof _t?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree.node.children.length-1:0,e,t,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=!0,r=!0){return this.buffer?r?this.enterChild(1,e,t):!1:this.yield(this._tree.enter(e,t,i&&!(this.mode&1),r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&1?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&1?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:i}=r)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let s=t+e,o=e<0?-1:i.node.children.length;s!=o;s+=e){let l=i.node.children[s];if(this.mode&1||l instanceof ei||!l.type.isAnonymous||Oa(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer){e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,i=s+1;break e}r=this.stack[--s]}}for(let r=i;r<this.stack.length;r++)t=new Ln(this.buffer,t,this.stack[r]);return this.bufferNode=new Ln(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree.node}}function Oa(n){return n.children.some(e=>e instanceof ei||!e.type.isAnonymous||Oa(e))}function A1(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:r=x1,reused:s=[],minRepeatType:o=i.types.length}=n,l=Array.isArray(t)?new ka(t,t.length):t,a=i.types,c=0,u=0;function h(k,w,O,F,P){let{id:B,start:N,end:G,size:Q}=l,he=u;for(;Q<0;)if(l.next(),Q==-1){let Te=s[B];O.push(Te),F.push(N-k);return}else if(Q==-3){c=B;return}else if(Q==-4){u=B;return}else throw new RangeError(`Unrecognized record size: ${Q}`);let Ce=a[B],ae,de,ve=N-k;if(G-N<=r&&(de=y(l.pos-w,P))){let Te=new Uint16Array(de.size-de.skip),Ze=l.pos-de.size,_e=Te.length;for(;l.pos>Ze;)_e=b(de.start,Te,_e);ae=new ei(Te,G-de.start,i),ve=de.start-k}else{let Te=l.pos-Q;l.next();let Ze=[],_e=[],kt=B>=o?B:-1,Vt=0,cn=G;for(;l.pos>Te;)kt>=0&&l.id==kt&&l.size>=0?(l.end<=cn-r&&(m(Ze,_e,N,Vt,l.end,cn,kt,he),Vt=Ze.length,cn=l.end),l.next()):h(N,Te,Ze,_e,kt);if(kt>=0&&Vt>0&&Vt<Ze.length&&m(Ze,_e,N,Vt,N,cn,kt,he),Ze.reverse(),_e.reverse(),kt>-1&&Vt>0){let mo=d(Ce);ae=Aa(Ce,Ze,_e,0,Ze.length,0,G-N,mo,mo)}else ae=p(Ce,Ze,_e,G-N,he-G)}O.push(ae),F.push(ve)}function d(k){return(w,O,F)=>{let P=0,B=w.length-1,N,G;if(B>=0&&(N=w[B])instanceof Be){if(!B&&N.type==k&&N.length==F)return N;(G=N.prop(ge.lookAhead))&&(P=O[B]+N.length+G)}return p(k,w,O,F,P)}}function m(k,w,O,F,P,B,N,G){let Q=[],he=[];for(;k.length>F;)Q.push(k.pop()),he.push(w.pop()+O-P);k.push(p(i.types[N],Q,he,B-P,G-B)),w.push(P-O)}function p(k,w,O,F,P=0,B){if(c){let N=[ge.contextHash,c];B=B?[N].concat(B):[N]}if(P>25){let N=[ge.lookAhead,P];B=B?[N].concat(B):[N]}return new Be(k,w,O,F,B)}function y(k,w){let O=l.fork(),F=0,P=0,B=0,N=O.end-r,G={size:0,start:0,skip:0};e:for(let Q=O.pos-k;O.pos>Q;){let he=O.size;if(O.id==w&&he>=0){G.size=F,G.start=P,G.skip=B,B+=4,F+=4,O.next();continue}let Ce=O.pos-he;if(he<0||Ce<Q||O.start<N)break;let ae=O.id>=o?4:0,de=O.start;for(O.next();O.pos>Ce;){if(O.size<0)if(O.size==-3)ae+=4;else break e;else O.id>=o&&(ae+=4);O.next()}P=de,F+=he,B+=ae}return(w<0||F==k)&&(G.size=F,G.start=P,G.skip=B),G.size>4?G:void 0}function b(k,w,O){let{id:F,start:P,end:B,size:N}=l;if(l.next(),N>=0&&F<o){let G=O;if(N>4){let Q=l.pos-(N-4);for(;l.pos>Q;)O=b(k,w,O)}w[--O]=G,w[--O]=B-k,w[--O]=P-k,w[--O]=F}else N==-3?c=F:N==-4&&(u=F);return O}let v=[],C=[];for(;l.pos>0;)h(n.start||0,n.bufferStart||0,v,C,-1);let x=(e=n.length)!==null&&e!==void 0?e:v.length?C[0]+v[0].length:0;return new Be(a[n.topID],v.reverse(),C.reverse(),x)}const ud=new WeakMap;function Es(n,e){if(!n.isAnonymous||e instanceof ei||e.type!=n)return 1;let t=ud.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof Be)){t=1;break}t+=Es(n,i)}ud.set(e,t)}return t}function Aa(n,e,t,i,r,s,o,l,a){let c=0;for(let p=i;p<r;p++)c+=Es(n,e[p]);let u=Math.ceil(c*1.5/8),h=[],d=[];function m(p,y,b,v,C){for(let x=b;x<v;){let k=x,w=y[x],O=Es(n,p[x]);for(x++;x<v;x++){let F=Es(n,p[x]);if(O+F>=u)break;O+=F}if(x==k+1){if(O>u){let F=p[k];m(F.children,F.positions,0,F.children.length,y[k]+C);continue}h.push(p[k])}else{let F=y[x-1]+p[x-1].length-w;h.push(Aa(n,p,y,k,x,w,F,null,a))}d.push(w+C-s)}}return m(e,t,i,r,0),(l||a)(h,d,o)}class pn{constructor(e,t,i,r,s=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let r=[new pn(0,e.length,e,0,!1,i)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e,t,i=128){if(!t.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,c=0;;l++){let u=l<t.length?t[l]:null,h=u?u.fromA:1e9;if(h-a>=i)for(;o&&o.from<h;){let d=o;if(a>=d.from||h<=d.to||c){let m=Math.max(d.from,a)-c,p=Math.min(d.to,h)-c;d=m>=p?null:new pn(m,p,d.tree,d.offset+c,l>0,!!u)}if(d&&r.push(d),o.to>h)break;o=s<e.length?e[s++]:null}if(!u)break;a=u.toA,c=u.toA-u.toB}return r}}class hd{startParse(e,t,i){return typeof e=="string"&&(e=new E1(e)),i=i?i.length?i.map(r=>new Lt(r.from,r.to)):[new Lt(0,0)]:[new Lt(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let r=this.startParse(e,t,i);for(;;){let s=r.advance();if(s)return s}}}class E1{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function PO(n){return(e,t,i,r)=>new D1(e,n,t,i,r)}class fd{constructor(e,t,i,r,s){this.parser=e,this.parse=t,this.overlay=i,this.target=r,this.ranges=s}}class P1{constructor(e,t,i,r,s,o,l){this.parser=e,this.predicate=t,this.mounts=i,this.index=r,this.start=s,this.target=o,this.prev=l,this.depth=0,this.ranges=[]}}const Ea=new ge({perNode:!0});class D1{constructor(e,t,i,r,s){this.nest=t,this.input=i,this.fragments=r,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let r of this.inner)r.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new Be(i.type,i.children,i.positions,i.length,i.propValues.concat([[Ea,this.stoppedAt]]))),i}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let i=Object.assign(Object.create(null),e.target.props);i[ge.mounted.id]=new C1(t,e.overlay,e.parser),e.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].ranges[0].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new F1(this.fragments),t=null,i=null,r=new yr(new _t(this.baseTree,this.ranges[0].from,0,null),1);e:for(let s,o;this.stoppedAt==null||r.from<this.stoppedAt;){let l=!0,a;if(e.hasNode(r)){if(t){let c=t.mounts.find(u=>u.frag.from<=r.from&&u.frag.to>=r.to&&u.mount.overlay);if(c)for(let u of c.mount.overlay){let h=u.from+c.pos,d=u.to+c.pos;h>=r.from&&d<=r.to&&!t.ranges.some(m=>m.from<d&&m.to>h)&&t.ranges.push({from:h,to:d})}}l=!1}else if(i&&(o=T1(i.ranges,r.from,r.to)))l=o!=2;else if(!r.type.isAnonymous&&r.from<r.to&&(s=this.nest(r,this.input))){r.tree||M1(r);let c=e.findMounts(r.from,s.parser);if(typeof s.overlay=="function")t=new P1(s.parser,s.overlay,c,this.inner.length,r.from,r.tree,t);else{let u=pd(this.ranges,s.overlay||[new Lt(r.from,r.to)]);u.length&&this.inner.push(new fd(s.parser,s.parser.startParse(this.input,gd(c,u),u),s.overlay?s.overlay.map(h=>new Lt(h.from-r.from,h.to-r.from)):null,r.tree,u)),s.overlay?u.length&&(i={ranges:u,depth:0,prev:i}):l=!1}}else t&&(a=t.predicate(r))&&(a===!0&&(a=new Lt(r.from,r.to)),a.from<a.to&&t.ranges.push(a));if(l&&r.firstChild())t&&t.depth++,i&&i.depth++;else for(;!r.nextSibling();){if(!r.parent())break e;if(t&&!--t.depth){let c=pd(this.ranges,t.ranges);c.length&&this.inner.splice(t.index,0,new fd(t.parser,t.parser.startParse(this.input,gd(t.mounts,c),c),t.ranges.map(u=>new Lt(u.from-t.start,u.to-t.start)),t.target,c)),t=t.prev}i&&!--i.depth&&(i=i.prev)}}}}function T1(n,e,t){for(let i of n){if(i.from>=t)break;if(i.to>e)return i.from<=e&&i.to>=t?2:1}return 0}function dd(n,e,t,i,r,s){if(e<t){let o=n.buffer[e+1],l=n.buffer[t-2];i.push(n.slice(e,t,o,l)),r.push(o-s)}}function M1(n){let{node:e}=n,t=0;do n.parent(),t++;while(!n.tree);let i=0,r=n.tree,s=0;for(;s=r.positions[i]+n.from,!(s<=e.from&&s+r.children[i].length>=e.to);i++);let o=r.children[i],l=o.buffer;function a(c,u,h,d,m){let p=c;for(;l[p+2]+s<=e.from;)p=l[p+3];let y=[],b=[];dd(o,c,p,y,b,d);let v=l[p+1],C=l[p+2],x=v+s==e.from&&C+s==e.to&&l[p]==e.type.id;return y.push(x?e.toTree():a(p+4,l[p+3],o.set.types[l[p]],v,C-v)),b.push(v-d),dd(o,l[p+3],u,y,b,d),new Be(h,y,b,m)}r.children[i]=a(0,l.length,at.none,0,o.length);for(let c=0;c<=t;c++)n.childAfter(e.from)}class md{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.fullCursor()}moveTo(e){let{cursor:t}=this,i=e-this.offset;for(;!this.done&&t.from<i;)t.to>=e&&t.enter(i,1,!1,!1)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof Be)t=t.children[0];else break}return!1}}class F1{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let i=this.curFrag=e[0];this.curTo=(t=i.tree.prop(Ea))!==null&&t!==void 0?t:i.to,this.inner=new md(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(Ea))!==null&&e!==void 0?e:t.to,this.inner=new md(t.tree,-t.offset)}}findMounts(e,t){var i;let r=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node;s;s=s.parent){let o=(i=s.tree)===null||i===void 0?void 0:i.prop(ge.mounted);if(o&&o.parser==t)for(let l=this.fragI;l<this.fragments.length;l++){let a=this.fragments[l];if(a.from>=s.to)break;a.tree==this.curFrag.tree&&r.push({frag:a,pos:s.from-a.offset,mount:o})}}}return r}}function pd(n,e){let t=null,i=e;for(let r=1,s=0;r<n.length;r++){let o=n[r-1].to,l=n[r].from;for(;s<i.length;s++){let a=i[s];if(a.from>=l)break;a.to<=o||(t||(i=t=e.slice()),a.from<o?(t[s]=new Lt(a.from,o),a.to>l&&t.splice(s+1,0,new Lt(l,a.to))):a.to>l?t[s--]=new Lt(l,a.to):t.splice(s--,1))}}return i}function B1(n,e,t,i){let r=0,s=0,o=!1,l=!1,a=-1e9,c=[];for(;;){let u=r==n.length?1e9:o?n[r].to:n[r].from,h=s==e.length?1e9:l?e[s].to:e[s].from;if(o!=l){let d=Math.max(a,t),m=Math.min(u,h,i);d<m&&c.push(new Lt(d,m))}if(a=Math.min(u,h),a==1e9)break;u==a&&(o?(o=!1,r++):o=!0),h==a&&(l?(l=!1,s++):l=!0)}return c}function gd(n,e){let t=[];for(let{pos:i,mount:r,frag:s}of n){let o=i+(r.overlay?r.overlay[0].from:0),l=o+r.tree.length,a=Math.max(s.from,o),c=Math.min(s.to,l);if(r.overlay){let u=r.overlay.map(d=>new Lt(d.from+i,d.to+i)),h=B1(e,u,a,c);for(let d=0,m=a;;d++){let p=d==h.length,y=p?c:h[d].from;if(y>m&&t.push(new pn(m,y,r.tree,-o,s.from>=m,s.to<=y)),p)break;m=h[d].to}}else t.push(new pn(a,c,r.tree,-o,s.from>=o,s.to<=l))}return t}var Pa;const vr=new ge;function yd(n){return ne.define({combine:n?e=>e.concat(n):void 0})}class Nt{constructor(e,t,i,r=[]){this.data=e,this.topNode=i,we.prototype.hasOwnProperty("tree")||Object.defineProperty(we.prototype,"tree",{get(){return yt(this)}}),this.parser=t,this.extension=[Nn.of(this),we.languageData.of((s,o,l)=>s.facet(vd(s,o,l)))].concat(r)}isActiveAt(e,t,i=-1){return vd(e,t,i)==this.data}findRegions(e){let t=e.facet(Nn);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],r=(s,o)=>{if(s.prop(vr)==this.data){i.push({from:o,to:o+s.length});return}let l=s.prop(ge.mounted);if(l){if(l.tree.prop(vr)==this.data){if(l.overlay)for(let a of l.overlay)i.push({from:a.from+o,to:a.to+o});else i.push({from:o,to:o+s.length});return}else if(l.overlay){let a=i.length;if(r(l.tree,l.overlay[0].from+o),i.length>a)return}}for(let a=0;a<s.children.length;a++){let c=s.children[a];c instanceof Be&&r(c,s.positions[a]+o)}};return r(yt(e),0),i}get allowsNesting(){return!0}}Nt.setState=ue.define();function vd(n,e,t){let i=n.facet(Nn);if(!i)return null;let r=i.data;if(i.allowsNesting)for(let s=yt(n).topNode;s;s=s.enter(e,t,!0,!1))r=s.type.prop(vr)||r;return r}class Da extends null{constructor(e,t){super(e,t,t.topNode),this.parser=t}static define(e){let t=yd(e.languageData);return new Da(t,e.parser.configure({props:[vr.add(i=>i.isTop?t:void 0)]}))}configure(e){return new Da(this.data,this.parser.configure(e))}get allowsNesting(){return this.parser.wrappers.length>0}}function yt(n){let e=n.field(Nt.state,!1);return e?e.tree:Be.empty}function DO(n,e,t=50){var i;let r=(i=n.field(Nt.state,!1))===null||i===void 0?void 0:i.context;return r&&(r.isDone(e)||r.work(t,e))?r.tree:null}function TO(n,e=n.doc.length){var t;return((t=n.field(Nt.state,!1))===null||t===void 0?void 0:t.context.isDone(e))||!1}function MO(n){var e;return((e=n.plugin(xd))===null||e===void 0?void 0:e.isWorking())||!1}class R1{constructor(e,t=e.length){this.doc=e,this.length=t,this.cursorPos=0,this.string="",this.cursor=e.iter()}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let br=null;class wr{constructor(e,t,i=[],r,s,o,l,a){this.parser=e,this.state=t,this.fragments=i,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}startParse(){return this.parser.startParse(new R1(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Be.empty&&this.isDone(t!=null?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(pn.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t!=null?t:this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(pn.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=br;br=this;try{return e()}finally{br=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=bd(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((c,u,h,d)=>a.push({fromA:c,toA:u,fromB:h,toB:d})),i=pn.applyChanges(i,a),r=Be.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);u<h&&l.push({from:u,to:h})}}}return new wr(this.parser,t,i,r,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:r,to:s}=this.skipped[i];r<e.to&&s>e.from&&(this.fragments=bd(this.fragments,r,s),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends hd{createParse(t,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let a=br;if(a){for(let c of r)a.tempSkipped.push(c);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new Be(at.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return br}}function bd(n,e,t){return pn.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Ei{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new Ei(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=new wr(e.facet(Nn).parser,e,[],Be.empty,0,{from:0,to:t},[],null);return i.work(20,t)||i.takeTree(),new Ei(i)}}Nt.state=qe.define({create:Ei.init,update(n,e){for(let t of e.effects)if(t.is(Nt.setState))return t.value;return e.startState.facet(Nn)!=e.state.facet(Nn)?Ei.init(e.state):n.apply(e)}});let wd=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback!="undefined"&&(wd=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:500-100})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Ta=typeof navigator!="undefined"&&((Pa=navigator.scheduling)===null||Pa===void 0?void 0:Pa.isInputPending)?()=>navigator.scheduling.isInputPending():null,xd=Ue.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Nt.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Nt.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=wd(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:r}}=this.view,s=i.field(Nt.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Ta?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<r&&i.doc.length>r+1e3,a=s.context.work(()=>Ta&&Ta()||Date.now()>o,r+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Nt.setState.of(new Ei(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Dt(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Nn=ne.define({combine(n){return n.length?n[0]:null},enables:[Nt.state,xd]});class FO{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class Sd{constructor(e,t,i,r,s,o=void 0){this.name=e,this.alias=t,this.extensions=i,this.filename=r,this.loadFunc=s,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:i}=e;if(!t){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(i)}return new Sd(e.name,(e.alias||[]).concat(e.name).map(r=>r.toLowerCase()),e.extensions||[],e.filename,t,i)}static matchFilename(e,t){for(let r of e)if(r.filename&&r.filename.test(t))return r;let i=/\.([^.]+)$/.exec(t);if(i){for(let r of e)if(r.extensions.indexOf(i[1])>-1)return r}return null}static matchLanguageName(e,t,i=!0){t=t.toLowerCase();for(let r of e)if(r.alias.some(s=>s==t))return r;if(i)for(let r of e)for(let s of r.alias){let o=t.indexOf(s);if(o>-1&&(s.length>2||!/\w/.test(t[o-1])&&!/\w/.test(t[o+s.length])))return r}return null}}const Cd=ne.define(),Ma=ne.define({combine:n=>{if(!n.length)return"  ";if(!/^(?: +|\t+)$/.test(n[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return n[0]}});function ti(n){let e=n.facet(Ma);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function xr(n,e){let t="",i=n.tabSize;if(n.facet(Ma).charCodeAt(0)==9)for(;e>=i;)t+="	",e-=i;for(let r=0;r<e;r++)t+=" ";return t}function Fa(n,e){n instanceof we&&(n=new Ps(n));for(let i of n.state.facet(Cd)){let r=i(n,e);if(r!=null)return r}let t=yt(n.state);return t?L1(n,t,e):null}class Ps{constructor(e,t={}){this.state=e,this.options=t,this.unit=ti(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=i.from&&r<=i.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:i.text.slice(r-i.from),from:r}:{text:i.text.slice(0,r-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:r}=this.lineAt(e,t);return i.slice(e-r,Math.min(i.length,e+100-r))}column(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.countColumn(i,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(e,t=e.length){return er(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const I1=new ge;function L1(n,e,t){return kd(e.resolveInner(t).enterUnfinishedNodesBefore(t),t,n)}function N1(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function W1(n){let e=n.type.prop(I1);if(e)return e;let t=n.firstChild,i;if(t&&(i=t.type.prop(ge.closedBy))){let r=n.lastChild,s=r&&i.indexOf(r.name)>-1;return o=>Od(o,!0,1,void 0,s&&!N1(o)?r.from:void 0)}return n.parent==null?j1:null}function kd(n,e,t){for(;n;n=n.parent){let i=W1(n);if(i)return i(new V1(t,e,n))}return null}function j1(){return 0}class V1 extends Ps{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.node=i}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if($1(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?kd(e,this.pos,this.base):0}}function $1(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function H1(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let r=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==i)return null;if(!a.type.isSkipped)return a.from<o?t:null;l=a.to}}function BO({closing:n,align:e=!0,units:t=1}){return i=>Od(i,e,t,n)}function Od(n,e,t,i,r){let s=n.textAfter,o=s.match(/^\s*/)[0].length,l=i&&s.slice(o,o+i.length)==i||r==n.pos+o,a=e?H1(n):null;return a?l?n.column(a.from):n.column(a.to):n.baseIndent+(l?0:n.unit*t)}const RO=n=>n.baseIndent;function IO({except:n,units:e=1}={}){return t=>{let i=n&&n.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}const U1=200;function z1(){return we.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:i}=n.newSelection.main,r=t.lineAt(i);if(i>r.from+U1)return n;let s=t.sliceString(r.from,i);if(!e.some(c=>c.test(s)))return n;let{state:o}=n,l=-1,a=[];for(let{head:c}of o.selection.ranges){let u=o.doc.lineAt(c);if(u.from==l)continue;l=u.from;let h=Fa(o,u.from);if(h==null)continue;let d=/^\s*/.exec(u.text)[0],m=xr(o,h);d!=m&&a.push({from:u.from,to:u.from+d.length,insert:m})}return a.length?[n,{changes:a,sequential:!0}]:n})}const Z1=ne.define(),q1=new ge;function LO(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function K1(n,e,t){let i=yt(n);if(i.length==0)return null;let r=i.resolveInner(t),s=null;for(let o=r;o;o=o.parent){if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let l=o.type.prop(q1);if(l&&(o.to<i.length-50||i.length==n.doc.length||!G1(o))){let a=l(o,n);a&&a.from<=t&&a.from>=e&&a.to>t&&(s=a)}}return s}function G1(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Ds(n,e,t){for(let i of n.facet(Z1)){let r=i(n,e,t);if(r)return r}return K1(n,e,t)}let J1=0;class Qt{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=J1++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let t=new Qt([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new Ts;return t=>t.modified.indexOf(e)>-1?t:Ts.get(t.base||t,t.modified.concat(e).sort((i,r)=>i.id-r.id))}}let Y1=0;class Ts{constructor(){this.instances=[],this.id=Y1++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(l=>l.base==e&&X1(t,l.modified));if(i)return i;let r=[],s=new Qt(r,e,t);for(let l of t)l.instances.push(s);let o=Ad(t);for(let l of e.set)for(let a of o)r.push(Ts.get(l,a));return s}}function X1(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function Ad(n){let e=[n];for(let t=0;t<n.length;t++)for(let i of Ad(n.slice(0,t).concat(n.slice(t+1))))e.push(i);return e}function _1(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let r of t.split(" "))if(r){let s=[],o=2,l=r;for(let h=0;;){if(l=="..."&&h>0&&h+3==r.length){o=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!d)throw new RangeError("Invalid path: "+r);if(s.push(d[0]=="*"?null:d[0][0]=='"'?JSON.parse(d[0]):d[0]),h+=d[0].length,h==r.length)break;let m=r[h++];if(h==r.length&&m=="!"){o=0;break}if(m!="/")throw new RangeError("Invalid path: "+r);l=r.slice(h)}let a=s.length-1,c=s[a];if(!c)throw new RangeError("Invalid path: "+r);let u=new Q1(i,o,a>0?s.slice(0,a):null);e[c]=u.sort(e[c])}}return Ed.add(e)}const Ed=new ge,Ms=ne.define({combine(n){return n.length?Pi.combinedMatch(n):null}}),Pd=ne.define({combine(n){return n.length?n[0].match:null}});function Ba(n){return n.facet(Ms)||n.facet(Pd)}class Q1{constructor(e,t,i,r){this.tags=e,this.mode=t,this.context=i,this.next=r}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}class Pi{constructor(e,t){this.map=Object.create(null);let i;function r(o){let l=Dn.newName();return(i||(i=Object.create(null)))["."+l]=o,l}this.all=typeof t.all=="string"?t.all:t.all?r(t.all):null;for(let o of e){let l=(o.class||r(Object.assign({},o,{tag:null})))+(this.all?" "+this.all:""),a=o.tag;if(!Array.isArray(a))this.map[a.id]=l;else for(let c of a)this.map[c.id]=l}this.module=i?new Dn(i):null,this.scope=t.scope||null,this.match=this.match.bind(this);let s=[tx];this.module&&s.push(_.styleModule.of(this.module)),this.extension=s.concat(t.themeType==null?Ms.of(this):Ms.computeN([_.darkTheme],o=>o.facet(_.darkTheme)==(t.themeType=="dark")?[this]:[])),this.fallback=s.concat(Pd.of(this))}match(e,t){if(this.scope&&t!=this.scope)return null;for(let i of e.set){let r=this.map[i.id];if(r!==void 0)return i!=e&&(this.map[e.id]=r),r}return this.map[e.id]=this.all}static combinedMatch(e){if(e.length==1)return e[0].match;let t=e.some(i=>i.scope)?void 0:Object.create(null);return(i,r)=>{let s=t&&t[i.id];if(s!==void 0)return s;let o=null;for(let l of e){let a=l.match(i,r);a&&(o=o?o+" "+a:a)}return t&&(t[i.id]=o),o}}static define(e,t){return new Pi(e,t||{})}static get(e,t,i){let r=Ba(e);return r&&r(t,i||at.none)}}function NO(n,e,t,i=0,r=n.length){Td(n,i,r,e,t)}class ex{constructor(e){this.markCache=Object.create(null),this.tree=yt(e.state),this.decorations=this.buildDeco(e,Ba(e.state))}update(e){let t=yt(e.state),i=Ba(e.state),r=i!=e.startState.facet(Ms);t.length<e.view.viewport.to&&!r&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i))}buildDeco(e,t){if(!t||!this.tree.length)return te.none;let i=new Tn;for(let{from:r,to:s}of e.visibleRanges)Td(this.tree,r,s,t,(o,l,a)=>{i.add(o,l,this.markCache[a]||(this.markCache[a]=te.mark({class:a})))});return i.finish()}}const tx=vi.high(Ue.fromClass(ex,{decorations:n=>n.decorations})),Dd=[""];class nx{constructor(e,t,i){this.at=e,this.style=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,r,s,o){let{type:l,from:a,to:c}=e;if(a>=i||c<=t)return;Dd[s]=l.name,l.isTop&&(o=l);let u=r,h=l.prop(Ed),d=!1;for(;h;){if(!h.context||ix(h.context,Dd,s)){for(let p of h.tags){let y=this.style(p,o);y&&(u&&(u+=" "),u+=y,h.mode==1?r+=(r?" ":"")+y:h.mode==0&&(d=!0))}break}h=h.next}if(this.startSpan(e.from,u),d)return;let m=e.tree&&e.tree.prop(ge.mounted);if(m&&m.overlay){let p=e.node.enter(m.overlay[0].from+a,1),y=e.firstChild();for(let b=0,v=a;;b++){let C=b<m.overlay.length?m.overlay[b]:null,x=C?C.from+a:c,k=Math.max(t,v),w=Math.min(i,x);if(k<w&&y)for(;e.from<w&&(this.highlightRange(e,k,w,r,s+1,o),this.startSpan(Math.min(i,e.to),u),!(e.to>=x||!e.nextSibling())););if(!C||x>i)break;v=C.to+a,v>t&&(this.highlightRange(p.cursor,Math.max(t,C.from+a),Math.min(i,v),r,s,m.tree.type),this.startSpan(v,u))}y&&e.parent()}else if(e.firstChild()){do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,r,s+1,o),this.startSpan(Math.min(i,e.to),u)}while(e.nextSibling());e.parent()}}}function Td(n,e,t,i,r){let s=new nx(e,i,r);s.highlightRange(n.cursor(),e,t,"",0,n.type),s.flush(t)}function ix(n,e,t){if(n.length>t-1)return!1;for(let i=t-1,r=n.length-1;r>=0;r--,i--){let s=n[r];if(s&&s!=e[i])return!1}return!0}const V=Qt.define,Fs=V(),Wn=V(),Md=V(Wn),Fd=V(Wn),jn=V(),Bs=V(jn),Ra=V(jn),en=V(),ni=V(en),tn=V(),nn=V(),Ia=V(),Sr=V(Ia),Rs=V(),E={comment:Fs,lineComment:V(Fs),blockComment:V(Fs),docComment:V(Fs),name:Wn,variableName:V(Wn),typeName:Md,tagName:V(Md),propertyName:Fd,attributeName:V(Fd),className:V(Wn),labelName:V(Wn),namespace:V(Wn),macroName:V(Wn),literal:jn,string:Bs,docString:V(Bs),character:V(Bs),attributeValue:V(Bs),number:Ra,integer:V(Ra),float:V(Ra),bool:V(jn),regexp:V(jn),escape:V(jn),color:V(jn),url:V(jn),keyword:tn,self:V(tn),null:V(tn),atom:V(tn),unit:V(tn),modifier:V(tn),operatorKeyword:V(tn),controlKeyword:V(tn),definitionKeyword:V(tn),moduleKeyword:V(tn),operator:nn,derefOperator:V(nn),arithmeticOperator:V(nn),logicOperator:V(nn),bitwiseOperator:V(nn),compareOperator:V(nn),updateOperator:V(nn),definitionOperator:V(nn),typeOperator:V(nn),controlOperator:V(nn),punctuation:Ia,separator:V(Ia),bracket:Sr,angleBracket:V(Sr),squareBracket:V(Sr),paren:V(Sr),brace:V(Sr),content:en,heading:ni,heading1:V(ni),heading2:V(ni),heading3:V(ni),heading4:V(ni),heading5:V(ni),heading6:V(ni),contentSeparator:V(en),list:V(en),quote:V(en),emphasis:V(en),strong:V(en),link:V(en),monospace:V(en),strikethrough:V(en),inserted:V(),deleted:V(),changed:V(),invalid:V(),meta:Rs,documentMeta:V(Rs),annotation:V(Rs),processingInstruction:V(Rs),definition:Qt.defineModifier(),constant:Qt.defineModifier(),function:Qt.defineModifier(),standard:Qt.defineModifier(),local:Qt.defineModifier(),special:Qt.defineModifier()},rx=Pi.define([{tag:E.link,textDecoration:"underline"},{tag:E.heading,textDecoration:"underline",fontWeight:"bold"},{tag:E.emphasis,fontStyle:"italic"},{tag:E.strong,fontWeight:"bold"},{tag:E.strikethrough,textDecoration:"line-through"},{tag:E.keyword,color:"#708"},{tag:[E.atom,E.bool,E.url,E.contentSeparator,E.labelName],color:"#219"},{tag:[E.literal,E.inserted],color:"#164"},{tag:[E.string,E.deleted],color:"#a11"},{tag:[E.regexp,E.escape,E.special(E.string)],color:"#e40"},{tag:E.definition(E.variableName),color:"#00f"},{tag:E.local(E.variableName),color:"#30a"},{tag:[E.typeName,E.namespace],color:"#085"},{tag:E.className,color:"#167"},{tag:[E.special(E.variableName),E.macroName],color:"#256"},{tag:E.definition(E.propertyName),color:"#00c"},{tag:E.comment,color:"#940"},{tag:E.meta,color:"#7a757a"},{tag:E.invalid,color:"#f00"}]),WO=Pi.define([{tag:E.link,class:"cmt-link"},{tag:E.heading,class:"cmt-heading"},{tag:E.emphasis,class:"cmt-emphasis"},{tag:E.strong,class:"cmt-strong"},{tag:E.keyword,class:"cmt-keyword"},{tag:E.atom,class:"cmt-atom"},{tag:E.bool,class:"cmt-bool"},{tag:E.url,class:"cmt-url"},{tag:E.labelName,class:"cmt-labelName"},{tag:E.inserted,class:"cmt-inserted"},{tag:E.deleted,class:"cmt-deleted"},{tag:E.literal,class:"cmt-literal"},{tag:E.string,class:"cmt-string"},{tag:E.number,class:"cmt-number"},{tag:[E.regexp,E.escape,E.special(E.string)],class:"cmt-string2"},{tag:E.variableName,class:"cmt-variableName"},{tag:E.local(E.variableName),class:"cmt-variableName cmt-local"},{tag:E.definition(E.variableName),class:"cmt-variableName cmt-definition"},{tag:E.special(E.variableName),class:"cmt-variableName2"},{tag:E.definition(E.propertyName),class:"cmt-propertyName cmt-definition"},{tag:E.typeName,class:"cmt-typeName"},{tag:E.namespace,class:"cmt-namespace"},{tag:E.className,class:"cmt-className"},{tag:E.macroName,class:"cmt-macroName"},{tag:E.propertyName,class:"cmt-propertyName"},{tag:E.operator,class:"cmt-operator"},{tag:E.comment,class:"cmt-comment"},{tag:E.meta,class:"cmt-meta"},{tag:E.invalid,class:"cmt-invalid"},{tag:E.punctuation,class:"cmt-punctuation"}]);function Bd(n,e,t,i=0,r=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let s=r;for(let o=i;o<e;o++)n.charCodeAt(o)==9?s+=t-s%t:s++;return s}class Rd{constructor(e,t,i){this.string=e,this.tabSize=t,this.indentUnit=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),i;if(typeof e=="string"?i=t==e:i=t&&(e instanceof RegExp?e.test(t):e(t)),i)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Bd(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){return Bd(this.string,null,this.tabSize)}match(e,t,i){if(typeof e=="string"){let r=o=>i?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function sx(n){return{token:n.token,blankLine:n.blankLine||(()=>{}),startState:n.startState||(()=>!0),copyState:n.copyState||ox,indent:n.indent||(()=>null),languageData:n.languageData||{},tokenTable:n.tokenTable||Wa}}function ox(n){if(typeof n!="object")return n;let e={};for(let t in n){let i=n[t];e[t]=i instanceof Array?i.slice():i}return e}class La extends Nt{constructor(e){let t=yd(e.languageData),i=sx(e),r,s=new class extends hd{createParse(o,l,a){return new ax(r,o,l,a)}};super(t,s,hx(t),[Cd.of((o,l)=>this.getIndent(o,l))]),r=this,this.streamParser=i,this.stateAfter=new ge({perNode:!0}),this.tokenTable=e.tokenTable?new jd(i.tokenTable):ux}static define(e){return new La(e)}getIndent(e,t){let i=yt(e.state),r=i.resolve(t);for(;r&&r.type!=this.topNode;)r=r.parent;if(!r)return null;let s=Na(this,i,0,r.from,t),o,l;if(s?(l=s.state,o=s.pos+1):(l=this.streamParser.startState(e.unit),o=0),t-o>1e4)return null;for(;o<t;){let c=e.state.doc.lineAt(o),u=Math.min(t,c.to);if(c.length){let h=new Rd(c.text,e.state.tabSize,e.unit);for(;h.pos<u-c.from;)Ld(this.streamParser.token,h,l)}else this.streamParser.blankLine(l,e.unit);if(u==t)break;o=c.to+1}let{text:a}=e.lineAt(t);return this.streamParser.indent(l,/^\s*(.*)/.exec(a)[1],e)}get allowsNesting(){return!1}}function Na(n,e,t,i,r){let s=t>=i&&t+e.length<=r&&e.prop(n.stateAfter);if(s)return{state:n.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],a=t+e.positions[o],c=l instanceof Be&&a<r&&Na(n,l,a,i,r);if(c)return c}return null}function Id(n,e,t,i,r){if(r&&t<=0&&i>=e.length)return e;!r&&e.type==n.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],l=e.children[s],a;if(o<i&&l instanceof Be){if(!(a=Id(n,l,t-o,i-o,r)))break;return r?new Be(e.type,e.children.slice(0,s).concat(a),e.positions.slice(0,s+1),o+a.length):a}}return null}function lx(n,e,t,i){for(let r of e){let s=r.from+(r.openStart?25:0),o=r.to-(r.openEnd?25:0),l=s<=t&&o>t&&Na(n,r.tree,0-r.offset,t,o),a;if(l&&(a=Id(n,r.tree,t+r.offset,l.pos+r.offset,!1)))return{state:l.state,tree:a}}return{state:n.streamParser.startState(i?ti(i):4),tree:Be.empty}}class ax{constructor(e,t,i,r){this.lang=e,this.input=t,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=wr.get(),o=r[0].from,{state:l,tree:a}=lx(e,i,o,s==null?void 0:s.state);this.state=l,this.parsedPos=this.chunkStart=o+a.length;for(let c=0;c<a.children.length;c++)this.chunks.push(a.children[c]),this.chunkPos.push(a.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(ti(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=wr.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(t,this.chunkStart+2048);for(e&&(i=Math.min(i,e.viewport.to));this.parsedPos<i;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let i=t.indexOf(`
`);i>-1&&(t=t.slice(0,i))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),i=e+t.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=i||(t=t.slice(0,s-(i-t.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,l=this.lineAfter(o);t+=l,i=o+l.length}return{line:t,end:i}}skipGapsTo(e,t,i){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+t;if(i>0?r>s:r>=s)break;t+=this.ranges[++this.rangeIndex].from-r}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,i,r,s){if(this.ranges.length>1){s=this.skipGapsTo(t,s,1),t+=s;let o=this.chunk.length;s=this.skipGapsTo(i,s,-1),i+=s,r+=this.chunk.length-o}return this.chunk.push(e,t,i,r),s}parseLine(e){let{line:t,end:i}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new Rd(t,e?e.state.tabSize:4,e?ti(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let l=Ld(s.token,o,this.state);if(l&&(r=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+o.start,this.parsedPos+o.pos,4,r)),o.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Be.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:cx,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Be(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Be(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function Ld(n,e,t){e.start=e.pos;for(let i=0;i<10;i++){let r=n(e,t);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const Wa=Object.create(null),Cr=[at.none],cx=new Ca(Cr),Nd=[],Wd=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Wd[n]=Vd(Wa,e);class jd{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Wd)}resolve(e){return e?this.table[e]||(this.table[e]=Vd(this.extra,e)):0}}const ux=new jd(Wa);function ja(n,e){Nd.indexOf(n)>-1||(Nd.push(n),console.warn(e))}function Vd(n,e){let t=null;for(let s of e.split(".")){let o=n[s]||E[s];o?typeof o=="function"?t?t=o(t):ja(s,`Modifier ${s} used at start of tag`):t?ja(s,`Tag ${s} used as modifier`):t=o:ja(s,`Unknown highlighting tag ${s}`)}if(!t)return 0;let i=e.replace(/ /g,"_"),r=at.define({id:Cr.length,name:i,props:[_1({[i]:t})]});return Cr.push(r),r.id}function hx(n){let e=at.define({id:Cr.length,name:"Document",props:[vr.add(()=>n)]});return Cr.push(e),e}var fx=g(7896),dx=g(31461);const Va=Pn.define(),mx=Pn.define(),px=ne.define(),$d=ne.define({combine(n){return dn(n,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function gx(n){let e=0;return n.iterChangedRanges((t,i)=>e=i),e}const $a=qe.define({create(){return rn.empty},update(n,e){let t=e.state.facet($d),i=e.annotation(Va);if(i){let a=e.docChanged?T.single(gx(e.changes)):void 0,c=xt.fromTransaction(e,a),u=i.side,h=u==0?n.undone:n.done;return c?h=Ls(h,h.length,t.minDepth,c):h=Zd(h,e.startState.selection),new rn(u==0?i.rest:h,u==0?h:i.rest)}let r=e.annotation(mx);if((r=="full"||r=="before")&&(n=n.isolate()),e.annotation(Ye.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=xt.fromTransaction(e),o=e.annotation(Ye.time),l=e.annotation(Ye.userEvent);return s?n=n.addChanges(s,o,l,t.newGroupDelay,t.minDepth):e.selection&&(n=n.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(r=="full"||r=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new rn(n.done.map(xt.fromJSON),n.undone.map(xt.fromJSON))}});function yx(n={}){return[$a,$d.of(n),_.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?Hd:e.inputType=="historyRedo"?Ud:null;return i?(e.preventDefault(),i(t)):!1}})]}const jO=null;function Is(n,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let r=t.field($a,!1);if(!r)return!1;let s=r.pop(n,t,e);return s?(i(s),!0):!1}}const Hd=Is(0,!1),Ud=Is(1,!1),vx=Is(0,!0),bx=Is(1,!0);function VO(n){return function(e){let t=e.field($a,!1);if(!t)return 0;let i=n==0?t.done:t.undone;return i.length-(i.length&&!i[0].changes?1:0)}}const $O=null,HO=null;class xt{constructor(e,t,i,r,s){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new xt(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new xt(e.changes&&Je.fromJSON(e.changes),[],e.mapped&&hn.fromJSON(e.mapped),e.startSelection&&T.fromJSON(e.startSelection),e.selectionsAfter.map(T.fromJSON))}static fromTransaction(e,t){let i=Wt;for(let r of e.startState.facet(px)){let s=r(e);s.length&&(i=i.concat(s))}return!i.length&&e.changes.empty?null:new xt(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,Wt)}static selection(e){return new xt(void 0,Wt,void 0,void 0,e)}}function Ls(n,e,t,i){let r=e+1>t+20?e-t-1:0,s=n.slice(r,e);return s.push(i),s}function wx(n,e){let t=[],i=!1;return n.iterChangedRanges((r,s)=>t.push(r,s)),e.iterChangedRanges((r,s,o,l)=>{for(let a=0;a<t.length;){let c=t[a++],u=t[a++];l>=c&&o<=u&&(i=!0)}}),i}function xx(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function zd(n,e){return n.length?e.length?n.concat(e):n:e}const Wt=[],Sx=200;function Zd(n,e){if(n.length){let t=n[n.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-Sx));return i.length&&i[i.length-1].eq(e)?n:(i.push(e),Ls(n,n.length-1,1e9,t.setSelAfter(i)))}else return[xt.selection([e])]}function Cx(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Ha(n,e){if(!n.length)return n;let t=n.length,i=Wt;for(;t;){let r=kx(n[t-1],e,i);if(r.changes&&!r.changes.empty||r.effects.length){let s=n.slice(0,t);return s[t-1]=r,s}else e=r.mapped,t--,i=r.selectionsAfter}return i.length?[xt.selection(i)]:Wt}function kx(n,e,t){let i=zd(n.selectionsAfter.length?n.selectionsAfter.map(l=>l.map(e)):Wt,t);if(!n.changes)return xt.selection(i);let r=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new xt(r,ue.mapEffects(n.effects,e),o,n.startSelection.map(s),i)}const Ox=/^(input\.type|delete)($|\.)/;class rn{constructor(e,t,i=0,r=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=r}isolate(){return this.prevTime?new rn(this.done,this.undone):this}addChanges(e,t,i,r,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!i||Ox.test(i))&&(!l.selectionsAfter.length&&t-this.prevTime<r&&wx(l.changes,e.changes)||i=="input.type.compose")?o=Ls(o,o.length-1,s,new xt(e.changes.compose(l.changes),zd(e.effects,l.effects),l.mapped,l.startSelection,Wt)):o=Ls(o,o.length,s,e),new rn(o,Wt,t,i)}addSelection(e,t,i,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Wt;return s.length>0&&t-this.prevTime<r&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&xx(s[s.length-1],e)?this:new rn(Zd(this.done,e),this.undone,t,i)}addMapping(e){return new rn(Ha(this.done,e),Ha(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1];if(i&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Va.of({side:e,rest:Cx(r)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=r.length==1?Wt:r.slice(0,r.length-1);return s.mapped&&(o=Ha(o,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Va.of({side:e,rest:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}rn.empty=new rn(Wt,Wt);const Ax=[{key:"Mod-z",run:Hd,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ud,preventDefault:!0},{key:"Mod-u",run:vx,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:bx,preventDefault:!0}];class sn extends Yn{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}sn.prototype.elementClass="",sn.prototype.toDOM=void 0,sn.prototype.mapMode=ft.TrackBefore,sn.prototype.startSide=sn.prototype.endSide=-1,sn.prototype.point=!0;const Ns=ne.define(),Ex={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>ke.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},kr=ne.define();function qd(n){return[Kd(),kr.of(Object.assign(Object.assign({},Ex),n))]}const Px=_.baseTheme({".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#999",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"}}),Ua=ne.define({combine:n=>n.some(e=>e)});function Kd(n){let e=[Dx,Px];return n&&n.fixed===!1&&e.push(Ua.of(!0)),e}const Dx=Ue.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(kr).map(e=>new Yd(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(Ua),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Ua)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=ke.iter(this.view.state.facet(Ns),this.view.viewport.from),i=[],r=this.gutters.map(s=>new Tx(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks){let o;if(Array.isArray(s.type)){for(let l of s.type)if(l.type==Me.Text){o=l;break}}else o=s.type==Me.Text?s:void 0;if(!!o){i.length&&(i=[]),Jd(t,i,s.from);for(let l of r)l.line(this.view,o,i)}}for(let s of r)s.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(kr),t=n.state.facet(kr),i=n.docChanged||n.heightChanged||n.viewportChanged||!ke.eq(n.startState.facet(Ns),n.state.facet(Ns),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(n)&&(i=!0);else{i=!0;let r=[];for(let s of t){let o=e.indexOf(s);o<0?r.push(new Yd(this.view,s)):(this.gutters[o].update(n),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:lt.scrollMargins.from(n=>n.gutters.length==0||!n.fixed?null:n.view.textDirection==xe.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth})});function Gd(n){return Array.isArray(n)?n:[n]}function Jd(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class Tx{constructor(e,t,i){this.gutter=e,this.height=i,this.localMarkers=[],this.i=0,this.cursor=ke.iter(e.markers,t.from)}line(e,t,i){this.localMarkers.length&&(this.localMarkers=[]),Jd(this.cursor,this.localMarkers,t.from);let r=i.length?this.localMarkers.concat(i):this.localMarkers,s=this.gutter.config.lineMarker(e,t,r);s&&r.unshift(s);let o=this.gutter;if(r.length==0&&!o.config.renderEmptyElements)return;let l=t.top-this.height;if(this.i==o.elements.length){let a=new Xd(e,t.height,l,r);o.elements.push(a),o.dom.appendChild(a.dom)}else o.elements[this.i].update(e,t.height,l,r);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Yd{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,r=>{let s=e.lineBlockAtHeight(r.clientY-e.documentTop);t.domEventHandlers[i](e,s,r)&&r.preventDefault()});this.markers=Gd(t.markers(e)),t.initialSpacer&&(this.spacer=new Xd(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Gd(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let i=e.view.viewport;return!ke.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Xd{constructor(e,t,i,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.update(e,t,i,r)}update(e,t,i,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),Mx(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,c=!1;if(a){let u=a.elementClass;u&&(i+=" "+u);for(let h=o;h<this.markers.length;h++)if(this.markers[h].compare(a)){l=h,c=!0;break}}else l=this.markers.length;for(;o<l;){let u=this.markers[o++];if(u.toDOM){u.destroy(r);let h=r.nextSibling;r.remove(),r=h}}if(!a)break;a.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),c&&o++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function Mx(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const Fx=ne.define(),Di=ne.define({combine(n){return dn(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let r in t){let s=i[r],o=t[r];i[r]=s?(l,a,c)=>s(l,a,c)||o(l,a,c):o}return i}})}});class za extends sn{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Za(n,e){return n.state.facet(Di).formatNumber(e,n.state)}const Bx=kr.compute([Di],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Fx)},lineMarker(e,t,i){return i.some(r=>r.toDOM)?null:new za(Za(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(Di)!=e.state.facet(Di),initialSpacer(e){return new za(Za(e,_d(e.state.doc.lines)))},updateSpacer(e,t){let i=Za(t.view,_d(t.view.state.doc.lines));return i==e.number?e:new za(i)},domEventHandlers:n.facet(Di).domEventHandlers}));function Rx(n={}){return[Di.of(n),Kd(),Bx]}function _d(n){let e=9;for(;e<n;)e=e*10+9;return e}const Ix=new class extends sn{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Lx=Ns.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges)if(i.empty){let r=n.doc.lineAt(i.head).from;r>t&&(t=r,e.push(Ix.range(r)))}return ke.of(e)});function Nx(){return Lx}function Qd(n,e){let t=e.mapPos(n.from,1),i=e.mapPos(n.to,-1);return t>=i?void 0:{from:t,to:i}}const Ws=ue.define({map:Qd}),Or=ue.define({map:Qd});function em(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(n.lineBlockAt(t));return e}const Vn=qe.define({create(){return te.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)t.is(Ws)&&!Wx(n,t.value.from,t.value.to)?n=n.update({add:[Ux.range(t.value.from,t.value.to)]}):t.is(Or)&&(n=n.update({filter:(i,r)=>t.value.from!=i||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:i}=e.selection.main;n.between(i,i,(r,s)=>{r<i&&s>i&&(t=!0)}),t&&(n=n.update({filterFrom:i,filterTo:i,filter:(r,s)=>s<=i||r>=i}))}return n},provide:n=>_.decorations.from(n)});function UO(n){return n.field(Vn,!1)||RangeSet.empty}function js(n,e,t){var i;let r=null;return(i=n.field(Vn,!1))===null||i===void 0||i.between(e,t,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function Wx(n,e,t){let i=!1;return n.between(e,e,(r,s)=>{r==e&&s==t&&(i=!0)}),i}function tm(n,e){return n.field(Vn,!1)?e:e.concat(ue.appendConfig.of(rm()))}const jx=n=>{for(let e of em(n)){let t=Ds(n.state,e.from,e.to);if(t)return n.dispatch({effects:tm(n.state,[Ws.of(t),nm(n,t)])}),!0}return!1},Vx=n=>{if(!n.state.field(Vn,!1))return!1;let e=[];for(let t of em(n)){let i=js(n.state,t.from,t.to);i&&e.push(Or.of(i),nm(n,i,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function nm(n,e,t=!0){let i=n.state.doc.lineAt(e.from).number,r=n.state.doc.lineAt(e.to).number;return _.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${r}.`)}const $x=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:jx},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Vx},{key:"Ctrl-Alt-[",run:n=>{let{state:e}=n,t=[];for(let i=0;i<e.doc.length;){let r=n.lineBlockAt(i),s=Ds(e,r.from,r.to);s&&t.push(Ws.of(s)),i=(s?n.lineBlockAt(s.to):r).to+1}return t.length&&n.dispatch({effects:tm(n.state,t)}),!!t.length}},{key:"Ctrl-Alt-]",run:n=>{let e=n.state.field(Vn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(i,r)=>{t.push(Or.of({from:i,to:r}))}),n.dispatch({effects:t}),!0}}],Hx={placeholderDOM:null,placeholderText:"\u2026"},im=ne.define({combine(n){return dn(n,Hx)}});function rm(n){let e=[Vn,qx];return n&&e.push(im.of(n)),e}const Ux=te.replace({widget:new class extends Jt{toDOM(n){let{state:e}=n,t=e.facet(im),i=s=>{let o=n.lineBlockAt(n.posAtDOM(s.target)),l=js(n.state,o.from,o.to);l&&n.dispatch({effects:Or.of(l)}),s.preventDefault()};if(t.placeholderDOM)return t.placeholderDOM(n,i);let r=document.createElement("span");return r.textContent=t.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=i,r}}}),zx={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{}};class qa extends sn{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function Zx(n={}){let e=Object.assign(Object.assign({},zx),n),t=new qa(e,!0),i=new qa(e,!1),r=Ue.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Nn)!=o.state.facet(Nn)||o.startState.field(Vn,!1)!=o.state.field(Vn,!1))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new Tn;for(let a of o.viewportLineBlocks){let c=js(o.state,a.from,a.to)?i:Ds(o.state,a.from,a.to)?t:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:s}=e;return[r,qd({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(r))===null||l===void 0?void 0:l.markers)||ke.empty},initialSpacer(){return new qa(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let c=js(o.state,l.from,l.to);if(c)return o.dispatch({effects:Or.of(c)}),!0;let u=Ds(o.state,l.from,l.to);return u?(o.dispatch({effects:Ws.of(u)}),!0):!1}})}),rm()]}const qx=_.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),Kx=_.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),sm=1e4,om="()[]{}",lm=ne.define({combine(n){return dn(n,{afterCursor:!0,brackets:om,maxScanDistance:sm})}}),Gx=te.mark({class:"cm-matchingBracket"}),Jx=te.mark({class:"cm-nonmatchingBracket"}),Yx=[qe.define({create(){return te.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],i=e.state.facet(lm);for(let r of e.state.selection.ranges){if(!r.empty)continue;let s=on(e.state,r.head,-1,i)||r.head>0&&on(e.state,r.head-1,1,i)||i.afterCursor&&(on(e.state,r.head,1,i)||r.head<e.state.doc.length&&on(e.state,r.head+1,-1,i));if(!s)continue;let o=s.matched?Gx:Jx;t.push(o.range(s.start.from,s.start.to)),s.end&&t.push(o.range(s.end.from,s.end.to))}return te.set(t,!0)},provide:n=>_.decorations.from(n)}),Kx];function Xx(n={}){return[lm.of(n),Yx]}function Ka(n,e,t){let i=n.prop(e<0?ge.openedBy:ge.closedBy);if(i)return i;if(n.name.length==1){let r=t.indexOf(n.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function on(n,e,t,i={}){let r=i.maxScanDistance||sm,s=i.brackets||om,o=yt(n),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let c=Ka(a.type,t,s);if(c&&a.from<a.to)return _x(n,e,t,a,c,s)}return Qx(n,e,t,o,l.type,r,s)}function _x(n,e,t,i,r,s){let o=i.parent,l={from:i.from,to:i.to},a=0,c=o==null?void 0:o.cursor;if(c&&(t<0?c.childBefore(i.from):c.childAfter(i.to)))do if(t<0?c.to<=i.from:c.from>=i.to){if(a==0&&r.indexOf(c.type.name)>-1&&c.from<c.to)return{start:l,end:{from:c.from,to:c.to},matched:!0};if(Ka(c.type,t,s))a++;else if(Ka(c.type,-t,s)&&(a--,a==0))return{start:l,end:c.from==c.to?void 0:{from:c.from,to:c.to},matched:!1}}while(t<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function Qx(n,e,t,i,r,s,o){let l=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),h=0;for(let d=0;!u.next().done&&d<=s;){let m=u.value;t<0&&(d+=m.length);let p=e+d*t;for(let y=t>0?0:m.length-1,b=t>0?m.length:-1;y!=b;y+=t){let v=o.indexOf(m[y]);if(!(v<0||i.resolve(p+y,1).type!=r))if(v%2==0==t>0)h++;else{if(h==1)return{start:c,end:{from:p+y,to:p+y+1},matched:v>>1==a>>1};h--}}t>0&&(d+=m.length)}return u.done?{start:c,matched:!1}:null}function Ti(n,e){return T.create(n.ranges.map(e),n.mainIndex)}function ln(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function an({state:n,dispatch:e},t){let i=Ti(n.selection,t);return i.eq(n.selection)?!1:(e(ln(n,i)),!0)}function Ar(n,e){return T.cursor(e?n.to:n.from)}function Vs(n,e){return an(n,t=>t.empty?n.moveByChar(t,e):Ar(t,e))}const am=n=>Vs(n,n.textDirection!=xe.LTR),cm=n=>Vs(n,n.textDirection==xe.LTR),KO=n=>Vs(n,!0),GO=n=>Vs(n,!1);function $s(n,e){return an(n,t=>t.empty?n.moveByGroup(t,e):Ar(t,e))}const eS=n=>$s(n,n.textDirection!=xe.LTR),tS=n=>$s(n,n.textDirection==xe.LTR),JO=n=>$s(n,!0),YO=n=>$s(n,!1);function um(n,e,t){let i=n.state.charCategorizer(e.from);return n.moveByChar(e,t,r=>{let s=CharCategory.Space,o=e.from,l=!1,a=!1,c=!1,u=h=>{if(l)return!1;o+=t?h.length:-h.length;let d=i(h),m;if(s==CharCategory.Space&&(s=d),s!=d)return!1;if(s==CharCategory.Word)if(h.toLowerCase()==h){if(!t&&a)return!1;c=!0}else if(c){if(t)return!1;l=!0}else{if(a&&t&&i(m=n.state.sliceDoc(o,o+1))==CharCategory.Word&&m.toLowerCase()==m)return!1;a=!0}return!0};return u(r),u})}function hm(n,e){return an(n,t=>t.empty?um(n,t,e):Ar(t,e))}const XO=n=>hm(n,!0),_O=n=>hm(n,!1);function nS(n,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function Hs(n,e,t){let i=yt(n).resolveInner(e.head),r=t?ge.closedBy:ge.openedBy;for(let a=e.head;;){let c=t?i.childAfter(a):i.childBefore(a);if(!c)break;nS(n,c,r)?i=c:a=t?c.to:c.from}let s=i.type.prop(r),o,l;return s&&(o=t?on(n,i.from,1):on(n,i.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?i.to:i.from,T.cursor(l,t?-1:1)}const iS=n=>an(n,e=>Hs(n.state,e,n.textDirection!=xe.LTR)),rS=n=>an(n,e=>Hs(n.state,e,n.textDirection==xe.LTR));function fm(n,e){return an(n,t=>{if(!t.empty)return Ar(t,e);let i=n.moveVertically(t,e);return i.head!=t.head?i:n.moveToLineBoundary(t,e)})}const dm=n=>fm(n,!1),mm=n=>fm(n,!0);function pm(n,e){let{state:t}=n,i=Ti(t.selection,o=>o.empty?n.moveVertically(o,e,n.dom.clientHeight):Ar(o,e));if(i.eq(t.selection))return!1;let r=n.coordsAtPos(t.selection.main.head),s=n.scrollDOM.getBoundingClientRect();return n.dispatch(ln(t,i),{effects:r&&r.top>s.top&&r.bottom<s.bottom?_.scrollIntoView(i.main.head,{y:"start",yMargin:r.top-s.top}):void 0}),!0}const gm=n=>pm(n,!1),Ga=n=>pm(n,!0);function Us(n,e,t){let i=n.lineBlockAt(e.head),r=n.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?i.to:i.from)&&(r=n.moveToLineBoundary(e,t,!1)),!t&&r.head==i.from&&i.length){let s=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&e.head!=i.from+s&&(r=T.cursor(i.from+s))}return r}const ym=n=>an(n,e=>Us(n,e,!0)),vm=n=>an(n,e=>Us(n,e,!1)),sS=n=>an(n,e=>T.cursor(n.lineBlockAt(e.head).from,1)),oS=n=>an(n,e=>T.cursor(n.lineBlockAt(e.head).to,-1));function bm(n,e,t){let i=!1,r=Ti(n.selection,s=>{let o=on(n,s.head,-1)||on(n,s.head,1)||s.head>0&&on(n,s.head-1,1)||s.head<n.doc.length&&on(n,s.head+1,-1);if(!o||!o.end)return s;i=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return t?T.range(s.anchor,l):T.cursor(l)});return i?(e(ln(n,r)),!0):!1}const lS=({state:n,dispatch:e})=>bm(n,e,!1),QO=({state:n,dispatch:e})=>bm(n,e,!0);function zt(n,e){let t=Ti(n.state.selection,i=>{let r=e(i);return T.range(i.anchor,r.head,r.goalColumn)});return t.eq(n.state.selection)?!1:(n.dispatch(ln(n.state,t)),!0)}function zs(n,e){return zt(n,t=>n.moveByChar(t,e))}const wm=n=>zs(n,n.textDirection!=xe.LTR),xm=n=>zs(n,n.textDirection==xe.LTR),eA=n=>zs(n,!0),tA=n=>zs(n,!1);function Zs(n,e){return zt(n,t=>n.moveByGroup(t,e))}const aS=n=>Zs(n,n.textDirection!=xe.LTR),cS=n=>Zs(n,n.textDirection==xe.LTR),nA=n=>Zs(n,!0),iA=n=>Zs(n,!1);function Sm(n,e){return zt(n,t=>um(n,t,e))}const rA=n=>Sm(n,!0),sA=n=>Sm(n,!1),uS=n=>zt(n,e=>Hs(n.state,e,n.textDirection!=xe.LTR)),hS=n=>zt(n,e=>Hs(n.state,e,n.textDirection==xe.LTR));function Cm(n,e){return zt(n,t=>n.moveVertically(t,e))}const km=n=>Cm(n,!1),Om=n=>Cm(n,!0);function Am(n,e){return zt(n,t=>n.moveVertically(t,e,n.dom.clientHeight))}const Em=n=>Am(n,!1),Pm=n=>Am(n,!0),Dm=n=>zt(n,e=>Us(n,e,!0)),Tm=n=>zt(n,e=>Us(n,e,!1)),fS=n=>zt(n,e=>T.cursor(n.lineBlockAt(e.head).from)),dS=n=>zt(n,e=>T.cursor(n.lineBlockAt(e.head).to)),Mm=({state:n,dispatch:e})=>(e(ln(n,{anchor:0})),!0),Fm=({state:n,dispatch:e})=>(e(ln(n,{anchor:n.doc.length})),!0),Bm=({state:n,dispatch:e})=>(e(ln(n,{anchor:n.selection.main.anchor,head:0})),!0),Rm=({state:n,dispatch:e})=>(e(ln(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),mS=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),pS=({state:n,dispatch:e})=>{let t=Gs(n).map(({from:i,to:r})=>T.range(i,Math.min(r+1,n.doc.length)));return e(n.update({selection:T.create(t),userEvent:"select"})),!0},gS=({state:n,dispatch:e})=>{let t=Ti(n.selection,i=>{var r;let s=yt(n).resolveInner(i.head,1);for(;!(s.from<i.from&&s.to>=i.to||s.to>i.to&&s.from<=i.from||!(!((r=s.parent)===null||r===void 0)&&r.parent));)s=s.parent;return T.range(s.to,s.from)});return e(ln(n,t)),!0},yS=({state:n,dispatch:e})=>{let t=n.selection,i=null;return t.ranges.length>1?i=T.create([t.main]):t.main.empty||(i=T.create([T.cursor(t.main.head)])),i?(e(ln(n,i)),!0):!1};function qs({state:n,dispatch:e},t){if(n.readOnly)return!1;let i="delete.selection",r=n.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=t(o);a<o?i="delete.backward":a>o&&(i="delete.forward"),o=Math.min(o,a),l=Math.max(l,a)}return o==l?{range:s}:{changes:{from:o,to:l},range:T.cursor(o)}});return r.changes.empty?!1:(e(n.update(r,{scrollIntoView:!0,userEvent:i})),!0)}function Ks(n,e,t){if(n instanceof _)for(let i of n.pluginField(lt.atomicRanges))i.between(e,e,(r,s)=>{r<e&&s>e&&(e=t?s:r)});return e}const Im=(n,e)=>qs(n,t=>{let{state:i}=n,r=i.doc.lineAt(t),s,o;if(!e&&t>r.from&&t<r.from+200&&!/[^ \t]/.test(s=r.text.slice(0,t-r.from))){if(s[s.length-1]=="	")return t-1;let l=er(s,i.tabSize),a=l%ti(i)||ti(i);for(let c=0;c<a&&s[s.length-1-c]==" ";c++)t--;o=t}else o=Et(r.text,t-r.from,e,e)+r.from,o==t&&r.number!=(e?i.doc.lines:1)&&(o+=e?1:-1);return Ks(n,o,e)}),Ja=n=>Im(n,!1),Lm=n=>Im(n,!0),Nm=(n,e)=>qs(n,t=>{let i=t,{state:r}=n,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let l=null;;){if(i==(e?s.to:s.from)){i==t&&s.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let a=Et(s.text,i-s.from,e)+s.from,c=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),u=o(c);if(l!=null&&u!=l)break;(c!=" "||i!=t)&&(l=u),i=a}return Ks(n,i,e)}),Wm=n=>Nm(n,!1),vS=n=>Nm(n,!0),jm=n=>qs(n,e=>{let t=n.lineBlockAt(e).to;return Ks(n,e<t?t:Math.min(n.state.doc.length,e+1),!0)}),bS=n=>qs(n,e=>{let t=n.lineBlockAt(e).from;return Ks(n,e>t?t:Math.max(0,e-1),!1)}),oA=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=[];for(let i=0,r="",s=n.doc.iter();;){if(s.next(),s.lineBreak||s.done){let o=r.search(/\s+$/);if(o>-1&&t.push({from:i-(r.length-o),to:i}),s.done)break;r=""}else r=s.value;i+=s.value.length}return t.length?(e(n.update({changes:t,userEvent:"delete"})),!0):!1},wS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:Ee.of(["",""])},range:T.cursor(i.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},xS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>{if(!i.empty||i.from==0||i.from==n.doc.length)return{range:i};let r=i.from,s=n.doc.lineAt(r),o=r==s.from?r-1:Et(s.text,r-s.from,!1)+s.from,l=r==s.to?r+1:Et(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:n.doc.slice(r,l).append(n.doc.slice(o,r))},range:T.cursor(l)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Gs(n){let e=[],t=-1;for(let i of n.selection.ranges){let r=n.doc.lineAt(i.from),s=n.doc.lineAt(i.to);if(!i.empty&&i.to==s.from&&(s=n.doc.lineAt(i.to-1)),t>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(i)}else e.push({from:r.from,to:s.to,ranges:[i]});t=s.number+1}return e}function Vm(n,e,t){if(n.readOnly)return!1;let i=[],r=[];for(let s of Gs(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){i.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let a of s.ranges)r.push(T.range(Math.min(n.doc.length,a.anchor+l),Math.min(n.doc.length,a.head+l)))}else{i.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let a of s.ranges)r.push(T.range(a.anchor-l,a.head-l))}}return i.length?(e(n.update({changes:i,scrollIntoView:!0,selection:T.create(r,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const SS=({state:n,dispatch:e})=>Vm(n,e,!1),CS=({state:n,dispatch:e})=>Vm(n,e,!0);function $m(n,e,t){if(n.readOnly)return!1;let i=[];for(let r of Gs(n))t?i.push({from:r.from,insert:n.doc.slice(r.from,r.to)+n.lineBreak}):i.push({from:r.to,insert:n.lineBreak+n.doc.slice(r.from,r.to)});return e(n.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const kS=({state:n,dispatch:e})=>$m(n,e,!1),OS=({state:n,dispatch:e})=>$m(n,e,!0),AS=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Gs(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),i=Ti(e.selection,r=>n.moveVertically(r,!0)).map(t);return n.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0},lA=({state:n,dispatch:e})=>(e(n.update(n.replaceSelection(n.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function ES(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=yt(n).resolveInner(e),i=t.childBefore(e),r=t.childAfter(e),s;return i&&r&&i.to<=e&&r.from>=e&&(s=i.type.prop(ge.closedBy))&&s.indexOf(r.name)>-1&&n.doc.lineAt(i.to).from==n.doc.lineAt(r.from).from?{from:i.to,to:r.from}:null}const PS=Hm(!1),DS=Hm(!0);function Hm(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(r=>{let{from:s,to:o}=r,l=e.doc.lineAt(s),a=!n&&s==o&&ES(e,s);n&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let c=new Ps(e,{simulateBreak:s,simulateDoubleBreak:!!a}),u=Fa(c,s);for(u==null&&(u=/^\s*/.exec(e.doc.lineAt(s).text)[0].length);o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let h=["",xr(e,u)];return a&&h.push(xr(e,c.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:Ee.of(h)},range:T.cursor(s+1+h[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Ya(n,e){let t=-1;return n.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let l=n.doc.lineAt(o);l.number>t&&(i.empty||i.to>l.from)&&(e(l,r,i),t=l.number),o=l.to+1}let s=n.changes(r);return{changes:r,range:T.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}})}const TS=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),i=new Ps(n,{overrideIndentation:s=>{let o=t[s];return o==null?-1:o}}),r=Ya(n,(s,o,l)=>{let a=Fa(i,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let c=/^\s*/.exec(s.text)[0],u=xr(n,a);(c!=u||l.from<s.from+c.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+c.length,insert:u}))});return r.changes.empty||e(n.update(r,{userEvent:"indent"})),!0},Xa=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Ya(n,(t,i)=>{i.push({from:t.from,insert:n.facet(Ma)})}),{userEvent:"input.indent"})),!0),Um=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Ya(n,(t,i)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=er(r,n.tabSize),o=0,l=xr(n,Math.max(0,s-ti(n)));for(;o<r.length&&o<l.length&&r.charCodeAt(o)==l.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+r.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),aA=({state:n,dispatch:e})=>n.selection.ranges.some(t=>!t.empty)?Xa({state:n,dispatch:e}):(e(n.update(n.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),MS=[{key:"Ctrl-b",run:am,shift:wm,preventDefault:!0},{key:"Ctrl-f",run:cm,shift:xm},{key:"Ctrl-p",run:dm,shift:km},{key:"Ctrl-n",run:mm,shift:Om},{key:"Ctrl-a",run:sS,shift:fS},{key:"Ctrl-e",run:oS,shift:dS},{key:"Ctrl-d",run:Lm},{key:"Ctrl-h",run:Ja},{key:"Ctrl-k",run:jm},{key:"Ctrl-Alt-h",run:Wm},{key:"Ctrl-o",run:wS},{key:"Ctrl-t",run:xS},{key:"Ctrl-v",run:Ga}],FS=[{key:"ArrowLeft",run:am,shift:wm,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:eS,shift:aS},{mac:"Cmd-ArrowLeft",run:vm,shift:Tm},{key:"ArrowRight",run:cm,shift:xm,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:tS,shift:cS},{mac:"Cmd-ArrowRight",run:ym,shift:Dm},{key:"ArrowUp",run:dm,shift:km,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Mm,shift:Bm},{mac:"Ctrl-ArrowUp",run:gm,shift:Em},{key:"ArrowDown",run:mm,shift:Om,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Fm,shift:Rm},{mac:"Ctrl-ArrowDown",run:Ga,shift:Pm},{key:"PageUp",run:gm,shift:Em},{key:"PageDown",run:Ga,shift:Pm},{key:"Home",run:vm,shift:Tm},{key:"Mod-Home",run:Mm,shift:Bm},{key:"End",run:ym,shift:Dm},{key:"Mod-End",run:Fm,shift:Rm},{key:"Enter",run:PS},{key:"Mod-a",run:mS},{key:"Backspace",run:Ja,shift:Ja},{key:"Delete",run:Lm},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Wm},{key:"Mod-Delete",mac:"Alt-Delete",run:vS},{mac:"Mod-Backspace",run:bS},{mac:"Mod-Delete",run:jm}].concat(MS.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),BS=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:iS,shift:uS},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:rS,shift:hS},{key:"Alt-ArrowUp",run:SS},{key:"Shift-Alt-ArrowUp",run:kS},{key:"Alt-ArrowDown",run:CS},{key:"Shift-Alt-ArrowDown",run:OS},{key:"Escape",run:yS},{key:"Mod-Enter",run:DS},{key:"Alt-l",mac:"Ctrl-l",run:pS},{key:"Mod-i",run:gS,preventDefault:!0},{key:"Mod-[",run:Um},{key:"Mod-]",run:Xa},{key:"Mod-Alt-\\",run:TS},{key:"Shift-Mod-k",run:AS},{key:"Shift-Mod-\\",run:lS}].concat(FS),RS={key:"Tab",run:Xa,shift:Um},Js={brackets:["(","[","{","'",'"'],before:")]}:;>"},ii=ue.define({map(n,e){let t=e.mapPos(n,-1,ft.TrackAfter);return t==null?void 0:t}}),_a=ue.define({map(n,e){return e.mapPos(n)}}),Qa=new class extends Yn{};Qa.startSide=1,Qa.endSide=-1;const zm=qe.define({create(){return ke.empty},update(n,e){if(e.selection){let t=e.state.doc.lineAt(e.selection.main.head).from,i=e.startState.doc.lineAt(e.startState.selection.main.head).from;t!=e.changes.mapPos(i,-1)&&(n=ke.empty)}n=n.map(e.changes);for(let t of e.effects)t.is(ii)?n=n.update({add:[Qa.range(t.value,t.value+1)]}):t.is(_a)&&(n=n.update({filter:i=>i!=t.value}));return n}});function IS(){return[NS,zm]}const ec="()[]{}<>";function Zm(n){for(let e=0;e<ec.length;e+=2)if(ec.charCodeAt(e)==n)return ec.charAt(e+1);return Cl(n<128?n:n+1)}function qm(n,e){return n.languageDataAt("closeBrackets",e)[0]||Js}const LS=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),NS=_.inputHandler.of((n,e,t,i)=>{if((LS?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let r=n.state.selection.main;if(i.length>2||i.length==2&&It(ot(i,0))==1||e!=r.from||t!=r.to)return!1;let s=jS(n.state,i);return s?(n.dispatch(s),!0):!1}),WS=[{key:"Backspace",run:({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=qm(n,n.selection.main.head).brackets||Js.brackets,r=null,s=n.changeByRange(o=>{if(o.empty){let l=VS(n.doc,o.head);for(let a of i)if(a==l&&Ys(n.doc,o.head)==Zm(ot(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:T.cursor(o.head-a.length),userEvent:"delete.backward"}}return{range:r=o}});return r||e(n.update(s,{scrollIntoView:!0})),!r}}];function jS(n,e){let t=qm(n,n.selection.main.head),i=t.brackets||Js.brackets;for(let r of i){let s=Zm(ot(r,0));if(e==r)return s==r?US(n,r,i.indexOf(r+r+r)>-1):$S(n,r,s,t.before||Js.before);if(e==s&&Km(n,n.selection.main.from))return HS(n,r,s)}return null}function Km(n,e){let t=!1;return n.field(zm).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function Ys(n,e){let t=n.sliceString(e,e+2);return t.slice(0,It(ot(t,0)))}function VS(n,e){let t=n.sliceString(e-2,e);return It(ot(t,0))==t.length?t:t.slice(1)}function $S(n,e,t,i){let r=null,s=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:ii.of(o.to+e.length),range:T.range(o.anchor+e.length,o.head+e.length)};let l=Ys(n.doc,o.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:ii.of(o.head+e.length),range:T.cursor(o.head+e.length)}:{range:r=o}});return r?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function HS(n,e,t){let i=null,r=n.selection.ranges.map(s=>s.empty&&Ys(n.doc,s.head)==t?T.cursor(s.head+t.length):i=s);return i?null:n.update({selection:T.create(r,n.selection.mainIndex),scrollIntoView:!0,effects:n.selection.ranges.map(({from:s})=>_a.of(s))})}function US(n,e,t){let i=null,r=n.changeByRange(s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:e,from:s.to}],effects:ii.of(s.to+e.length),range:T.range(s.anchor+e.length,s.head+e.length)};let o=s.head,l=Ys(n.doc,o);if(l==e){if(Gm(n,o))return{changes:{insert:e+e,from:o},effects:ii.of(o+e.length),range:T.cursor(o+e.length)};if(Km(n,o)){let a=t&&n.sliceDoc(o,o+e.length*3)==e+e+e;return{range:T.cursor(o+e.length*(a?3:1)),effects:_a.of(o)}}}else{if(t&&n.sliceDoc(o-2*e.length,o)==e+e&&Gm(n,o-2*e.length))return{changes:{insert:e+e+e+e,from:o},effects:ii.of(o+e.length),range:T.cursor(o+e.length)};if(n.charCategorizer(o)(l)!=mt.Word){let a=n.sliceDoc(o-1,o);if(a!=e&&n.charCategorizer(o)(a)!=mt.Word&&!zS(n,o,e))return{changes:{insert:e+e,from:o},effects:ii.of(o+e.length),range:T.cursor(o+e.length)}}}return{range:i=s}});return i?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Gm(n,e){let t=yt(n).resolveInner(e+1);return t.parent&&t.from==e}function zS(n,e,t){let i=yt(n).resolveInner(e,-1);for(let r=0;r<5;r++){if(n.sliceDoc(i.from,i.from+t.length)==t)return!0;let s=i.to==e&&i.parent;if(!s)break;i=s}return!1}function Le(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=t[i];typeof r=="string"?n.setAttribute(i,r):r!=null&&(n[i]=r)}e++}for(;e<arguments.length;e++)Jm(n,arguments[e]);return n}function Jm(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)Jm(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}const Ym=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Mi{constructor(e,t,i=0,r=e.length,s){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,r),this.bufferStart=i,this.normalize=s?o=>s(Ym(o)):Ym,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ot(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Cl(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=It(e);let r=this.normalize(t);for(let s=0,o=i;;s++){let l=r.charCodeAt(s),a=this.match(l,o);if(a)return this.value=a,this;if(s==r.length-1)break;o==i&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t){let i=null;for(let r=0;r<this.matches.length;r+=2){let s=this.matches[r],o=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?i={from:this.matches[r+1],to:t+1}:(this.matches[r]++,o=!0)),o||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:t+1}:this.matches.push(1,t)),i}}typeof Symbol!="undefined"&&(Mi.prototype[Symbol.iterator]=function(){return this});const Xm={from:-1,to:-1,match:/.*/.exec("")},tc="gm"+(/x/.unicode==null?"":"u");class _m{constructor(e,t,i,r=0,s=e.length){if(this.to=s,this.curLine="",this.done=!1,this.value=Xm,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new Qm(e,t,i,r,s);this.re=new RegExp(t,tc+(i!=null&&i.ignoreCase?"i":"")),this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=r,this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,r=i+t[0].length;if(this.matchPos=r+(i==r?1:0),i==this.curLine.length&&this.nextLine(),i<r||i>this.value.to)return this.value={from:i,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const nc=new WeakMap;class Fi{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let r=nc.get(e);if(!r||r.from>=i||r.to<=t){let l=new Fi(t,e.sliceString(t,i));return nc.set(e,l),l}if(r.from==t&&r.to==i)return r;let{text:s,from:o}=r;return o>t&&(s=e.sliceString(t,o)+s,o=t),r.to<i&&(s+=e.sliceString(r.to,i)),nc.set(e,new Fi(o,s)),new Fi(t,s.slice(t-o,i-o))}}class Qm{constructor(e,t,i,r,s){this.text=e,this.to=s,this.done=!1,this.value=Xm,this.matchPos=r,this.re=new RegExp(t,tc+(i!=null&&i.ignoreCase?"i":"")),this.flat=Fi.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t&&this.flat.to<this.to&&t.index+t[0].length>this.flat.text.length-10&&(t=null),t){let i=this.flat.from+t.index,r=i+t[0].length;return this.value={from:i,to:r,match:t},this.matchPos=r+(i==r?1:0),this}else{if(this.flat.to==this.to)return this.done=!0,this;this.flat=Fi.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}}typeof Symbol!="undefined"&&(_m.prototype[Symbol.iterator]=Qm.prototype[Symbol.iterator]=function(){return this});function ZS(n){try{return new RegExp(n,tc),!0}catch{return!1}}function ic(n){let e=Le("input",{class:"cm-textfield",name:"line"}),t=Le("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),n.dispatch({effects:Xs.of(!1)}),n.focus()):r.keyCode==13&&(r.preventDefault(),i())},onsubmit:r=>{r.preventDefault(),i()}},Le("label",n.state.phrase("Go to line"),": ",e)," ",Le("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function i(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!r)return;let{state:s}=n,o=s.doc.lineAt(s.selection.main.head),[,l,a,c,u]=r,h=c?+c.slice(1):0,d=a?+a:o.number;if(a&&u){let p=d/100;l&&(p=p*(l=="-"?-1:1)+o.number/s.doc.lines),d=Math.round(s.doc.lines*p)}else a&&l&&(d=d*(l=="-"?-1:1)+o.number);let m=s.doc.line(Math.max(1,Math.min(s.doc.lines,d)));n.dispatch({effects:Xs.of(!1),selection:T.cursor(m.from+Math.max(0,Math.min(h,m.length))),scrollIntoView:!0}),n.focus()}return{dom:t,pos:-10}}const Xs=ue.define(),ep=qe.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(Xs)&&(n=t.value);return n},provide:n=>Oi.from(n,e=>e?ic:null)}),qS=n=>{let e=gr(n,ic);if(!e){let t=[Xs.of(!0)];n.state.field(ep,!1)==null&&t.push(ue.appendConfig.of([ep,KS])),n.dispatch({effects:t}),e=gr(n,ic)}return e&&e.dom.querySelector("input").focus(),!0},KS=_.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),GS={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!0},tp=ne.define({combine(n){return dn(n,GS,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function JS(n){let e=[eC,QS];return n&&e.push(tp.of(n)),e}const YS=te.mark({class:"cm-selectionMatch"}),XS=te.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function np(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=mt.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=mt.Word)}function _S(n,e,t,i){return n(e.sliceDoc(t,t+1))==mt.Word&&n(e.sliceDoc(i-1,i))==mt.Word}const QS=Ue.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(tp),{state:t}=n,i=t.selection;if(i.ranges.length>1)return te.none;let r=i.main,s,o=null;if(r.empty){if(!e.highlightWordAroundCursor)return te.none;let a=t.wordAt(r.head);if(!a)return te.none;o=t.charCategorizer(r.head),s=t.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return te.none;if(e.wholeWords){if(s=t.sliceDoc(r.from,r.to),o=t.charCategorizer(r.head),!(np(o,t,r.from,r.to)&&_S(o,t,r.from,r.to)))return te.none}else if(s=t.sliceDoc(r.from,r.to).trim(),!s)return te.none}let l=[];for(let a of n.visibleRanges){let c=new Mi(t.doc,s,a.from,a.to);for(;!c.next().done;){let{from:u,to:h}=c.value;if((!o||np(o,t,u,h))&&(r.empty&&u<=r.from&&h>=r.to?l.push(XS.range(u,h)):(u>=r.to||h<=r.from)&&l.push(YS.range(u,h)),l.length>e.maxMatches))return te.none}}return te.set(l)}},{decorations:n=>n.decorations}),eC=_.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),tC=({state:n,dispatch:e})=>{let{selection:t}=n,i=T.create(t.ranges.map(r=>n.wordAt(r.head)||T.cursor(r.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function nC(n,e){let{main:t,ranges:i}=n.selection,r=n.wordAt(t.head),s=r&&r.from==t.from&&r.to==t.to;for(let o=!1,l=new Mi(n.doc,e,i[i.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new Mi(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(a=>a.from==l.value.from))continue;if(s){let a=n.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const iC=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return tC({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=i))return!1;let r=nC(n,i);return r?(e(n.update({selection:n.selection.addRange(T.range(r.from,r.to),!1),effects:_.scrollIntoView(r.to)})),!0):!1},_s=ne.define({combine(n){var e;return{top:n.reduce((t,i)=>t!=null?t:i.top,void 0)||!1,caseSensitive:n.reduce((t,i)=>t!=null?t:i.caseSensitive||i.matchCase,void 0)||!1,createPanel:((e=n.find(t=>t.createPanel))===null||e===void 0?void 0:e.createPanel)||(t=>new dC(t))}}});function uA(n){return n?[_s.of(n),ac]:ac}const hA=null;class ip{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||ZS(this.search)),this.unquoted=this.search.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp}create(){return this.regexp?new sC(this):new rC(this)}getCursor(e,t=0,i=e.length){return this.regexp?Ri(this,e,t,i):Bi(this,e,t,i)}}class rp{constructor(e){this.spec=e}}function Bi(n,e,t,i){return new Mi(e,n.unquoted,t,i,n.caseSensitive?void 0:r=>r.toLowerCase())}class rC extends rp{constructor(e){super(e)}nextMatch(e,t,i){let r=Bi(this.spec,e,i,e.length).nextOverlapping();return r.done&&(r=Bi(this.spec,e,0,t).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=i;;){let s=Math.max(t,r-1e4-this.spec.unquoted.length),o=Bi(this.spec,e,s,r),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;r-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace}matchAll(e,t){let i=Bi(this.spec,e,0,e.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=Bi(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function Ri(n,e,t,i){return new _m(e,n.search,n.caseSensitive?void 0:{ignoreCase:!0},t,i)}class sC extends rp{nextMatch(e,t,i){let r=Ri(this.spec,e,i,e.length).next();return r.done&&(r=Ri(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,i){for(let r=1;;r++){let s=Math.max(t,i-r*1e4),o=Ri(this.spec,e,s,i),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace.replace(/\$([$&\d+])/g,(t,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:t)}matchAll(e,t){let i=Ri(this.spec,e,0,e.length),r=[];for(;!i.next().done;){if(r.length>=t)return null;r.push(i.value)}return r}highlight(e,t,i,r){let s=Ri(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const Er=ue.define(),rc=ue.define(),gn=qe.define({create(n){return new sc(to(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Er)?n=new sc(t.value.create(),n.panel):t.is(rc)&&(n=new sc(n.query,t.value?oc:null));return n},provide:n=>Oi.from(n,e=>e.panel)});function fA(n){let e=n.field(gn,!1);return e?e.query.spec:to(n)}class sc{constructor(e,t){this.query=e,this.panel=t}}const oC=te.mark({class:"cm-searchMatch"}),lC=te.mark({class:"cm-searchMatch cm-searchMatch-selected"}),aC=Ue.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(gn))}update(n){let e=n.state.field(gn);(e!=n.startState.field(gn)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return te.none;let{view:t}=this,i=new Tn;for(let r=0,s=t.visibleRanges,o=s.length;r<o;r++){let{from:l,to:a}=s[r];for(;r<o-1&&a>s[r+1].from-2*250;)a=s[++r].to;n.highlight(t.state.doc,l,a,(c,u)=>{let h=t.state.selection.ranges.some(d=>d.from==c&&d.to==u);i.add(c,u,h?lC:oC)})}return i.finish()}},{decorations:n=>n.decorations});function Pr(n){return e=>{let t=e.state.field(gn,!1);return t&&t.query.spec.valid?n(e,t):op(e)}}const Qs=Pr((n,{query:e})=>{let{from:t,to:i}=n.state.selection.main,r=e.nextMatch(n.state.doc,t,i);return!r||r.from==t&&r.to==i?!1:(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:lc(n,r),userEvent:"select.search"}),!0)}),eo=Pr((n,{query:e})=>{let{state:t}=n,{from:i,to:r}=t.selection.main,s=e.prevMatch(t.doc,i,r);return s?(n.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:lc(n,s),userEvent:"select.search"}),!0):!1}),cC=Pr((n,{query:e})=>{let t=e.matchAll(n.state.doc,1e3);return!t||!t.length?!1:(n.dispatch({selection:T.create(t.map(i=>T.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),uC=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:r}=t.main,s=[],o=0;for(let l=new Mi(n.doc,n.sliceDoc(i,r));!l.next().done;){if(s.length>1e3)return!1;l.value.from==i&&(o=s.length),s.push(T.range(l.value.from,l.value.to))}return e(n.update({selection:T.create(s,o),userEvent:"select.search.matches"})),!0},sp=Pr((n,{query:e})=>{let{state:t}=n,{from:i,to:r}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t.doc,i,i);if(!s)return!1;let o=[],l,a;if(s.from==i&&s.to==r&&(a=t.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:a}),s=e.nextMatch(t.doc,s.from,s.to)),s){let c=o.length==0||o[0].from>=s.to?0:s.to-s.from-a.length;l={anchor:s.from-c,head:s.to-c}}return n.dispatch({changes:o,selection:l,scrollIntoView:!!l,effects:s?lc(n,s):void 0,userEvent:"input.replace"}),!0}),hC=Pr((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state.doc,1e9).map(i=>{let{from:r,to:s}=i;return{from:r,to:s,insert:e.getReplacement(i)}});return t.length?(n.dispatch({changes:t,userEvent:"input.replace.all"}),!0):!1});function oc(n){return n.state.facet(_s).createPanel(n)}function to(n,e){var t;let i=n.selection.main,r=i.empty||i.to>i.from+100?"":n.sliceDoc(i.from,i.to),s=(t=e==null?void 0:e.caseSensitive)!==null&&t!==void 0?t:n.facet(_s).caseSensitive;return e&&!r?e:new ip({search:r.replace(/\n/g,"\\n"),caseSensitive:s})}const op=n=>{let e=n.state.field(gn,!1);if(e&&e.panel){let t=gr(n,oc);if(!t)return!1;let i=t.dom.querySelector("[name=search]");if(i!=n.root.activeElement){let r=to(n.state,e.query.spec);r.valid&&n.dispatch({effects:Er.of(r)}),i.focus(),i.select()}}else n.dispatch({effects:[rc.of(!0),e?Er.of(to(n.state,e.query.spec)):ue.appendConfig.of(ac)]});return!0},lp=n=>{let e=n.state.field(gn,!1);if(!e||!e.panel)return!1;let t=gr(n,oc);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:rc.of(!1)}),!0},fC=[{key:"Mod-f",run:op,scope:"editor search-panel"},{key:"F3",run:Qs,shift:eo,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Qs,shift:eo,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:lp,scope:"editor search-panel"},{key:"Mod-Shift-l",run:uC},{key:"Alt-g",run:qS},{key:"Mod-d",run:iC,preventDefault:!0}];class dC{constructor(e){this.view=e;let t=this.query=e.state.field(gn).query.spec;this.commit=this.commit.bind(this),this.searchField=Le("input",{value:t.search,placeholder:jt(e,"Find"),"aria-label":jt(e,"Find"),class:"cm-textfield",name:"search",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Le("input",{value:t.replace,placeholder:jt(e,"Replace"),"aria-label":jt(e,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=Le("input",{type:"checkbox",name:"case",checked:t.caseSensitive,onchange:this.commit}),this.reField=Le("input",{type:"checkbox",name:"re",checked:t.regexp,onchange:this.commit});function i(r,s,o){return Le("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=Le("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,i("next",()=>Qs(e),[jt(e,"next")]),i("prev",()=>eo(e),[jt(e,"previous")]),i("select",()=>cC(e),[jt(e,"all")]),Le("label",null,[this.caseField,jt(e,"match case")]),Le("label",null,[this.reField,jt(e,"regexp")]),...e.state.readOnly?[]:[Le("br"),this.replaceField,i("replace",()=>sp(e),[jt(e,"replace")]),i("replaceAll",()=>hC(e),[jt(e,"replace all")]),Le("button",{name:"close",onclick:()=>lp(e),"aria-label":jt(e,"close"),type:"button"},["\xD7"])]])}commit(){let e=new ip({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Er.of(e)}))}keydown(e){Gw(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?eo:Qs)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),sp(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(Er)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(_s).top}}function jt(n,e){return n.state.phrase(e)}const no=30,io=/[\s\.,:;?!]/;function lc(n,{from:e,to:t}){let i=n.state.doc.lineAt(e).from,r=n.state.doc.lineAt(t).to,s=Math.max(i,e-no),o=Math.min(r,t+no),l=n.state.sliceDoc(s,o);if(s!=i){for(let a=0;a<no;a++)if(!io.test(l[a+1])&&io.test(l[a])){l=l.slice(a);break}}if(o!=r){for(let a=l.length-1;a>l.length-no;a--)if(!io.test(l[a-1])&&io.test(l[a])){l=l.slice(0,a);break}}return _.announce.of(`${n.state.phrase("current match")}. ${l} ${n.state.phrase("on line")} ${n.state.doc.lineAt(e).number}`)}const mC=_.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),ac=[gn,vi.lowest(aC),mC],pC=typeof navigator!="undefined"&&!/Edge\/(\d+)/.exec(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),cc="-10000px";class ap{constructor(e,t,i){this.facet=t,this.createTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(r=>r),this.tooltipViews=this.tooltips.map(i)}update(e){let t=e.state.facet(this.facet),i=t.filter(s=>s);if(t===this.input){for(let s of this.tooltipViews)s.update&&s.update(e);return!1}let r=[];for(let s=0;s<i.length;s++){let o=i[s],l=-1;if(!!o){for(let a=0;a<this.tooltips.length;a++){let c=this.tooltips[a];c&&c.create==o.create&&(l=a)}if(l<0)r[s]=this.createTooltipView(o);else{let a=r[s]=this.tooltipViews[l];a.update&&a.update(e)}}}for(let s of this.tooltipViews)r.indexOf(s)<0&&s.dom.remove();return this.input=t,this.tooltips=i,this.tooltipViews=r,!0}}function dA(n={}){return ro.of(n)}function gC(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const ro=ne.define({combine:n=>{var e,t,i;return{position:pC?"absolute":((e=n.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(r=>r.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||gC}}}),uc=Ue.fromClass(class{constructor(n){var e;this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let t=n.state.facet(ro);this.position=t.position,this.parent=t.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new ap(n,so,i=>this.createTooltip(i)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(i=>{Date.now()>this.lastTransaction-50&&i.length>0&&i[i.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),(e=n.dom.ownerDocument.defaultView)===null||e===void 0||e.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(ro);if(i.position!=this.position){this.position=i.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n){let e=n.create(this.view);if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=cc,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var n,e;(n=this.view.dom.ownerDocument.defaultView)===null||n===void 0||n.removeEventListener("resize",this.measureSoon);for(let{dom:t}of this.manager.tooltipViews)t.remove();(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((e,t)=>{let i=this.manager.tooltipViews[t];return i.getCoords?i.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(ro).tooltipSpace(this.view)}}writeMeasure(n){let{editor:e,space:t}=n,i=[];for(let r=0;r<this.manager.tooltips.length;r++){let s=this.manager.tooltips[r],o=this.manager.tooltipViews[r],{dom:l}=o,a=n.pos[r],c=n.size[r];if(!a||a.bottom<=Math.max(e.top,t.top)||a.top>=Math.min(e.bottom,t.bottom)||a.right<Math.max(e.left,t.left)-.1||a.left>Math.min(e.right,t.right)+.1){l.style.top=cc;continue}let u=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,h=u?7:0,d=c.right-c.left,m=c.bottom-c.top,p=o.offset||vC,y=this.view.textDirection==xe.LTR,b=c.width>t.right-t.left?y?t.left:t.right-c.width:y?Math.min(a.left-(u?14:0)+p.x,t.right-d):Math.max(t.left,a.left-d+(u?14:0)-p.x),v=!!s.above;!s.strictSide&&(v?a.top-(c.bottom-c.top)-p.y<t.top:a.bottom+(c.bottom-c.top)+p.y>t.bottom)&&v==t.bottom-a.bottom>a.top-t.top&&(v=!v);let C=v?a.top-m-h-p.y:a.bottom+h+p.y,x=b+d;if(o.overlap!==!0)for(let k of i)k.left<x&&k.right>b&&k.top<C+m&&k.bottom>C&&(C=v?k.top-m-2-h:k.bottom+h+2);this.position=="absolute"?(l.style.top=C-n.parent.top+"px",l.style.left=b-n.parent.left+"px"):(l.style.top=C+"px",l.style.left=b+"px"),u&&(u.style.left=`${a.left+(y?p.x:-p.x)-(b+14-7)}px`),o.overlap!==!0&&i.push({left:b,top:C,right:x,bottom:C+m}),l.classList.toggle("cm-tooltip-above",v),l.classList.toggle("cm-tooltip-below",!v),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=cc}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),yC=_.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),vC={x:0,y:0},so=ne.define({enables:[uc,yC]}),Dr=ne.define();class hc{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new ap(e,Dr,t=>this.createHostedView(t))}static create(e){return new hc(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned()}update(e){this.manager.update(e)}}const bC=so.compute([Dr],n=>{let e=n.facet(Dr).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:hc.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class wC{constructor(e,t,i,r,s){this.view=e,this.source=t,this.field=i,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){var e;clearTimeout(this.restartTimeout);let{lastMove:t}=this,i=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(i==null)return;let r=this.view.coordsAtPos(i);if(r==null||t.y<r.top||t.y>r.bottom||t.x<r.left-this.view.defaultCharacterWidth||t.x>r.right+this.view.defaultCharacterWidth)return;let s=this.view.bidiSpans(this.view.state.doc.lineAt(i)).find(a=>a.from<=i&&a.to>=i),o=s&&s.dir==xe.RTL?-1:1,l=this.source(this.view,i,t.x<r.left?-o:o);if(!((e=l)===null||e===void 0)&&e.then){let a=this.pending={pos:i};l.then(c=>{this.pending==a&&(this.pending=null,c&&this.view.dispatch({effects:this.setHover.of(c)}))},c=>Dt(this.view.state,c,"hover tooltip"))}else l&&this.view.dispatch({effects:this.setHover.of(l)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!xC(this.lastMove.target)||this.pending){let{pos:r}=i||this.pending,s=(t=i==null?void 0:i.end)!==null&&t!==void 0?t:r;(r==s?this.view.posAtCoords(this.lastMove)!=r:!SC(this.view,r,s,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function xC(n){for(let e=n;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function SC(n,e,t,i,r,s){let o=document.createRange(),l=n.domAtPos(e),a=n.domAtPos(t);o.setEnd(a.node,a.offset),o.setStart(l.node,l.offset);let c=o.getClientRects();o.detach();for(let u=0;u<c.length;u++){let h=c[u];if(Math.max(h.top-r,r-h.bottom,h.left-i,i-h.right)<=s)return!0}return!1}function CC(n,e={}){let t=ue.define(),i=qe.define({create(){return null},update(r,s){if(r&&e.hideOnChange&&(s.docChanged||s.selection))return null;for(let o of s.effects){if(o.is(t))return o.value;if(o.is(OC))return null}if(r&&s.docChanged){let o=s.changes.mapPos(r.pos,-1,ft.TrackDel);if(o==null)return null;let l=Object.assign(Object.create(null),r);return l.pos=o,r.end!=null&&(l.end=s.changes.mapPos(r.end)),l}return r},provide:r=>Dr.from(r)});return[i,Ue.define(r=>new wC(r,n,i,t,e.hoverTime||300)),bC]}function kC(n,e){let t=n.plugin(uc);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}function mA(n){return n.facet(Dr).some(e=>e)}const OC=ue.define(),pA=null;function gA(n){var e;(e=n.plugin(uc))===null||e===void 0||e.maybeMeasure()}class AC{constructor(e,t,i){this.state=e,this.pos=t,this.explicit=i,this.abortListeners=[]}tokenBefore(e){let t=yt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),r=t.text.slice(i-t.from,this.pos-t.from),s=r.search(hp(e,!1));return s<0?null:{from:i+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}}function cp(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function EC(n){let e=Object.create(null),t=Object.create(null);for(let{label:r}of n){e[r[0]]=!0;for(let s=1;s<r.length;s++)t[r[s]]=!0}let i=cp(e)+cp(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function PC(n){let e=n.map(r=>typeof r=="string"?{label:r}:r),[t,i]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:EC(e);return r=>{let s=r.matchBefore(i);return s||r.explicit?{from:s?s.from:r.pos,options:e,span:t}:null}}function yA(n,e){return t=>{for(let i=syntaxTree(t.state).resolveInner(t.pos,-1);i;i=i.parent)if(n.indexOf(i.name)>-1)return e(t);return null}}function vA(n,e){return t=>{for(let i=syntaxTree(t.state).resolveInner(t.pos,-1);i;i=i.parent)if(n.indexOf(i.name)>-1)return null;return e(t)}}class up{constructor(e,t,i){this.completion=e,this.source=t,this.match=i}}function ri(n){return n.selection.main.head}function hp(n,e){var t;let{source:i}=n,r=e&&i[0]!="^",s=i[i.length-1]!="$";return!r&&!s?n:new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const DC=Pn.define();function fp(n,e){let t=e.completion.apply||e.completion.label,i=e.source;typeof t=="string"?n.dispatch({changes:{from:i.from,to:i.to,insert:t},selection:{anchor:i.from+t.length},userEvent:"input.complete",annotations:DC.of(e.completion)}):t(n,e.completion,i.from,i.to)}const dp=new WeakMap;function TC(n){if(!Array.isArray(n))return n;let e=dp.get(n);return e||dp.set(n,e=PC(n)),e}class MC{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let i=ot(e,t),r=It(i);this.chars.push(i);let s=e.slice(t,t+r),o=s.toUpperCase();this.folded.push(ot(o==s?s.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:r,precise:s,byWord:o}=this;if(t.length==1){let C=ot(e,0);return C==t[0]?[0,0,It(C)]:C==i[0]?[-200,0,It(C)]:null}let l=e.indexOf(this.pattern);if(l==0)return[0,0,this.pattern.length];let a=t.length,c=0;if(l<0){for(let C=0,x=Math.min(e.length,200);C<x&&c<a;){let k=ot(e,C);(k==t[c]||k==i[c])&&(r[c++]=C),C+=It(k)}if(c<a)return null}let u=0,h=0,d=!1,m=0,p=-1,y=-1,b=/[a-z]/.test(e),v=!0;for(let C=0,x=Math.min(e.length,200),k=0;C<x&&h<a;){let w=ot(e,C);l<0&&(u<a&&w==t[u]&&(s[u++]=C),m<a&&(w==t[m]||w==i[m]?(m==0&&(p=C),y=C+1,m++):m=0));let O,F=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(O=Cl(w))!=O.toLowerCase()?1:O!=O.toUpperCase()?2:0;(!C||F==1&&b||k==0&&F!=0)&&(t[h]==w||i[h]==w&&(d=!0)?o[h++]=C:o.length&&(v=!1)),k=F,C+=It(w)}return h==a&&o[0]==0&&v?this.result(-100+(d?-200:0),o,e):m==a&&p==0?[-200-e.length,0,y]:l>-1?[-700-e.length,l,l+this.pattern.length]:m==a?[-200+-700-e.length,p,y]:h==a?this.result(-100+(d?-200:0)+-700+(v?0:-1100),o,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,i){let r=[e-i.length],s=1;for(let o of t){let l=o+(this.astral?It(ot(i,o)):1);s>1&&r[s-1]==o?r[s-1]=l:(r[s++]=o,r[s++]=l)}return r}}const si=ne.define({combine(n){return dn(n,{activateOnTyping:!0,override:null,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(e,t)=>e&&t,icons:(e,t)=>e&&t,optionClass:(e,t)=>i=>FC(e(i),t(i)),addToOptions:(e,t)=>e.concat(t)})}});function FC(n,e){return n?e?n+" "+e:n:e}function BC(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,r){let s=document.createElement("span");s.className="cm-completionLabel";let{label:o}=t,l=0;for(let a=1;a<r.length;){let c=r[a++],u=r[a++];c>l&&s.appendChild(document.createTextNode(o.slice(l,c)));let h=s.appendChild(document.createElement("span"));h.appendChild(document.createTextNode(o.slice(c,u))),h.className="cm-completionMatchedText",l=u}return l<o.length&&s.appendChild(document.createTextNode(o.slice(l))),s},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function mp(n,e,t){if(n<=t)return{from:0,to:n};if(e<=n>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class RC{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:l=>this.positionInfo(l),key:this};let i=e.state.field(t),{options:r,selected:s}=i.open,o=e.state.facet(si);this.optionContent=BC(o),this.optionClass=o.optionClass,this.range=mp(r.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",l=>{for(let a=l.target,c;a&&a!=this.dom;a=a.parentNode)if(a.nodeName=="LI"&&(c=/-(\d+)$/.exec(a.id))&&+c[1]<r.length){fp(e,r[+c[1]]),l.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(r,i.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(e){e.state.field(this.stateField)!=e.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=mp(t.options.length,t.selected,this.view.state.facet(si).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:i}=t.options[t.selected],{info:r}=i;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(i);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o)}).catch(o=>Dt(this.view.state,o,"completion info")):this.addInfoPane(s)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,r=this.range.from;i;i=i.nextSibling,r++)r==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&LC(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),r=e.getBoundingClientRect();if(r.top>Math.min(innerHeight,t.bottom)-10||r.bottom<Math.max(0,t.top)+10)return null;let s=Math.max(0,Math.min(r.top,innerHeight-i.height))-t.top,o=this.view.textDirection==xe.RTL,l=t.left,a=innerWidth-t.right;return o&&l<Math.min(i.width,a)?o=!1:!o&&a<Math.min(i.width,l)&&(o=!0),{top:s,left:o}}positionInfo(e){this.info&&(this.info.style.top=(e?e.top:-1e6)+"px",e&&(this.info.classList.toggle("cm-completionInfo-left",e.left),this.info.classList.toggle("cm-completionInfo-right",!e.left)))}createListBox(e,t,i){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true");for(let s=i.from;s<i.to;s++){let{completion:o,match:l}=e[s];const a=r.appendChild(document.createElement("li"));a.id=t+"-"+s,a.setAttribute("role","option");let c=this.optionClass(o);c&&(a.className=c);for(let u of this.optionContent){let h=u(o,this.view.state,l);h&&a.appendChild(h)}}return i.from&&r.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}}function IC(n){return e=>new RC(e,n)}function LC(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect();i.top<t.top?n.scrollTop-=t.top-i.top:i.bottom>t.bottom&&(n.scrollTop+=i.bottom-t.bottom)}const NC=300;function pp(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function WC(n,e){let t=[],i=0;for(let o of n)if(o.hasResult())if(o.result.filter===!1)for(let l of o.result.options)t.push(new up(l,o,[1e9-i++]));else{let l=new MC(e.sliceDoc(o.from,o.to)),a;for(let c of o.result.options)(a=l.match(c.label))&&(c.boost!=null&&(a[0]+=c.boost),t.push(new up(c,o,a)))}let r=[],s=null;for(let o of t.sort(HC)){if(r.length==NC)break;!s||s.label!=o.completion.label||s.detail!=o.completion.detail||s.type!=o.completion.type||s.apply!=o.completion.apply?r.push(o):pp(o.completion)>pp(s)&&(r[r.length-1]=o),s=o.completion}return r}class Tr{constructor(e,t,i,r,s){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=r,this.selected=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Tr(this.options,gp(t,e),this.tooltip,this.timestamp,e)}static build(e,t,i,r,s){let o=WC(e,t);if(!o.length)return null;let l=0;if(r&&r.selected){let a=r.options[r.selected].completion;for(let c=0;c<o.length;c++)if(o[c].completion==a){l=c;break}}return new Tr(o,gp(i,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:IC(vt),above:s.aboveCursor},r?r.timestamp:Date.now(),l)}map(e){return new Tr(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class oo{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new oo($C,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(si),s=(i.override||t.languageDataAt("autocomplete",ri(t)).map(TC)).map(l=>(this.active.find(c=>c.source==l)||new St(l,this.active.some(c=>c.state!=0)?1:0)).update(e,i));s.length==this.active.length&&s.every((l,a)=>l==this.active[a])&&(s=this.active);let o=e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!jC(s,this.active)?Tr.build(s,t,this.id,this.open,i):this.open&&e.docChanged?this.open.map(e.changes):this.open;!o&&s.every(l=>l.state!=1)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new St(l.source,0):l));for(let l of e.effects)l.is(pc)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new oo(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:VC}}function jC(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult;)t++;for(;i<e.length&&!e[i].hasResult;)i++;let r=t==n.length,s=i==e.length;if(r||s)return r==s;if(n[t++].result!=e[i++].result)return!1}}const VC={"aria-autocomplete":"list"};function gp(n,e){return{"aria-autocomplete":"list","aria-haspopup":"listbox","aria-activedescendant":n+"-"+e,"aria-controls":n}}const $C=[];function HC(n,e){let t=e.match[0]-n.match[0];return t||n.completion.label.localeCompare(e.completion.label)}function fc(n){return n.isUserEvent("input.type")?"input":n.isUserEvent("delete.backward")?"delete":null}class St{constructor(e,t,i=-1){this.source=e,this.state=t,this.explicitPos=i}hasResult(){return!1}update(e,t){let i=fc(e),r=this;i?r=r.handleUserEvent(e,i,t):e.docChanged?r=r.handleChange(e):e.selection&&r.state!=0&&(r=new St(r.source,0));for(let s of e.effects)if(s.is(dc))r=new St(r.source,1,s.value?ri(e.state):-1);else if(s.is(mc))r=new St(r.source,0);else if(s.is(yp))for(let o of s.value)o.source==r.source&&(r=o);return r}handleUserEvent(e,t,i){return t=="delete"||!i.activateOnTyping?this.map(e.changes):new St(this.source,1)}handleChange(e){return e.changes.touchesRange(ri(e.startState))?new St(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new St(this.source,this.state,e.mapPos(this.explicitPos))}}class lo extends St{constructor(e,t,i,r,s,o){super(e,2,t),this.result=i,this.from=r,this.to=s,this.span=o}hasResult(){return!0}handleUserEvent(e,t,i){let r=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),o=ri(e.state);if((this.explicitPos<0?o<=r:o<this.from)||o>s||t=="delete"&&ri(e.startState)==this.from)return new St(this.source,t=="input"&&i.activateOnTyping?1:0);let l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return this.span&&(r==s||this.span.test(e.state.sliceDoc(r,s)))?new lo(this.source,l,this.result,r,s,this.span):new St(this.source,1,l)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new St(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new lo(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1),this.span)}}const dc=ue.define(),mc=ue.define(),yp=ue.define({map(n,e){return n.map(t=>t.map(e))}}),pc=ue.define(),vt=qe.define({create(){return oo.start()},update(n,e){return n.update(e)},provide:n=>[so.from(n,e=>e.tooltip),_.contentAttributes.from(n,e=>e.attrs)]}),vp=75;function ao(n,e="option"){return t=>{let i=t.state.field(vt,!1);if(!i||!i.open||Date.now()-i.open.timestamp<vp)return!1;let r=1,s;e=="page"&&(s=kC(t,i.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let o=i.open.selected+r*(n?1:-1),{length:l}=i.open.options;return o<0?o=e=="page"?0:l-1:o>=l&&(o=e=="page"?l-1:0),t.dispatch({effects:pc.of(o)}),!0}}const UC=n=>{let e=n.state.field(vt,!1);return n.state.readOnly||!e||!e.open||Date.now()-e.open.timestamp<vp?!1:(fp(n,e.open.options[e.open.selected]),!0)},zC=n=>n.state.field(vt,!1)?(n.dispatch({effects:dc.of(!0)}),!0):!1,ZC=n=>{let e=n.state.field(vt,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:mc.of(null)}),!0)};class qC{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const bp=50,KC=50,GC=1e3,JC=Ue.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of n.state.field(vt).active)e.state==1&&this.startQuery(e)}update(n){let e=n.state.field(vt);if(!n.selectionSet&&!n.docChanged&&n.startState.field(vt)==e)return;let t=n.transactions.some(i=>(i.selection||i.docChanged)&&!fc(i));for(let i=0;i<this.running.length;i++){let r=this.running[i];if(t||r.updates.length+n.transactions.length>KC&&Date.now()-r.time>GC){for(let s of r.context.abortListeners)try{s()}catch(o){Dt(this.view.state,o)}r.context.abortListeners=null,this.running.splice(i--,1)}else r.updates.push(...n.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(i=>i.state==1&&!this.running.some(r=>r.active.source==i.source))?setTimeout(()=>this.startUpdate(),bp):-1,this.composing!=0)for(let i of n.transactions)fc(i)=="input"?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:n}=this.view,e=n.field(vt);for(let t of e.active)t.state==1&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t)}startQuery(n){let{state:e}=this.view,t=ri(e),i=new AC(e,t,n.explicitPos==t),r=new qC(n,i);this.running.push(r),Promise.resolve(n.source(i)).then(s=>{r.context.aborted||(r.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:mc.of(null)}),Dt(this.view.state,s)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),bp))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(si);for(let i=0;i<this.running.length;i++){let r=this.running[i];if(r.done===void 0)continue;if(this.running.splice(i--,1),r.done){let o=new lo(r.active.source,r.active.explicitPos,r.done,r.done.from,(n=r.done.to)!==null&&n!==void 0?n:ri(r.updates.length?r.updates[0].startState:this.view.state),r.done.span&&r.done.filter!==!1?hp(r.done.span,!0):null);for(let l of r.updates)o=o.update(l,t);if(o.hasResult()){e.push(o);continue}}let s=this.view.state.field(vt).active.find(o=>o.source==r.active.source);if(s&&s.state==1)if(r.done==null){let o=new St(r.active.source,0);for(let l of r.updates)o=o.update(l,t);o.state!=1&&e.push(o)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:yp.of(e)})}},{eventHandlers:{compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:dc.of(!1)}),20),this.composing=0}}}),wp=_.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class YC{constructor(e,t,i,r){this.field=e,this.line=t,this.from=i,this.to=r}}class gc{constructor(e,t,i){this.field=e,this.from=t,this.to=i}map(e){let t=e.mapPos(this.from,-1,MapMode.TrackDel),i=e.mapPos(this.to,1,MapMode.TrackDel);return t==null||i==null?null:new gc(this.field,t,i)}}class yc{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],r=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let a of this.lines){if(i.length){let c=o,u=/^\t*/.exec(a)[0].length;for(let h=0;h<u;h++)c+=e.facet(indentUnit);r.push(t+c.length-u),a=c+a.slice(u)}i.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new gc(a.field,r[a.line]+a.from,r[a.line]+a.to));return{text:i,ranges:l}}static parse(e){let t=[],i=[],r=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(o);){let l=s[1]?+s[1]:null,a=s[2]||s[3]||"",c=-1;for(let u=0;u<t.length;u++)(l!=null?t[u].seq==l:a?t[u].name==a:!1)&&(c=u);if(c<0){let u=0;for(;u<t.length&&(l==null||t[u].seq!=null&&t[u].seq<l);)u++;t.splice(u,0,{seq:l,name:a}),c=u;for(let h of r)h.field>=c&&h.field++}r.push(new YC(c,i.length,s.index,s.index+a.length)),o=o.slice(0,s.index)+a+o.slice(s.index+s[0].length)}i.push(o)}return new yc(i,r)}}let XC=te.widget({widget:new class extends Jt{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),_C=te.mark({class:"cm-snippetField"});class Ii{constructor(e,t){this.ranges=e,this.active=t,this.deco=te.set(e.map(i=>(i.from==i.to?XC:_C).range(i.from,i.to)))}map(e){let t=[];for(let i of this.ranges){let r=i.map(e);if(!r)return null;t.push(r)}return new Ii(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(i=>i.field==this.active&&i.from<=t.from&&i.to>=t.to))}}const Mr=ue.define({map(n,e){return n&&n.map(e)}}),QC=ue.define(),Fr=qe.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(Mr))return t.value;if(t.is(QC)&&n)return new Ii(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>_.decorations.from(n,e=>e?e.deco:te.none)});function vc(n,e){return T.create(n.filter(t=>t.field==e).map(t=>T.range(t.from,t.to)))}function ek(n){let e=yc.parse(n);return(t,i,r,s)=>{let{text:o,ranges:l}=e.instantiate(t.state,r),a={changes:{from:r,to:s,insert:Text.of(o)}};if(l.length&&(a.selection=vc(l,0)),l.length>1){let c=new Ii(l,0),u=a.effects=[Mr.of(c)];t.state.field(Fr,!1)===void 0&&u.push(StateEffect.appendConfig.of([Fr,nk,ik,wp]))}t.dispatch(t.state.update(a))}}function xp(n){return({state:e,dispatch:t})=>{let i=e.field(Fr,!1);if(!i||n<0&&i.active==0)return!1;let r=i.active+n,s=n>0&&!i.ranges.some(o=>o.field==r+n);return t(e.update({selection:vc(i.ranges,r),effects:Mr.of(s?null:new Ii(i.ranges,r))})),!0}}const tk=[{key:"Tab",run:xp(1),shift:xp(-1)},{key:"Escape",run:({state:n,dispatch:e})=>n.field(Fr,!1)?(e(n.update({effects:Mr.of(null)})),!0):!1}],Sp=ne.define({combine(n){return n.length?n[0]:tk}}),nk=vi.highest(dr.compute([Sp],n=>n.facet(Sp)));function SA(n,e){return Object.assign(Object.assign({},e),{apply:ek(n)})}const ik=_.domEventHandlers({mousedown(n,e){let t=e.state.field(Fr,!1),i;if(!t||(i=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let r=t.ranges.find(s=>s.from<=i&&s.to>=i);return!r||r.field==t.active?!1:(e.dispatch({selection:vc(t.ranges,r.field),effects:Mr.of(t.ranges.some(s=>s.field>r.field)?new Ii(t.ranges,r.field):null)}),!0)}});function rk(n){let e=n.replace(/[\\[.+*?(){|^$]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${e}]+`,"ug")}catch{return new RegExp(`[w${e}]`,"g")}}function Cp(n,e){return new RegExp(e(n.source),n.unicode?"u":"")}const kp=null;function sk(n){return kp[n]||(kp[n]=new WeakMap)}function Op(n,e,t,i,r){for(let s=n.iterLines(),o=0;!s.next().done;){let{value:l}=s,a;for(e.lastIndex=0;a=e.exec(l);)if(!i[a[0]]&&o+a.index!=r&&(t.push({type:"text",label:a[0]}),i[a[0]]=!0,t.length>=2e3))return;o+=l.length+1}}function Ap(n,e,t,i,r){let s=n.length>=1e3,o=s&&e.get(n);if(o)return o;let l=[],a=Object.create(null);if(n.children){let c=0;for(let u of n.children){if(u.length>=1e3)for(let h of Ap(u,e,t,i-c,r-c))a[h.label]||(a[h.label]=!0,l.push(h));else Op(u,t,l,a,r-c);c+=u.length+1}}else Op(n,t,l,a,r);return s&&l.length<2e3&&e.set(n,l),l}const CA=n=>{let e=n.state.languageDataAt("wordChars",n.pos).join(""),t=rk(e),i=n.matchBefore(Cp(t,o=>o+"$"));if(!i&&!n.explicit)return null;let r=i?i.from:n.pos,s=Ap(n.state.doc,sk(e),t,5e4,r);return{from:r,options:s,span:Cp(t,o=>"^"+o)}};function ok(n={}){return[vt,si.of(n),JC,lk,wp]}const Ep=[{key:"Ctrl-Space",run:zC},{key:"Escape",run:ZC},{key:"ArrowDown",run:ao(!0)},{key:"ArrowUp",run:ao(!1)},{key:"PageDown",run:ao(!0,"page")},{key:"PageUp",run:ao(!1,"page")},{key:"Enter",run:UC}],lk=vi.highest(dr.computeN([si],n=>n.facet(si).defaultKeymap?[Ep]:[]));function kA(n){let e=n.field(vt,!1);return e&&e.active.some(t=>t.state==1)?"pending":e&&e.active.some(t=>t.state!=0)?"active":null}const Pp=new WeakMap;function OA(n){var e;let t=(e=n.field(vt,!1))===null||e===void 0?void 0:e.open;if(!t)return[];let i=Pp.get(t.options);return i||Pp.set(t.options,i=t.options.map(r=>r.completion)),i}function AA(n){var e;let t=(e=n.field(vt,!1))===null||e===void 0?void 0:e.open;return t?t.options[t.selected].completion:null}function EA(n){var e;let t=(e=n.field(vt,!1))===null||e===void 0?void 0:e.open;return t?t.selected:null}function PA(n){return pc.of(n)}const ak=n=>{let e=wc(n.state);return e.line?ck(n):e.block?hk(n):!1};function bc(n,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let r=n(e,t);return r?(i(t.update(r)),!0):!1}}const ck=bc(pk,0),DA=null,TA=null,uk=bc(Dp,0),MA=null,FA=null,hk=bc((n,e)=>Dp(n,e,mk(e)),0),fk=[{key:"Mod-/",run:ak},{key:"Alt-A",run:uk}];function wc(n,e=n.selection.main.head){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Br=50;function dk(n,{open:e,close:t},i,r){let s=n.sliceDoc(i-Br,i),o=n.sliceDoc(r,r+Br),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,c=s.length-l;if(s.slice(c-e.length,c)==e&&o.slice(a,a+t.length)==t)return{open:{pos:i-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let u,h;r-i<=2*Br?u=h=n.sliceDoc(i,r):(u=n.sliceDoc(i,i+Br),h=n.sliceDoc(r-Br,r));let d=/^\s*/.exec(u)[0].length,m=/\s*$/.exec(h)[0].length,p=h.length-m-t.length;return u.slice(d,d+e.length)==e&&h.slice(p,p+t.length)==t?{open:{pos:i+d+e.length,margin:/\s/.test(u.charAt(d+e.length))?1:0},close:{pos:r-m-t.length,margin:/\s/.test(h.charAt(p-1))?1:0}}:null}function mk(n){let e=[];for(let t of n.selection.ranges){let i=n.doc.lineAt(t.from),r=t.to<=i.to?i:n.doc.lineAt(t.to),s=e.length-1;s>=0&&e[s].to>i.from?e[s].to=r.to:e.push({from:i.from,to:r.to})}return e}function Dp(n,e,t=e.selection.ranges){let i=t.map(s=>wc(e,s.from).block);if(!i.every(s=>s))return null;let r=t.map((s,o)=>dk(e,i[o],s.from,s.to));if(n!=2&&!r.every(s=>s))return{changes:e.changes(t.map((s,o)=>r[o]?[]:[{from:s.from,insert:i[o].open+" "},{from:s.to,insert:" "+i[o].close}]))};if(n!=1&&r.some(s=>s)){let s=[];for(let o=0,l;o<r.length;o++)if(l=r[o]){let a=i[o],{open:c,close:u}=l;s.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+a.close.length})}return{changes:s}}return null}function pk(n,e,t=e.selection.ranges){let i=[],r=-1;for(let{from:s,to:o}of t){let l=i.length,a=1e9;for(let c=s;c<=o;){let u=e.doc.lineAt(c);if(u.from>r&&(s==o||o>u.from)){r=u.from;let h=wc(e,c).line;if(!h)continue;let d=/^\s*/.exec(u.text)[0].length,m=d==u.length,p=u.text.slice(d,d+h.length)==h?d:-1;d<u.text.length&&d<a&&(a=d),i.push({line:u,comment:p,token:h,indent:d,empty:m,single:!1})}c=u.to+1}if(a<1e9)for(let c=l;c<i.length;c++)i[c].indent<i[c].line.text.length&&(i[c].indent=a);i.length==l+1&&(i[l].single=!0)}if(n!=2&&i.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:c,empty:u,single:h}of i)(h||!u)&&s.push({from:l.from+c,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&i.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of i)if(l>=0){let c=o.from+l,u=c+a.length;o.text[u-o.from]==" "&&u++,s.push({from:c,to:u})}return{changes:s}}return null}const xc=2e3;function gk(n,e,t){let i=Math.min(e.line,t.line),r=Math.max(e.line,t.line),s=[];if(e.off>xc||t.off>xc||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=i;a<=r;a++){let c=n.doc.line(a);c.length<=l&&s.push(T.range(c.from+o,c.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=i;a<=r;a++){let c=n.doc.line(a),u=kl(c.text,o,n.tabSize,!0);if(u>-1){let h=kl(c.text,l,n.tabSize);s.push(T.range(c.from+u,c.from+h))}}}return s}function yk(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function Tp(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),r=t-i.from,s=r>xc?-1:r==i.length?yk(n,e.clientX):er(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:s,off:r}}function vk(n,e){let t=Tp(n,e),i=n.state.selection;return t?{update(r){if(r.docChanged){let s=r.changes.mapPos(r.startState.doc.line(t.line).from),o=r.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},i=i.map(r.changes)}},get(r,s,o){let l=Tp(n,r);if(!l)return i;let a=gk(n.state,t,l);return a.length?o?T.create(a.concat(i.ranges)):T.create(a):i}}:null}function bk(n){let e=(n==null?void 0:n.eventFilter)||(t=>t.altKey&&t.button==0);return _.mouseSelectionStyle.of((t,i)=>e(i)?vk(t,i):null)}const wk={Alt:[18,n=>n.altKey],Control:[17,n=>n.ctrlKey],Shift:[16,n=>n.shiftKey],Meta:[91,n=>n.metaKey]},xk={style:"cursor: crosshair"};function Sk(n={}){let[e,t]=wk[n.key||"Alt"],i=Ue.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventHandlers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)}}});return[i,_.contentAttributes.of(r=>{var s;return!((s=r.plugin(i))===null||s===void 0)&&s.isDown?xk:null})]}class Ck{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class oi{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let r=te.set(e.map(s=>s.from==s.to||s.from==s.to-1&&i.doc.lineAt(s.from).to==s.from?te.widget({widget:new Dk(s),diagnostic:s}).range(s.from):te.mark({attributes:{class:"cm-lintRange cm-lintRange-"+s.severity},diagnostic:s}).range(s.from,s.to)),!0);return new oi(r,t,Li(r))}}function Li(n,e=null,t=0){let i=null;return n.between(t,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return i=new Ck(r,s,o.diagnostic),!1}),i}function Mp(n,e){return n.field(Ct,!1)?e:e.concat(ue.appendConfig.of([Ct,_.decorations.compute([Ct],t=>{let{selected:i,panel:r}=t.field(Ct);return!i||!r||i.from==i.to?te.none:te.set([Ok.range(i.from,i.to)])}),CC(Ak),Tk]))}function kk(n,e){return{effects:Mp(n,[Sc.of(e)])}}const Sc=ue.define(),Cc=ue.define(),Fp=ue.define(),Ct=qe.define({create(){return new oi(te.none,null,null)},update(n,e){if(e.docChanged){let t=n.diagnostics.map(e.changes),i=null;if(n.selected){let r=e.changes.mapPos(n.selected.from,1);i=Li(t,n.selected.diagnostic,r)||Li(t,null,r)}n=new oi(t,n.panel,i)}for(let t of e.effects)t.is(Sc)?n=oi.init(t.value,n.panel,e.state):t.is(Cc)?n=new oi(n.diagnostics,t.value?co.open:null,n.selected):t.is(Fp)&&(n=new oi(n.diagnostics,n.panel,t.value));return n},provide:n=>[Oi.from(n,e=>e.panel),_.decorations.from(n,e=>e.diagnostics)]});function BA(n){let e=n.field(Ct,!1);return e?e.diagnostics.size:0}const Ok=te.mark({class:"cm-lintRange cm-lintRange-active"});function Ak(n,e,t){let{diagnostics:i}=n.state.field(Ct),r=[],s=2e8,o=0;return i.between(e-(t<0?1:0),e+(t>0?1:0),(l,a,{spec:c})=>{e>=l&&e<=a&&(l==a||(e>l||t>0)&&(e<a||t<0))&&(r.push(c.diagnostic),s=Math.min(l,s),o=Math.max(a,o))}),r.length?{pos:s,end:o,above:n.state.doc.lineAt(s).to<o,create(){return{dom:Bp(n,r)}}}:null}function Bp(n,e){return Le("ul",{class:"cm-tooltip-lint"},e.map(t=>Np(n,t,!1)))}const Ek=n=>{let e=n.state.field(Ct,!1);(!e||!e.panel)&&n.dispatch({effects:Mp(n.state,[Cc.of(!0)])});let t=gr(n,co.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Rp=n=>{let e=n.state.field(Ct,!1);return!e||!e.panel?!1:(n.dispatch({effects:Cc.of(!1)}),!0)},Pk=[{key:"Mod-Shift-m",run:Ek},{key:"F8",run:n=>{let e=n.state.field(Ct,!1);if(!e)return!1;let t=n.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)}}],Ip=Ue.fromClass(class{constructor(n){this.view=n,this.timeout=-1,this.set=!0;let{delay:e}=n.state.facet(Rr);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let n=Date.now();if(n<this.lintTime-10)setTimeout(this.run,this.lintTime-n);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(Rr);Promise.all(t.map(i=>Promise.resolve(i(this.view)))).then(i=>{let r=i.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(kk(this.view.state,r))},i=>{Dt(this.view.state,i)})}}update(n){let e=n.state.facet(Rr);(n.docChanged||e!=n.startState.facet(Rr))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Rr=ne.define({combine(n){return{sources:n.map(e=>e.source),delay:n.length?Math.max(...n.map(e=>e.delay)):750}},enables:Ip});function IA(n,e={}){var t;return Rr.of({source:n,delay:(t=e.delay)!==null&&t!==void 0?t:750})}function LA(n){let e=n.plugin(Ip);e&&e.force()}function Lp(n){let e=[];if(n)e:for(let{name:t}of n){for(let i=0;i<t.length;i++){let r=t[i];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function Np(n,e,t){var i;let r=t?Lp(e.actions):[];return Le("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Le("span",{class:"cm-diagnosticText"},e.message),(i=e.actions)===null||i===void 0?void 0:i.map((s,o)=>{let l=h=>{h.preventDefault();let d=Li(n.state.field(Ct).diagnostics,e);d&&s.apply(n,d.from,d.to)},{name:a}=s,c=r[o]?a.indexOf(r[o]):-1,u=c<0?a:[a.slice(0,c),Le("u",a.slice(c,c+1)),a.slice(c+1)];return Le("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${a}${c<0?"":` (access key "${r[o]})"`}.`},u)}),e.source&&Le("div",{class:"cm-diagnosticSource"},e.source))}class Dk extends Jt{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Le("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Wp{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Np(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class co{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)Rp(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=Lp(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=Li(this.view.state.field(Ct).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},i=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=Le("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=Le("div",{class:"cm-panel-lint"},this.list,Le("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Rp(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(Ct).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Ct),i=0,r=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,l,{spec:a})=>{let c=-1,u;for(let h=i;h<this.items.length;h++)if(this.items[h].diagnostic==a.diagnostic){c=h;break}c<0?(u=new Wp(this.view,a.diagnostic),this.items.splice(i,0,u),r=!0):(u=this.items[c],c>i&&(this.items.splice(i,c-i),r=!0)),t&&u.diagnostic==t.diagnostic?u.dom.hasAttribute("aria-selected")||(u.dom.setAttribute("aria-selected","true"),s=u):u.dom.hasAttribute("aria-selected")&&u.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new Wp(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{o.top<l.top?this.list.scrollTop-=l.top-o.top:o.bottom>l.bottom&&(this.list.scrollTop+=o.bottom-l.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Ct),i=Li(t.diagnostics,this.items[e].diagnostic);!i||this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Fp.of(i)})}static open(e){return new co(e)}}function uo(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function kc(n){return uo(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Tk=_.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:kc("#d11")},".cm-lintRange-warning":{backgroundImage:kc("orange")},".cm-lintRange-info":{backgroundImage:kc("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});class Mk extends sn{constructor(e){super(),this.diagnostics=e,this.severity=e.reduce((t,i)=>{let r=i.severity;return r=="error"||r=="warning"&&t=="info"?r:t},"info")}toDOM(e){let t=document.createElement("div");return t.className="cm-lint-marker cm-lint-marker-"+this.severity,t.onmouseover=()=>Bk(e,t,this.diagnostics),t}}function Fk(n,e){let t=i=>{let r=e.getBoundingClientRect();if(!(i.clientX>r.left-10&&i.clientX<r.right+10&&i.clientY>r.top-10&&i.clientY<r.bottom+10)){for(let s=i.target;s;s=s.parentNode)if(s.nodeType==1&&s.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",t),n.state.field(Vp)&&n.dispatch({effects:Oc.of(null)})}};window.addEventListener("mousemove",t)}function Bk(n,e,t){function i(){let o=n.elementAtHeight(e.getBoundingClientRect().top+5-n.documentTop);n.coordsAtPos(o.from)&&n.dispatch({effects:Oc.of({pos:o.from,above:!1,create(){return{dom:Bp(n,t),getCoords:()=>e.getBoundingClientRect()}}})}),e.onmouseout=e.onmousemove=null,Fk(n,e)}let{hoverTime:r}=n.state.facet($p),s=setTimeout(i,r);e.onmouseout=()=>{clearTimeout(s),e.onmouseout=e.onmousemove=null},e.onmousemove=()=>{clearTimeout(s),s=setTimeout(i,r)}}function Rk(n,e){let t=Object.create(null);for(let r of e){let s=n.lineAt(r.from);(t[s.from]||(t[s.from]=[])).push(r)}let i=[];for(let r in t)i.push(new Mk(t[r]).range(+r));return ke.of(i,!0)}const Ik=qd({class:"cm-gutter-lint",markers:n=>n.state.field(jp)}),jp=qe.define({create(){return ke.empty},update(n,e){n=n.map(e.changes);for(let t of e.effects)t.is(Sc)&&(n=Rk(e.state.doc,t.value));return n}}),Oc=ue.define(),Vp=qe.define({create(){return null},update(n,e){return n&&e.docChanged&&(n=Object.assign(Object.assign({},n),{pos:e.changes.mapPos(n.pos)})),e.effects.reduce((t,i)=>i.is(Oc)?i.value:t,n)},provide:n=>so.from(n)}),Lk=_.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:uo('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:uo('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error:before":{content:uo('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),$p=ne.define({combine(n){return dn(n,{hoverTime:300})}});function NA(n={}){return[$p.of(n),jp,Ik,Lk,Vp]}const Nk=[Rx(),Nx(),c1(),yx(),Zx(),Xw(),i1(),we.allowMultipleSelections.of(!0),z1(),rx.fallback,Xx(),IS(),ok(),bk(),Sk(),p1(),JS(),dr.of([...WS,...BS,...fC,...Ax,...$x,...fk,...Ep,...Pk])],Wk="#e5c07b",Hp="#e06c75",jk="#56b6c2",Vk="#ffffff",ho="#abb2bf",Ac="#7d8799",$k="#61afef",Hk="#98c379",Up="#d19a66",Uk="#c678dd",zk="#21252b",Ec="#2c313a",zp="#282c34",Pc="#353a42",Zk="#3E4451",Zp="#528bff",qk=_.theme({"&":{color:ho,backgroundColor:zp},".cm-content":{caretColor:Zp},"&.cm-focused .cm-cursor":{borderLeftColor:Zp},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Zk},".cm-panels":{backgroundColor:zk,color:ho},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:Ec},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutters":{backgroundColor:zp,color:Ac,border:"none"},".cm-activeLineGutter":{backgroundColor:Ec},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Pc},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Pc,borderBottomColor:Pc},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Ec,color:ho}}},{dark:!0}),Kk=Pi.define([{tag:E.keyword,color:Uk},{tag:[E.name,E.deleted,E.character,E.propertyName,E.macroName],color:Hp},{tag:[E.function(E.variableName),E.labelName],color:$k},{tag:[E.color,E.constant(E.name),E.standard(E.name)],color:Up},{tag:[E.definition(E.name),E.separator],color:ho},{tag:[E.typeName,E.className,E.number,E.changed,E.annotation,E.modifier,E.self,E.namespace],color:Wk},{tag:[E.operator,E.operatorKeyword,E.url,E.escape,E.regexp,E.link,E.special(E.string)],color:jk},{tag:[E.meta,E.comment],color:Ac},{tag:E.strong,fontWeight:"bold"},{tag:E.emphasis,fontStyle:"italic"},{tag:E.strikethrough,textDecoration:"line-through"},{tag:E.link,color:Ac,textDecoration:"underline"},{tag:E.heading,fontWeight:"bold",color:Hp},{tag:[E.atom,E.bool,E.special(E.variableName)],color:Up},{tag:[E.processingInstruction,E.string,E.inserted],color:Hk},{tag:E.invalid,color:Vk}]),Gk=[qk,Kk];var Jk=_.theme({"&":{backgroundColor:"#fff"}},{dark:!1});function Yk(n){var{value:e,selection:t,onChange:i,onUpdate:r,extensions:s=[],autoFocus:o,theme:l="light",height:a="",minHeight:c="",maxHeight:u="",placeholder:h="",width:d="",minWidth:m="",maxWidth:p="",editable:y=!0,indentWithTab:b=!0,basicSetup:v=!0,root:C}=n,[x,k]=(0,f.useState)(n.container),[w,O]=(0,f.useState)(),[F,P]=(0,f.useState)(),B=_.theme({"&":{height:a,minHeight:c,maxHeight:u,width:d,minWidth:m,maxWidth:p}}),N=_.updateListener.of(Q=>{if(Q.docChanged&&typeof i=="function"){var he=Q.state.doc,Ce=he.toString();i(Ce,Q)}}),G=[N,B];switch(b&&G.unshift(dr.of([RS])),v&&G.unshift(Nk),h&&G.unshift(b1(h)),l){case"light":G.push(Jk);break;case"dark":G.push(Gk);break;default:G.push(l);break}return y===!1&&G.push(_.editable.of(!1)),r&&typeof r=="function"&&G.push(_.updateListener.of(r)),G=G.concat(s),(0,f.useEffect)(()=>{if(x&&!F){var Q=we.create({doc:e,selection:t,extensions:G});if(P(Q),!w){var he=new _({state:Q,parent:x,root:C});O(he)}}return()=>{w&&O(void 0)}},[x,F]),(0,f.useEffect)(()=>()=>{w&&(w.destroy(),O(void 0))},[w]),(0,f.useEffect)(()=>{o&&w&&w.focus()},[o,w]),(0,f.useEffect)(()=>{var Q=w?w.state.doc.toString():"";w&&e!==Q&&w.dispatch({changes:{from:0,to:Q.length,insert:e||""}})},[e,w]),(0,f.useEffect)(()=>{w&&w.dispatch({effects:ue.reconfigure.of(G)})},[l,s,a,c,u,d,h,m,p,y,b,v]),{state:F,setState:P,view:w,setView:O,container:x,setContainer:k}}var Xk=g(52322),_k=["className","value","selection","extensions","onChange","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","root"],qp=f.forwardRef((n,e)=>{var{className:t,value:i="",selection:r,extensions:s=[],onChange:o,onUpdate:l,autoFocus:a,theme:c="light",height:u,minHeight:h,maxHeight:d,width:m,minWidth:p,maxWidth:y,basicSetup:b,placeholder:v,indentWithTab:C,editable:x,root:k}=n,w=(0,dx.Z)(n,_k),O=(0,f.useRef)(null),{state:F,view:P,container:B,setContainer:N}=Yk({container:O.current,root:k,value:i,autoFocus:a,theme:c,height:u,minHeight:h,maxHeight:d,width:m,minWidth:p,maxWidth:y,basicSetup:b,placeholder:v,indentWithTab:C,editable:x,selection:r,onChange:o,onUpdate:l,extensions:s});if((0,f.useImperativeHandle)(e,()=>({editor:B,state:F,view:P}),[B,F,P]),(0,f.useEffect)(()=>{N(O.current)},[]),typeof i!="string")throw new Error("value must be typeof string but got "+typeof i);var G=typeof c=="string"?"cm-theme-"+c:"cm-theme";return(0,Xk.jsx)("div",(0,fx.Z)({ref:O,className:""+G+(t?" "+t:"")},w))});qp.displayName="CodeMirror";var Qk=qp,eO=g(60155),Kp=g.n(eO),WA=g(32272),jA=g(82394),VA=g(82108);const tO=[{component:$.E,name:"EntityPicker"},{component:$.a,name:"EntityNamePicker",validation:$.e},{component:$.b,name:"EntityTagsPicker"},{component:$.R,name:"RepoUrlPicker",validation:$.r},{component:$.O,name:"OwnerPicker"},{component:$.c,name:"OwnedEntityPicker"}],nO=(0,z.Z)(n=>({cardHeader:{position:"relative"},title:{backgroundImage:({backgroundImage:e})=>e},box:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":10,"-webkit-box-orient":"vertical",paddingBottom:"0.8em"},label:{color:n.palette.text.secondary,textTransform:"uppercase",fontSize:"0.65rem",fontWeight:"bold",letterSpacing:.5,lineHeight:1,paddingBottom:"0.2rem"},leftButton:{marginRight:"auto"},starButton:{position:"absolute",top:n.spacing(.5),right:n.spacing(.5),padding:"0.25rem",color:"#fff"}})),iO=(0,z.Z)(n=>({deprecationIcon:{position:"absolute",top:n.spacing(.5),right:n.spacing(3.5),padding:"0.25rem"},link:{color:n.palette.warning.light}})),rO=n=>{var e,t,i,r,s;return{key:n.metadata.uid,name:n.metadata.name,title:`${(e=n.metadata.title||n.metadata.name)!=null?e:""}`,type:(t=n.spec.type)!=null?t:"",description:(i=n.metadata.description)!=null?i:"-",tags:(s=(r=n.metadata)==null?void 0:r.tags)!=null?s:[]}},sO=()=>{const n=iO(),e=f.createElement(S.Z,{style:{padding:10,maxWidth:300}},"This template uses a syntax that has been deprecated, and should be migrated to a newer syntax. Click for more info.");return f.createElement("div",{className:n.deprecationIcon},f.createElement(M.ZP,{title:e},f.createElement(I.Z,{href:"https://backstage.io/docs/features/software-templates/migrating-from-v1beta2-to-v1beta3",className:n.link},f.createElement(ai.Z,null))))},oO=({template:n,deprecated:e})=>{var t;const i=(0,q.Z)(),r=(0,R.tg)($.s),s=rO(n),o=(0,W.hF)(n,re.S4),l=i.getPageTheme({themeId:s.type})?s.type:"other",a=i.getPageTheme({themeId:l}),c=nO({backgroundImage:a.backgroundImage}),u=r({templateName:s.name}),h=(0,R.h_)(vn.q3),d=(0,W.CV)(n,h);return f.createElement(K.Z,null,f.createElement(le.Z,{className:c.cardHeader},f.createElement(W.LH,{className:c.starButton,entity:n}),e&&f.createElement(sO,null),f.createElement(D.hu,{title:s.title,subtitle:s.type,classes:{root:c.title}})),f.createElement(Y.Z,{style:{display:"grid"}},f.createElement(me.Z,{className:c.box},f.createElement(S.Z,{variant:"body2",className:c.label},"Description"),f.createElement(D.SA,{content:s.description})),f.createElement(me.Z,{className:c.box},f.createElement(S.Z,{variant:"body2",className:c.label},"Owner"),f.createElement(W.rI,{entityRefs:o,defaultKind:"Group"})),f.createElement(me.Z,null,f.createElement(S.Z,{variant:"body2",className:c.label},"Tags"),(t=s.tags)==null?void 0:t.map(m=>f.createElement(Ve.Z,{size:"small",label:m,key:m})))),f.createElement(Ke.Z,null,d&&f.createElement(Oe.Z,{className:c.leftButton,href:d.locationTargetUrl},f.createElement(vn.nW,{type:d.integrationType})),f.createElement(D.zx,{color:"primary",to:u,"aria-label":`Choose ${s.title}`},"Choose")))},Gp=({TemplateCardComponent:n,group:e})=>{const{loading:t,error:i,entities:r}=(0,W.wp)(),s=n||oO,o=e?r.filter(a=>e.filter(a)):r,l=(()=>e&&e.title?typeof e.title=="string"?f.createElement(D.yW,{title:e.title}):e.title:f.createElement(D.yW,{title:"Other Templates"}))();return e&&o.length===0?null:f.createElement(f.Fragment,null,t&&f.createElement(D.Ex,null),i&&f.createElement(D.GB,{title:"Oops! Something went wrong loading the templates"},i.message),!i&&!t&&!r.length&&f.createElement(S.Z,{variant:"body2"},"No templates found that match your filter. Learn more about"," ",f.createElement(D.rU,{to:"https://backstage.io/docs/features/software-templates/adding-templates"},"adding templates"),"."),f.createElement(D.VY,null,l,f.createElement(D.Oh,null,o&&(o==null?void 0:o.length)>0&&o.map(a=>f.createElement(s,{key:(0,re.eE)(a),template:a,deprecated:a.apiVersion==="backstage.io/v1beta2"})))))},lO=({TemplateCardComponent:n,groups:e})=>{const t=(0,R.tg)($.d),i={title:e?"Other Templates":"Templates",filter:s=>!(e!=null?e:[]).map(l=>l.filter(s)).some(l=>l===!0)},{allowed:r}=(0,un.gI)(po.x7);return f.createElement(D.T3,{themeId:"home"},f.createElement(D.h4,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates"}),f.createElement(D.VY,null,f.createElement(D.yW,{title:"Available Templates"},r&&f.createElement(D.XF,{title:"Register Existing Component",to:t&&t()}),f.createElement(D.qt,null,"Create new software components using standard templates. Different templates create different kinds of components (services, websites, documentation, ...).")),f.createElement(W._i,null,f.createElement(W._i.Filters,null,f.createElement(W.nN,null),f.createElement(W.tW,{initialFilter:"template",hidden:!0}),f.createElement(W.EW,{initialFilter:"all",availableFilters:["all","starred"]}),f.createElement($.T,null),f.createElement(W.xE,null)),f.createElement(W._i.Content,null,e&&e.map((s,o)=>f.createElement(Gp,{key:o,TemplateCardComponent:n,group:s})),f.createElement(Gp,{key:"other",TemplateCardComponent:n,group:i})))))},aO=({TemplateCardComponent:n,groups:e})=>f.createElement(W.UO,null,f.createElement(lO,{TemplateCardComponent:n,groups:e}));function yn(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function li(n,e){if(!yn(n))return;const{properties:t,items:i,anyOf:r,oneOf:s,allOf:o,dependencies:l}=n;for(const a in n)!n.hasOwnProperty(a)||a.startsWith("ui:")&&(e[a]=n[a],delete n[a]);if(yn(t))for(const a in t){if(!t.hasOwnProperty(a))continue;const c=t[a];if(!yn(c))continue;const u={};e[a]=u,li(c,u)}if(yn(i)){const a={};e.items=a,li(i,a)}if(Array.isArray(r))for(const a of r)!yn(a)||li(a,e);if(Array.isArray(s))for(const a of s)!yn(a)||li(a,e);if(Array.isArray(o))for(const a of o)!yn(a)||li(a,e);if(yn(l))for(const a of Object.keys(l)){const c=l[a];!yn(c)||li(c,e)}}function cO(n){n.type=n.type||"object";const e=JSON.parse(JSON.stringify(n));delete e.title;const t={};return li(e,t),{schema:e,uiSchema:t}}var uO=Object.freeze({__proto__:null,DescriptionField:({description:n})=>n&&f.createElement(D.SA,{content:n,linkTarget:"_blank"})});const hO=iv(lb);function fO(n){const e=[];return n.forEach(t=>{const i=t.schema.properties;for(const r in i)if(i.hasOwnProperty(r)){const s=i[r];s.name=r,e.push(s)}}),e}function dO(n,e){const t=fO(e),i={};for(const r in n)if(n.hasOwnProperty(r)){const s=t.find(l=>l.name===r);if(!s){i[r]=n[r];continue}if(s["ui:widget"]==="password"){i[r]="******";continue}if(!s["ui:backstage"]||!s["ui:backstage"].review){i[r]=n[r];continue}const o=s["ui:backstage"].review;if(!o.show)continue;if(o.mask){i[r]=o.mask;continue}i[r]=n[r]}return i}const Jp=n=>{const{formData:e,onChange:t,onReset:i,onFinish:r,fields:s,widgets:o}=n,[l,a]=(0,f.useState)(0),[c,u]=(0,f.useState)(!1),h=(0,R.h_)(R.VE),d=(0,R.h_)(R.W0),m="backstage:featureFlag",p=k=>{var w;const O=cb()(k),F=[];return O.schema.properties&&(O.schema.properties=Object.fromEntries(Object.entries(O.schema.properties).filter(([P,B])=>B[m]?d.isActive(B[m])?!0:(F.push(P),!1):!0)),O.schema.required=Array.isArray(O.schema.required)?(w=O.schema.required)==null?void 0:w.filter(P=>!F.includes(P)):O.schema.required),O},y=n.steps.filter(k=>{const w=k.schema[m];return typeof w!="string"||d.isActive(w)}).map(p),b=()=>{a(0),i()},v=()=>{a(Math.min(l+1,y.length))},C=()=>a(Math.max(l-1,0)),x=async()=>{if(!!r){u(!0);try{await r()}catch(k){u(!1),h.post(k)}}};return f.createElement(f.Fragment,null,f.createElement(pe.Z,{activeStep:l,orientation:"vertical"},y.map(({title:k,schema:w,...O},F)=>f.createElement(Qe.Z,{key:k},f.createElement(H.Z,{"aria-label":`Step ${F+1} ${k}`,"aria-disabled":"false",tabIndex:0},f.createElement(S.Z,{variant:"h6",component:"h3"},k)),f.createElement(Ge.Z,{key:k},f.createElement(hO,{showErrorList:!1,fields:{...uO,...s},widgets:o,noHtml5Validate:!0,formData:e,onChange:t,onSubmit:P=>{P.errors.length===0&&v()},...O,...cO(w)},f.createElement(st.Z,{disabled:l===0,onClick:C},"Back"),f.createElement(st.Z,{variant:"contained",color:"primary",type:"submit"},"Next step")))))),l===y.length&&f.createElement(D.VY,null,f.createElement(bt.Z,{square:!0,elevation:0},f.createElement(S.Z,{variant:"h6"},"Review and create"),f.createElement(D.xT,{dense:!0,metadata:dO(e,y)}),f.createElement(me.Z,{mb:4}),f.createElement(st.Z,{onClick:C,disabled:c},"Back"),f.createElement(st.Z,{onClick:b,disabled:c},"Reset"),f.createElement(st.Z,{variant:"contained",color:"primary",onClick:x,disabled:!r||c},"Create"))))},mO=n=>{const e=(0,R.h_)($.f),{value:t,loading:i,error:r}=(0,ci.default)(()=>e.getTemplateParameterSchema(n),[e,n]);return{schema:t,loading:i,error:r}};function fo(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const Yp=(n,e,t)=>{function i(r,s,o){const l=r.properties;if(!!fo(l))for(const[a,c]of Object.entries(s)){const u=o[a];if(fo(c)){const h=l[a];fo(h)&&i(h,c,u)}else{const h=l[a],d=fo(h)&&h["ui:field"];d&&typeof e[d]=="function"&&e[d](c,u,t)}}}return(r,s)=>(i(n,r,s),s)},pO=({customFieldExtensions:n=[]})=>{const e=(0,R.I_)(),t=(0,f.useContext)($.S),i=(0,R.h_)(R.VE),r=(0,R.h_)($.f),{templateName:s}=(0,U.UO)(),o=(0,U.s0)(),l=(0,R.tg)($.g),a=(0,R.tg)($.h),{schema:c,loading:u,error:h}=mO(s),[d,m]=(0,f.useState)(()=>{var x;const k=Ir().parse(window.location.search,{ignoreQueryPrefix:!0});try{return JSON.parse(k.formData)}catch{return(x=k.formData)!=null?x:{}}}),p=()=>m({}),y=(0,f.useCallback)(x=>m(x.formData),[m]),b=async()=>{var x;const{taskId:k}=await r.scaffold({templateRef:(0,re.eE)({name:s,kind:"template",namespace:"default"}),values:d,secrets:t==null?void 0:t.secrets}),w=Ir().stringify({formData:d},{addQueryPrefix:!0}),O=`${window.location.pathname}${w}`;(x=window.history)==null||x.replaceState(null,document.title,O),o(l({taskId:k}))};if(h)return i.post(new Error(`Failed to load template, ${h}`)),f.createElement(U.Fg,{to:a()});if(!u&&!c)return i.post(new Error("Template was not found.")),f.createElement(U.Fg,{to:a()});const v=Object.fromEntries(n.map(({name:x,component:k})=>[x,k])),C=Object.fromEntries(n.map(({name:x,validation:k})=>[x,k]));return f.createElement(D.T3,{themeId:"home"},f.createElement(D.h4,{pageTitleOverride:"Create a New Component",title:"Create a New Component",subtitle:"Create new software components using standard templates"}),f.createElement(D.VY,null,u&&f.createElement($n.Z,{"data-testid":"loading-progress"}),c&&f.createElement(D.rJ,{title:c.title,noPadding:!0,titleTypographyProps:{component:"h2"}},f.createElement(Jp,{formData:d,fields:v,onChange:y,onReset:p,onFinish:b,steps:c.steps.map(x=>({...x,validate:Yp(x.schema,C,{apiHolder:e})}))}))))},gO=(0,z.Z)(n=>({code:{fontFamily:"Menlo, monospace",padding:n.spacing(1),backgroundColor:n.palette.type==="dark"?n.palette.grey[700]:n.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${n.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:n.spacing(.5),fontWeight:"bolder",color:n.palette.error.light}}})),yO=()=>{const n=(0,R.h_)($.f),e=gO(),{loading:t,value:i,error:r}=(0,ci.default)(async()=>n.listActions());if(t)return f.createElement(D.Ex,null);if(r)return f.createElement(D.mf,{statusMessage:"Failed to load installed actions",status:"500"});const s=c=>{const u=c.properties;if(!!u)return Object.entries(u).map(h=>{var d;const[m]=h,p=h[1],y=hb()(e.code,{[e.codeRequired]:(d=c.required)==null?void 0:d.includes(m)});return f.createElement(Mt.Z,{key:m},f.createElement(wt.Z,null,f.createElement("div",{className:y},m)),f.createElement(wt.Z,null,p.title),f.createElement(wt.Z,null,p.description),f.createElement(wt.Z,null,f.createElement("span",{className:e.code},p.type)))})},o=c=>{if(!!c.properties)return f.createElement(Ft.Z,{component:bt.Z},f.createElement(L.Z,{size:"small"},f.createElement(X.Z,null,f.createElement(Mt.Z,null,f.createElement(wt.Z,null,"Name"),f.createElement(wt.Z,null,"Title"),f.createElement(wt.Z,null,"Description"),f.createElement(wt.Z,null,"Type"))),f.createElement(Ne.Z,null,s(c))))},l=(c,u)=>{if(!!u)return f.createElement(f.Fragment,null,f.createElement(S.Z,{variant:"h6"},c),u.map((h,d)=>f.createElement("div",{key:d},o(h))))},a=i==null?void 0:i.map(c=>{var u,h,d,m;if(c.id.startsWith("legacy:"))return;const p=l("oneOf",(h=(u=c.schema)==null?void 0:u.input)==null?void 0:h.oneOf);return f.createElement(me.Z,{pb:4,key:c.id},f.createElement(S.Z,{variant:"h4",className:e.code},c.id),f.createElement(S.Z,null,c.description),((d=c.schema)==null?void 0:d.input)&&f.createElement(me.Z,{pb:2},f.createElement(S.Z,{variant:"h5"},"Input"),o(c.schema.input),p),((m=c.schema)==null?void 0:m.output)&&f.createElement(me.Z,{pb:2},f.createElement(S.Z,{variant:"h5"},"Output"),o(c.schema.output)))});return f.createElement(D.T3,{themeId:"home"},f.createElement(D.h4,{pageTitleOverride:"Create a New Component",title:"Installed actions",subtitle:"This is the collection of all installed actions"}),f.createElement(D.VY,null,a))},vO=`# Edit the template parameters below to see how they will render in the scaffolder form UI
parameters:
  - title: Fill in some steps
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
      owner:
        title: Owner
        type: string
        description: Owner of the component
        ui:field: OwnerPicker
        ui:options:
          allowedKinds:
            - Group
  - title: Choose a location
    required:
      - repoUrl
    properties:
      repoUrl:
        title: Repository Location
        type: string
        ui:field: RepoUrlPicker
        ui:options:
          allowedHosts:
            - github.com
`,bO=(0,z.Z)({templateSelect:{marginBottom:"10px"},grid:{height:"100%"},codeMirror:{height:"95%"}}),wO=({defaultPreviewTemplate:n=vO,customFieldExtensions:e=[]})=>{const t=bO(),i=(0,R.h_)(R.$v),r=(0,R.h_)(W.Ah),s=(0,R.I_)(),[o,l]=(0,f.useState)(""),[a,c]=(0,f.useState)({title:"",steps:[]}),[u,h]=(0,f.useState)([]),[d,m]=(0,f.useState)(n),[p,y]=(0,f.useState)({}),{loading:b}=(0,ci.default)(()=>r.getEntities({filter:{kind:"template"},fields:["kind","metadata.namespace","metadata.name","metadata.title","spec.parameters"]}).then(({items:P})=>h(P.map(B=>{var N;return{label:(N=B.metadata.title)!=null?N:(0,W.$3)(B,{defaultKind:"template"}),value:B}}))).catch(P=>i.post({message:`Error loading exisiting templates: ${P.message}`,severity:"error"})),[r]),v=document.createElement("div");v.style.color="red",(0,fb.Z)(()=>{try{const P=Kp().parse(d);c({title:"Preview",steps:P.parameters.map(B=>({title:B.title,schema:B}))}),y({})}catch(P){v.textContent=P.message}},250,[y,c,d]);const C=(0,f.useCallback)(P=>{l(P),m(Kp().stringify(P.spec))},[m]),x=()=>y({}),k=(0,f.useCallback)(P=>y(P.formData),[y]),w=(0,f.useCallback)(P=>{m(P)},[m]),O=Object.fromEntries(e.map(({name:P,component:B})=>[P,B])),F=Object.fromEntries(e.map(({name:P,validation:B})=>[P,B]));return f.createElement(D.T3,{themeId:"home"},f.createElement(D.h4,{title:"Template Preview",subtitle:"Preview your template parameter UI"}),f.createElement(D.VY,null,b&&f.createElement($n.Z,null),f.createElement(ye.Z,{container:!0,className:t.grid},f.createElement(ye.Z,{item:!0,xs:6},f.createElement(Ot.Z,{className:t.templateSelect,variant:"outlined",fullWidth:!0},f.createElement(Pe.Z,{id:"select-template-label"},"Load Existing Template"),f.createElement(et.Z,{value:o,label:"Load Existing Template",labelId:"select-template-label",onChange:P=>C(P.target.value)},u.map((P,B)=>f.createElement(ct.Z,{key:B,value:P.value},P.label)))),f.createElement(Qk,{className:t.codeMirror,value:d,theme:"dark",height:"100%",extensions:[La.define(pb),Oi.of(()=>({dom:v,top:!0}))],onChange:w})),f.createElement(ye.Z,{item:!0,xs:6},a&&f.createElement(D.rJ,{key:JSON.stringify(a)},f.createElement(Jp,{formData:p,fields:O,onChange:k,onReset:x,steps:a.steps.map(P=>({...P,validate:Yp(P.schema,F,{apiHolder:s})}))}))))))},xO=n=>{const{groups:e,components:t={},defaultPreviewTemplate:i}=n,{TemplateCardComponent:r,TaskPageComponent:s}=t,o=(0,U.pC)(),l=s!=null?s:$.k,a=(0,R.vJ)(o,u=>u.selectByComponentData({key:$.F}).findComponentData({key:$.i})),c=[...a,...tO.filter(({name:u})=>!a.some(h=>h.name===u))];return f.createElement(U.Z5,null,f.createElement(U.AW,{path:"/",element:f.createElement(aO,{groups:e,TemplateCardComponent:r})}),f.createElement(U.AW,{path:"/templates/:templateName",element:f.createElement($.j,null,f.createElement(pO,{customFieldExtensions:c}))}),f.createElement(U.AW,{path:"/tasks/:taskId",element:f.createElement(l,null)}),f.createElement(U.AW,{path:"/actions",element:f.createElement(yO,null)}),f.createElement(U.AW,{path:"/preview",element:f.createElement($.j,null,f.createElement(wO,{defaultPreviewTemplate:i,customFieldExtensions:c}))}))}},65549:function(Z,ee,g){"use strict";var f,U=g(14859),D=g(93291);f={value:!0},ee.Z=void 0;var R=D(g(2784)),W=U(g(50175)),$=(0,W.default)(R.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");ee.Z=$},70595:function(Z,ee,g){"use strict";var f,U=g(14859),D=g(93291);f={value:!0},ee.Z=void 0;var R=D(g(2784)),W=U(g(50175)),$=(0,W.default)(R.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");ee.Z=$},16715:function(Z,ee,g){"use strict";var f,U=g(14859),D=g(93291);f={value:!0},ee.Z=void 0;var R=D(g(2784)),W=U(g(50175)),$=(0,W.default)(R.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error");ee.Z=$},76485:function(Z,ee,g){var f=g(9850),U=g(93503),D=g(73198),R=g(19003),W=g(35676),$=g(68632),re=g(30898),z=g(74186),S=g(18149),M=g(97030),I=g(78911),q=g(829),K=g(59756),le=g(75652),Y=g(49599),me=g(67304),Ve=(A,...j)=>me.apply(null,[A].concat(W(j))),Ke=A=>pe(Vi,A),Oe=A=>pe(Nr,A),pe=(A,j)=>A.indexOf(j)!==-1,Qe=A=>!un(A).length&&A!==!1&&A!==!0,H=A=>M(A)||A===!0||A===!1,Ge=A=>A===!1,st=A=>A===!0,bt=(A,j,J)=>J(A),$n=A=>q(le($(A))),Mt=A=>A!==void 0,wt=A=>le($(A.map(un))),Ft=A=>A[0],L=A=>$n(A),X=A=>Math.max.apply(Math,A),Ne=A=>Math.min.apply(Math,A),ye=A=>A.some(st),Ot=A=>Y(W(A),S);function Pe(A){return function(j,J){return U({[A]:j},{[A]:J})}}function et(A){if(Array.isArray(A.allOf)){var j=A.allOf;return delete A.allOf,[A].concat(j.map(function(J){return et(J)}))}else return[A]}function ct(A,j){return A.map(function(J){return J&&J[j]})}function vn(A,j){return A.map(function(J){if(!!J)if(Array.isArray(J.items)){var ce=J.items[j];if(H(ce))return ce;if(J.hasOwnProperty("additionalItems"))return J.additionalItems}else return J.items})}function ai(A,j){return A.map(function(J,ce){try{return j(J,ce)}catch{return}}).filter(Mt)}function po(A){return A.map(function(j){if(!!j)return Array.isArray(j.items)?j.additionalItems:j.items})}function un(A){return M(A)||Array.isArray(A)?Object.keys(A):[]}function Ni(A,j){if(j=j||[],!A.length)return j;var J=A.slice(0).shift(),ce=A.slice(1);return j.length?Ni(ce,W(j.map(fe=>J.map(se=>[se].concat(fe))))):Ni(ce,J.map(fe=>fe))}function Ir(A,j){return Array.isArray(A)?(A.splice.apply(A,[0,0].concat(j)),A):j}function ci(A,j){var J;try{J=A.map(function(ce){return JSON.stringify(ce,null,2)}).join(`
`)}catch{J=A.join(", ")}throw new Error('Could not resolve values for path:"'+j.join(".")+`". They are probably incompatible. Values: 
`+J)}function go(A){for(var j in A)A.hasOwnProperty(j)&&Qe(A[j])&&delete A[j];return A}function Wi(A,j,J){return function(ce,fe){if(fe===void 0)throw new Error("You need to call merger with a key for the property name or index if array.");return fe=String(fe),A(ce,null,J.concat(j,fe))}}function Lr(A,j,J,ce,fe,se){if(A.length){var be=fe.resolvers[j];if(!be)throw new Error("No resolver found for "+j);var Re=Y(J.map(function(tt){return A.reduce(function(ut,$t){return tt[$t]!==void 0&&(ut[$t]=tt[$t]),ut},{})}).filter(Mt),U),Ie=j==="properties"?Vi:Nr,ie=Ie.reduce(function(tt,ut){return pe($i,ut)?tt[ut]=Wi(ce,ut,se):tt[ut]=function($t){return ce($t,null,se.concat(ut))},tt},{});j==="items"&&(ie.itemsArray=Wi(ce,"items",se),ie.items=function(tt){return ce(tt,null,se.concat("items"))});var We=be(Re,se.concat(j),ie,fe);return M(We)||ci(Re,se.concat(j)),go(We)}}function ji(A,j,J){var ce=wt(J||A),fe=J?vn:ct;return ce.reduce(function(se,be){var Re=fe(A,be),Ie=Y(Re.filter(Mt),U);return se[be]=j(Ie,be),se},J?[]:{})}function yo(A){K(A,function(j,J){j===!1&&delete A[J]})}function vo(A){K(A,function(j,J){j===!1&&A.splice(J,1)})}function bo(A){return{required:A}}var Vi=["properties","patternProperties","additionalProperties"],Nr=["items","additionalItems"],$i=["properties","patternProperties","definitions","dependencies"],Wr=["anyOf","oneOf"],wo=["additionalProperties","additionalItems","contains","propertyNames","not","items"],Se={type(A){if(A.some(Array.isArray)){var j=A.map(function(ce){return Array.isArray(ce)?ce:[ce]}),J=re.apply(null,j);if(J.length===1)return J[0];if(J.length>1)return le(J)}},properties(A,j,J,ce){ce.ignoreAdditionalProperties||(A.forEach(function(se){var be=A.filter(We=>We!==se),Re=un(se.properties),Ie=un(se.patternProperties),ie=Ie.map(We=>new RegExp(We));be.forEach(function(We){var tt=un(We.properties),ut=tt.filter(Ae=>ie.some(Ui=>Ui.test(Ae))),$t=Ve(tt,Re,ut);$t.forEach(function(Ae){We.properties[Ae]=J.properties([We.properties[Ae],se.additionalProperties],Ae)})})}),A.forEach(function(se){var be=A.filter(Ie=>Ie!==se),Re=un(se.patternProperties);se.additionalProperties===!1&&be.forEach(function(Ie){var ie=un(Ie.patternProperties),We=Ve(ie,Re);We.forEach(tt=>delete Ie.patternProperties[tt])})}));var fe={additionalProperties:J.additionalProperties(A.map(se=>se.additionalProperties)),patternProperties:ji(A.map(se=>se.patternProperties),J.patternProperties),properties:ji(A.map(se=>se.properties),J.properties)};return fe.additionalProperties===!1&&yo(fe.properties),fe},dependencies(A,j,J){var ce=wt(A);return ce.reduce(function(fe,se){var be=ct(A,se),Re=Y(be.filter(Mt),S),Ie=Re.filter(Array.isArray);if(Ie.length){if(Ie.length===Re.length)fe[se]=$n(Re);else{var ie=Re.filter(H),We=Ie.map(bo);fe[se]=J(ie.concat(We),se)}return fe}return Re=Y(Re,U),fe[se]=J(Re,se),fe},{})},items(A,j,J){var ce=A.map(Re=>Re.items),fe=ce.filter(Mt),se={};fe.every(H)?se.items=J.items(ce):se.items=ji(A,J.itemsArray,ce);var be;return fe.every(Array.isArray)?be=A.map(Re=>Re.additionalItems):fe.some(Array.isArray)&&(be=po(A)),be&&(se.additionalItems=J.additionalItems(be)),se.additionalItems===!1&&Array.isArray(se.items)&&vo(se.items),se},oneOf(A,j,J){var ce=Ni(f(A)),fe=ai(ce,J),se=Y(fe,U);if(se.length)return se},not(A){return{anyOf:A}},pattern(A,j,J,ce,fe){var se=j.pop();fe(A.map(function(be){return{[se]:be}}))},multipleOf(A){for(var j=A.slice(0),J=1;j.some(ce=>!Number.isInteger(ce));)j=j.map(ce=>ce*10),J=J*10;return D(j)/J},enum(A){var j=z.apply(null,A.concat(S));if(j.length)return q(j)}};Se.$id=Ft,Se.$ref=Ft,Se.$schema=Ft,Se.additionalItems=bt,Se.additionalProperties=bt,Se.anyOf=Se.oneOf,Se.contains=bt,Se.default=Ft,Se.definitions=Se.dependencies,Se.description=Ft,Se.examples=Ot,Se.exclusiveMaximum=Ne,Se.exclusiveMinimum=X,Se.maximum=Ne,Se.maxItems=Ne,Se.maxLength=Ne,Se.maxProperties=Ne,Se.minimum=X,Se.minItems=X,Se.minLength=X,Se.minProperties=X,Se.propertyNames=bt,Se.required=L,Se.title=Ft,Se.uniqueItems=ye;function Hi(A,j,J){J=J||[],j=R(j,{ignoreAdditionalProperties:!1,resolvers:Se});function ce(be,Re,Ie){be=f(be.filter(Mt)),Ie=Ie||[];var ie=M(Re)?Re:{};if(!be.length)return;if(be.some(Ge))return!1;if(be.every(st))return!0;be=be.filter(M);var We=wt(be);if(pe(We,"allOf"))return Hi({allOf:be},j,J);var tt=We.filter(Ke);I(We,tt);var ut=We.filter(Oe);I(We,ut),We.forEach(function(Ae){var Ui=ct(be,Ae),Ht=Y(Ui.filter(Mt),Pe(Ae));if(Ht.length===1&&pe(Wr,Ae))ie[Ae]=Ht[0].map(function(Zt){return ce([Zt],Zt)});else if(Ht.length===1&&!pe($i,Ae)&&!pe(wo,Ae))ie[Ae]=Ht[0];else{var zi=j.resolvers[Ae]||j.resolvers.defaultResolver;if(!zi)throw new Error("No resolver found for key "+Ae+". You can provide a resolver for this keyword in the options, or provide a default resolver.");var Zi;pe($i,Ae)||pe(Wr,Ae)?Zi=Wi(ce,Ae,Ie):Zi=function(Zt){return ce(Zt,null,Ie.concat(Ae))};var ui=!1;ie[Ae]=zi(Ht,Ie.concat(Ae),Zi,j,function(Zt){return ui=Array.isArray(Zt),$t(Zt)}),ie[Ae]===void 0&&!ui?ci(Ht,Ie.concat(Ae)):ie[Ae]===void 0&&delete ie[Ae]}}),Object.assign(ie,Lr(tt,"properties",be,ce,j,Ie)),Object.assign(ie,Lr(ut,"items",be,ce,j,Ie));function $t(Ae){ie.allOf=Ir(ie.allOf,Ae)}return ie}var fe=$(et(A)),se=ce(fe,A);return se}Hi.options={resolvers:Se},Z.exports=Hi},69914:function(Z,ee){"use strict";var g;/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=typeof Symbol=="function"&&Symbol.for,U=f?Symbol.for("react.element"):60103,D=f?Symbol.for("react.portal"):60106,R=f?Symbol.for("react.fragment"):60107,W=f?Symbol.for("react.strict_mode"):60108,$=f?Symbol.for("react.profiler"):60114,re=f?Symbol.for("react.provider"):60109,z=f?Symbol.for("react.context"):60110,S=f?Symbol.for("react.async_mode"):60111,M=f?Symbol.for("react.concurrent_mode"):60111,I=f?Symbol.for("react.forward_ref"):60112,q=f?Symbol.for("react.suspense"):60113,K=f?Symbol.for("react.suspense_list"):60120,le=f?Symbol.for("react.memo"):60115,Y=f?Symbol.for("react.lazy"):60116,me=f?Symbol.for("react.block"):60121,Ve=f?Symbol.for("react.fundamental"):60117,Ke=f?Symbol.for("react.responder"):60118,Oe=f?Symbol.for("react.scope"):60119;function pe(H){if(typeof H=="object"&&H!==null){var Ge=H.$$typeof;switch(Ge){case U:switch(H=H.type,H){case S:case M:case R:case $:case W:case q:return H;default:switch(H=H&&H.$$typeof,H){case z:case I:case Y:case le:case re:return H;default:return Ge}}case D:return Ge}}}function Qe(H){return pe(H)===M}g=S,g=M,g=z,g=re,g=U,g=I,g=R,g=Y,g=le,g=D,g=$,g=W,g=q,g=function(H){return Qe(H)||pe(H)===S},g=Qe,g=function(H){return pe(H)===z},g=function(H){return pe(H)===re},g=function(H){return typeof H=="object"&&H!==null&&H.$$typeof===U},ee.isForwardRef=function(H){return pe(H)===I},g=function(H){return pe(H)===R},g=function(H){return pe(H)===Y},ee.isMemo=function(H){return pe(H)===le},g=function(H){return pe(H)===D},g=function(H){return pe(H)===$},g=function(H){return pe(H)===W},g=function(H){return pe(H)===q},g=function(H){return typeof H=="string"||typeof H=="function"||H===R||H===M||H===$||H===W||H===q||H===K||typeof H=="object"&&H!==null&&(H.$$typeof===Y||H.$$typeof===le||H.$$typeof===re||H.$$typeof===z||H.$$typeof===I||H.$$typeof===Ve||H.$$typeof===Ke||H.$$typeof===Oe||H.$$typeof===me)},g=pe},38294:function(Z,ee,g){"use strict";Z.exports=g(69914)},93948:function(Z,ee,g){"use strict";var f=g(87245),U=g(63772),D=g(8615),R=Math.pow(2,31)-1;function W(z,S){var M=1,I;if(z===0)return S;if(S===0)return z;for(;z%2===0&&S%2===0;)z=z/2,S=S/2,M=M*2;for(;z%2===0;)z=z/2;for(;S;){for(;S%2===0;)S=S/2;z>S&&(I=S,S=z,z=I),S=S-z}return M*z}function $(z,S){var M=0,I;if(z===0)return S;if(S===0)return z;for(;(z&1)===0&&(S&1)===0;)z>>>=1,S>>>=1,M++;for(;(z&1)===0;)z>>>=1;for(;S;){for(;(S&1)===0;)S>>>=1;z>S&&(I=S,S=z,z=I),S=S-z}return z<<M}function re(){var z=arguments.length,S,M,I,q,K,le,Y;for(S=new Array(z),Y=0;Y<z;Y++)S[Y]=arguments[Y];if(U(S)){if(z===2)return K=S[0],le=S[1],K<0&&(K=-K),le<0&&(le=-le),K<=R&&le<=R?$(K,le):W(K,le);I=S}else if(f(S[0]))if(z>1){if(I=S[0],M=S[1],!D(M))throw new TypeError("gcd()::invalid input argument. Accessor must be a function. Value: `"+M+"`.")}else I=S[0];else throw new TypeError("gcd()::invalid input argument. Must provide an array of integers. Value: `"+S[0]+"`.");if(q=I.length,q<2)return null;if(M){for(K=new Array(q),Y=0;Y<q;Y++)K[Y]=M(I[Y],Y);I=K}if(z<3&&!U(I))throw new TypeError("gcd()::invalid input argument. Accessed array values must be integers. Value: `"+I+"`.");for(Y=0;Y<q;Y++)K=I[Y],K<0&&(I[Y]=-K);for(K=I[0],Y=1;Y<q;Y++)le=I[Y],le<=R&&K<=R?K=$(K,le):K=W(K,le);return K}Z.exports=re},73198:function(Z,ee,g){"use strict";var f=g(93948),U=g(87245),D=g(63772),R=g(8615);function W(){var $=arguments.length,re,z,S,M,I,q,K;for(re=new Array($),K=0;K<$;K++)re[K]=arguments[K];if(D(re)){if($===2)return I=re[0],q=re[1],I<0&&(I=-I),q<0&&(q=-q),I===0||q===0?0:I/f(I,q)*q;S=re}else if(U(re[0]))if($>1){if(S=re[0],z=re[1],!R(z))throw new TypeError("lcm()::invalid input argument. Accessor must be a function. Value: `"+z+"`.")}else S=re[0];else throw new TypeError("lcm()::invalid input argument. Must provide an array of integers. Value: `"+re[0]+"`.");if(M=S.length,M<2)return null;if(z){for(I=new Array(M),K=0;K<M;K++)I[K]=z(S[K],K);S=I}if($<3&&!D(S))throw new TypeError("lcm()::invalid input argument. Accessed array values must be integers. Value: `"+S+"`.");for(K=0;K<M;K++)I=S[K],I<0&&(S[K]=-I);for(I=S[0],K=1;K<M;K++){if(q=S[K],I===0||q===0)return 0;I=I/f(I,q)*q}return I}Z.exports=W},16455:function(Z,ee,g){var f=g(6200);Z.exports=f},35558:function(Z,ee,g){g(21710);var f=g(47923);Z.exports=f("Array","fill")},5594:function(Z,ee,g){g(70024);var f=g(47923);Z.exports=f("Array","includes")},67553:function(Z,ee,g){var f=g(16455);Z.exports=f},47923:function(Z,ee,g){var f=g(10150);Z.exports=f},6200:function(Z,ee,g){var f=g(35558);Z.exports=f},93503:function(Z,ee,g){var f=g(18149),U=g(829),D=g(75652),R=g(49599),W=g(84573),$=g(74186),re=g(97030),z=g(4335),S=L=>Array.isArray(L)?L:[L],M=L=>L===void 0,I=L=>re(L)||Array.isArray(L)?Object.keys(L):[],q=(L,X)=>L.hasOwnProperty(X),K=L=>U(D(L)),le=L=>M(L)||Array.isArray(L)&&L.length===0,Y=(L,X,Ne,ye)=>X&&q(X,Ne)&&L&&q(L,Ne)&&ye(L[Ne],X[Ne]),me=(L,X)=>M(L)&&X===0||M(X)&&L===0||f(L,X),Ve=(L,X)=>M(L)&&X===!1||M(X)&&L===!1||f(L,X),Ke=L=>M(L)||f(L,{})||L===!0,Oe=L=>M(L)||f(L,{}),pe=L=>M(L)||re(L)||L===!0||L===!1;function Qe(L,X){return le(L)&&le(X)?!0:f(K(L),K(X))}function H(L,X){return L=S(L),X=S(X),f(K(L),K(X))}function Ge(L,X,Ne,ye){var Ot=D(I(L).concat(I(X)));return Oe(L)&&Oe(X)?!0:Oe(L)&&I(X).length||Oe(X)&&I(L).length?!1:Ot.every(function(Pe){var et=L[Pe],ct=X[Pe];return Array.isArray(et)&&Array.isArray(ct)?f(K(L),K(X)):Array.isArray(et)&&!Array.isArray(ct)||Array.isArray(ct)&&!Array.isArray(et)?!1:Y(L,X,Pe,ye)})}function st(L,X,Ne,ye){return re(L)&&re(X)?ye(L,X):Array.isArray(L)&&Array.isArray(X)?Ge(L,X,Ne,ye):f(L,X)}function bt(L,X,Ne,ye){var Ot=R(L,ye),Pe=R(X,ye),et=$(Ot,Pe,ye);return et.length===Math.max(Ot.length,Pe.length)}var $n={title:f,uniqueItems:Ve,minLength:me,minItems:me,minProperties:me,required:Qe,enum:Qe,type:H,items:st,anyOf:bt,allOf:bt,oneOf:bt,properties:Ge,patternProperties:Ge,dependencies:Ge},Mt=["properties","patternProperties","dependencies","uniqueItems","minLength","minItems","minProperties","required"],wt=["additionalProperties","additionalItems","contains","propertyNames","not"];function Ft(L,X,Ne){if(Ne=W(Ne,{ignore:[]}),Ke(L)&&Ke(X))return!0;if(!pe(L)||!pe(X))throw new Error("Either of the values are not a JSON schema.");if(L===X)return!0;if(z(L)&&z(X))return L===X;if(L===void 0&&X===!1||X===void 0&&L===!1||M(L)&&!M(X)||!M(L)&&M(X))return!1;var ye=D(Object.keys(L).concat(Object.keys(X)));if(Ne.ignore.length&&(ye=ye.filter(Pe=>Ne.ignore.indexOf(Pe)===-1)),!ye.length)return!0;function Ot(Pe,et){return Ft(Pe,et,Ne)}return ye.every(function(Pe){var et=L[Pe],ct=X[Pe];if(wt.indexOf(Pe)!==-1)return Ft(et,ct,Ne);var vn=$n[Pe];if(vn||(vn=f),f(et,ct))return!0;if(Mt.indexOf(Pe)===-1&&(!q(L,Pe)&&q(X,Pe)||q(L,Pe)&&!q(X,Pe)))return et===ct;var ai=vn(et,ct,Pe,Ot);if(!z(ai))throw new Error("Comparer must return true or false");return ai})}Z.exports=Ft},404:function(Z,ee){var g=/~/,f=/~[01]/g;function U(S){switch(S){case"~1":return"/";case"~0":return"~"}throw new Error("Invalid tilde escape: "+S)}function D(S){return g.test(S)?S.replace(f,U):S}function R(S,M,I){for(var q,K,le=1,Y=M.length;le<Y;){if(M[le]==="constructor"||M[le]==="prototype"||M[le]==="__proto__")return S;if(q=D(M[le++]),K=Y>le,typeof S[q]=="undefined"&&(Array.isArray(S)&&q==="-"&&(q=S.length),K&&(M[le]!==""&&M[le]<1/0||M[le]==="-"?S[q]=[]:S[q]={})),!K)break;S=S[q]}var me=S[q];return I===void 0?delete S[q]:S[q]=I,me}function W(S){if(typeof S=="string"){if(S=S.split("/"),S[0]==="")return S;throw new Error("Invalid JSON pointer.")}else if(Array.isArray(S)){for(const M of S)if(typeof M!="string"&&typeof M!="number")throw new Error("Invalid JSON pointer. Must be of type string or number.");return S}throw new Error("Invalid JSON pointer.")}function $(S,M){if(typeof S!="object")throw new Error("Invalid input object.");M=W(M);var I=M.length;if(I===1)return S;for(var q=1;q<I;){if(S=S[D(M[q++])],I===q)return S;if(typeof S!="object")return}}function re(S,M,I){if(typeof S!="object")throw new Error("Invalid input object.");if(M=W(M),M.length===0)throw new Error("Invalid JSON pointer for set.");return R(S,M,I)}function z(S){var M=W(S);return{get:function(I){return $(I,M)},set:function(I,q){return re(I,M,q)}}}ee.get=$,ee.set=re,ee.compile=z},85246:function(Z,ee,g){var f=g(45386),U=g(38333),D=g(34893),R=g(50343),W=g(47826),$=g(59950),re=200;function z(S,M,I,q){var K=-1,le=U,Y=!0,me=S.length,Ve=[],Ke=M.length;if(!me)return Ve;I&&(M=R(M,W(I))),q?(le=D,Y=!1):M.length>=re&&(le=$,Y=!1,M=new f(M));e:for(;++K<me;){var Oe=S[K],pe=I==null?Oe:I(Oe);if(Oe=q||Oe!==0?Oe:0,Y&&pe===pe){for(var Qe=Ke;Qe--;)if(M[Qe]===pe)continue e;Ve.push(Oe)}else le(M,pe,q)||Ve.push(Oe)}return Ve}Z.exports=z},84190:function(Z){function ee(g,f,U,D){for(var R=U-1,W=g.length;++R<W;)if(D(g[R],f))return R;return-1}Z.exports=ee},88390:function(Z,ee,g){var f=g(45386),U=g(38333),D=g(34893),R=g(50343),W=g(47826),$=g(59950),re=Math.min;function z(S,M,I){for(var q=I?D:U,K=S[0].length,le=S.length,Y=le,me=Array(le),Ve=1/0,Ke=[];Y--;){var Oe=S[Y];Y&&M&&(Oe=R(Oe,W(M))),Ve=re(Oe.length,Ve),me[Y]=!I&&(M||K>=120&&Oe.length>=120)?new f(Y&&Oe):void 0}Oe=S[0];var pe=-1,Qe=me[0];e:for(;++pe<K&&Ke.length<Ve;){var H=Oe[pe],Ge=M?M(H):H;if(H=I||H!==0?H:0,!(Qe?$(Qe,Ge):q(Ke,Ge,I))){for(Y=le;--Y;){var st=me[Y];if(!(st?$(st,Ge):q(S[Y],Ge,I)))continue e}Qe&&Qe.push(Ge),Ke.push(H)}}return Ke}Z.exports=z},45169:function(Z,ee,g){var f=g(50343),U=g(77832),D=g(84190),R=g(47826),W=g(51522),$=Array.prototype,re=$.splice;function z(S,M,I,q){var K=q?D:U,le=-1,Y=M.length,me=S;for(S===M&&(M=W(M)),I&&(me=f(S,R(I)));++le<Y;)for(var Ve=0,Ke=M[le],Oe=I?I(Ke):Ke;(Ve=K(me,Oe,Ve,q))>-1;)me!==S&&re.call(me,Ve,1),re.call(S,Ve,1);return S}Z.exports=z},5642:function(Z,ee,g){var f=g(93746);function U(D){return f(D)?D:[]}Z.exports=U},88302:function(Z,ee,g){var f=g(84565),U=g(29259);function D(R,W,$,re,z,S){return U(R)&&U(W)&&(S.set(W,R),f(R,W,void 0,D,S),S.delete(W)),R}Z.exports=D},19003:function(Z,ee,g){var f=g(49432),U=g(36060),D=g(88302),R=g(12782),W=U(function($){return $.push(void 0,D),f(R,void 0,$)});Z.exports=W},68632:function(Z,ee,g){var f=g(62034),U=1/0;function D(R){var W=R==null?0:R.length;return W?f(R,U):[]}Z.exports=D},30898:function(Z,ee,g){var f=g(50343),U=g(88390),D=g(36060),R=g(5642),W=D(function($){var re=f($,R);return re.length&&re[0]===$[0]?U(re):[]});Z.exports=W},74186:function(Z,ee,g){var f=g(50343),U=g(88390),D=g(36060),R=g(5642),W=g(56974),$=D(function(re){var z=W(re),S=f(re,R);return z=typeof z=="function"?z:void 0,z&&S.pop(),S.length&&S[0]===re[0]?U(S,void 0,z):[]});Z.exports=$},4335:function(Z,ee,g){var f=g(53366),U=g(15125),D="[object Boolean]";function R(W){return W===!0||W===!1||U(W)&&f(W)==D}Z.exports=R},78911:function(Z,ee,g){var f=g(45169);function U(D,R){return D&&D.length&&R&&R.length?f(D,R):D}Z.exports=U},25497:function(Z,ee,g){var f=g(50343),U=g(51522),D=g(86152),R=g(4795),W=g(54452),$=g(33812),re=g(66188);function z(S){return D(S)?f(S,$):R(S)?[S]:U(W(re(S)))}Z.exports=z},75652:function(Z,ee,g){var f=g(67326);function U(D){return D&&D.length?f(D):[]}Z.exports=U},49599:function(Z,ee,g){var f=g(67326);function U(D,R){return R=typeof R=="function"?R:void 0,D&&D.length?f(D,void 0,R):[]}Z.exports=U},67304:function(Z,ee,g){var f=g(85246),U=g(36060),D=g(93746),R=U(function(W,$){return D(W)?f(W,$):[]});Z.exports=R},11837:function(Z,ee,g){"use strict";var f;/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */g(37320);var U=g(2784),D=60103;if(f=60107,typeof Symbol=="function"&&Symbol.for){var R=Symbol.for;D=R("react.element"),f=R("react.fragment")}var W=U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$=Object.prototype.hasOwnProperty,re={key:!0,ref:!0,__self:!0,__source:!0};function z(S,M,I){var q,K={},le=null,Y=null;I!==void 0&&(le=""+I),M.key!==void 0&&(le=""+M.key),M.ref!==void 0&&(Y=M.ref);for(q in M)$.call(M,q)&&!re.hasOwnProperty(q)&&(K[q]=M[q]);if(S&&S.defaultProps)for(q in M=S.defaultProps,M)K[q]===void 0&&(K[q]=M[q]);return{$$typeof:D,type:S,key:le,ref:Y,props:K,_owner:W.current}}ee.jsx=z,f=z},52322:function(Z,ee,g){"use strict";Z.exports=g(11837)},87245:function(Z){"use strict";function ee(g){return Object.prototype.toString.call(g)==="[object Array]"}Z.exports=Array.isArray||ee},8615:function(Z){"use strict";function ee(g){return typeof g=="function"}Z.exports=ee},63772:function(Z,ee,g){"use strict";var f=g(87245),U=g(45002);function D(R){var W;if(!f(R)||(W=R.length,!W))return!1;for(var $=0;$<W;$++)if(!U(R[$]))return!1;return!0}Z.exports=D},45002:function(Z,ee,g){"use strict";var f=g(87040);function U(D){return f(D)&&D%1===0}Z.exports=U},87040:function(Z){"use strict";function ee(g){return(typeof g=="number"||Object.prototype.toString.call(g)==="[object Number]")&&g.valueOf()===g.valueOf()}Z.exports=ee}}]);})();

//# sourceMappingURL=6970.a46a70a2.chunk.js.map